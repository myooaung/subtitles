1
00:00:01,140 --> 00:00:01,720
[Autogenerated] Okay.

2
00:00:01,720 --> 00:00:02,650
Welcome back.

3
00:00:02,650 --> 00:00:07,440
Now, In the previous clip, we went ahead and viewed the default CloudTrail trail.

4
00:00:07,440 --> 00:00:08,760
And in these clips,

5
00:00:08,760 --> 00:00:13,940
we're going to create and configure our very own trail for custom uses.

6
00:00:13,940 --> 00:00:19,740
So if I go to create trail here, this brings us to our create trail screen.

7
00:00:19,740 --> 00:00:22,940
Now, the first thing we have to do is give it a name.

8
00:00:22,940 --> 00:00:25,440
So let me give this a quick trail name.

9
00:00:25,440 --> 00:00:30,240
And after that, we see we can apply this trail to all regions.

10
00:00:30,240 --> 00:00:33,970
Now, if you want it to only record data in this region,

11
00:00:33,970 --> 00:00:35,340
you can select No,

12
00:00:35,340 --> 00:00:38,960
but it's a very common and it's a best practice to

13
00:00:38,960 --> 00:00:41,580
enable a trail in all regions.

14
00:00:41,580 --> 00:00:44,240
So you're monitoring your entire account.

15
00:00:44,240 --> 00:00:47,620
So this automates the tedious task of creating the

16
00:00:47,620 --> 00:00:50,840
same trail throughout our account.

17
00:00:50,840 --> 00:00:51,110
Now,

18
00:00:51,110 --> 00:00:54,990
another important aspect of this is that when you

19
00:00:54,990 --> 00:00:57,940
create the same trail to all regions,

20
00:00:57,940 --> 00:01:03,680
it will help with de duplicating data and events that you might otherwise get.

21
00:01:03,680 --> 00:01:08,080
And that's really more specific to global Resource is now.

22
00:01:08,080 --> 00:01:12,090
The next thing we see here is management events and you can see

23
00:01:12,090 --> 00:01:16,540
that management events are simply records of actions performed on

24
00:01:16,540 --> 00:01:19,840
or within resource is in our accounts,

25
00:01:19,840 --> 00:01:24,040
and they allow us to go ahead and configure specific options.

26
00:01:24,040 --> 00:01:25,250
The first one is read.

27
00:01:25,250 --> 00:01:28,890
Write events, so we can either capture all events.

28
00:01:28,890 --> 00:01:31,640
We can capture only right events.

29
00:01:31,640 --> 00:01:37,840
We can capture only read events, or we can capture absolutely none.

30
00:01:37,840 --> 00:01:38,150
Now.

31
00:01:38,150 --> 00:01:40,620
I would never recommend you capturing none.

32
00:01:40,620 --> 00:01:43,840
It's a good practice to go ahead and leave it at all,

33
00:01:43,840 --> 00:01:48,530
because this is going to capture any time someone's logging into your account.

34
00:01:48,530 --> 00:01:52,740
It's going to capture anything security related within your account.

35
00:01:52,740 --> 00:01:56,870
And it captures anytime someone might set up some type of logging,

36
00:01:56,870 --> 00:02:02,040
so it captures those really specific events that you might want to know about.

37
00:02:02,040 --> 00:02:02,200
Now.

38
00:02:02,200 --> 00:02:05,240
The next option is we can Log Kms events.

39
00:02:05,240 --> 00:02:09,590
So if we wanted to we can log any time that someone's

40
00:02:09,590 --> 00:02:14,350
calling Kms within our account and log it to the trail so

41
00:02:14,350 --> 00:02:15,850
we'll leave this it Yes as well,

42
00:02:15,850 --> 00:02:18,970
because we want to know everything that's going on and we can

43
00:02:18,970 --> 00:02:21,920
filter it later and then we have insights,

44
00:02:21,920 --> 00:02:22,670
events.

45
00:02:22,670 --> 00:02:23,320
Now.

46
00:02:23,320 --> 00:02:27,840
This shouldn't be included in the Solutions Architect Professional exam,

47
00:02:27,840 --> 00:02:31,340
and we didn't cover it when we were looking at CloudWatch,

48
00:02:31,340 --> 00:02:35,740
but All it is is groups of records that capture

49
00:02:35,740 --> 00:02:38,930
unusual call volume of right APIs.

50
00:02:38,930 --> 00:02:41,990
So if out of the blue and out of nowhere,

51
00:02:41,990 --> 00:02:46,310
your account starts receiving an enormous amount of right API

52
00:02:46,310 --> 00:02:50,640
calls enabling this will capture those events.

53
00:02:50,640 --> 00:02:53,420
The next thing we see is data events.

54
00:02:53,420 --> 00:02:58,350
So this is event records for actions on or within a

55
00:02:58,350 --> 00:03:02,900
resource and specifically S3 and Lambda.

56
00:03:02,900 --> 00:03:05,640
Now, when we enable it and S3,

57
00:03:05,640 --> 00:03:08,990
you can see that it captures object level activity.

58
00:03:08,990 --> 00:03:12,850
So if we put an object, get object, delete object.

59
00:03:12,850 --> 00:03:18,040
All of those data object related API calls that we can perform.

60
00:03:18,040 --> 00:03:20,180
So we'll go ahead and select that.

61
00:03:20,180 --> 00:03:23,640
And it's a good practice just to select all as three buckets.

62
00:03:23,640 --> 00:03:24,160
Otherwise,

63
00:03:24,160 --> 00:03:28,760
you could specify a specific bucket and we can customize what kind of

64
00:03:28,760 --> 00:03:31,520
events we want to capture over here on the right.

65
00:03:31,520 --> 00:03:33,940
Now the next thing we see is Lambda.

66
00:03:33,940 --> 00:03:35,400
Now for Lambda.

67
00:03:35,400 --> 00:03:38,790
This is going to record function level event,

68
00:03:38,790 --> 00:03:43,640
this tary that's happening within our individual functions

69
00:03:43,640 --> 00:03:47,550
so you can see we can log All current and future or we can

70
00:03:47,550 --> 00:03:50,040
specify a function to log.

71
00:03:50,040 --> 00:03:55,040
I'll leave this unchecked, but I'll leave S3 checked and let's move on.

72
00:03:55,040 --> 00:03:58,640
Now The bottom part here is our storage location.

73
00:03:58,640 --> 00:04:01,180
So this is what I was talking about when I was saying

74
00:04:01,180 --> 00:04:03,840
we can push to a centralized bucket.

75
00:04:03,840 --> 00:04:06,230
If you notice in this graphic here,

76
00:04:06,230 --> 00:04:10,640
we're assuming we have an organization set up in A W s.

77
00:04:10,640 --> 00:04:15,340
We have the master account with the Master CloudTrail Trail.

78
00:04:15,340 --> 00:04:18,100
We have an organizational bucket for security,

79
00:04:18,100 --> 00:04:21,140
auditing and logging in that master account.

80
00:04:21,140 --> 00:04:25,120
And what we're doing is applying the same trail to all

81
00:04:25,120 --> 00:04:28,840
sub accounts within our organization.

82
00:04:28,840 --> 00:04:31,060
Now, we don't see that option up here,

83
00:04:31,060 --> 00:04:35,640
but if this was a master account within an organization,

84
00:04:35,640 --> 00:04:39,360
you would have an option here similar to this one that says,

85
00:04:39,360 --> 00:04:42,840
Hey, I want to apply this trail to my organization.

86
00:04:42,840 --> 00:04:45,120
So if you select yes to that,

87
00:04:45,120 --> 00:04:48,000
it's going to create it in all your current accounts that

88
00:04:48,000 --> 00:04:51,640
error sub accounts as well as future ones.

89
00:04:51,640 --> 00:04:54,440
So it handles setting that up for us.

90
00:04:54,440 --> 00:04:57,490
And that's really what you see in the graphic where we

91
00:04:57,490 --> 00:05:01,440
configured the same trail within our sub accounts.

92
00:05:01,440 --> 00:05:05,550
And both sub accounts are logging back to the central bucket in

93
00:05:05,550 --> 00:05:08,340
our master account for security purposes.

94
00:05:08,340 --> 00:05:10,600
This is a very common scenario,

95
00:05:10,600 --> 00:05:16,050
and it's a best practice for security auditing based around CloudTrail so we

96
00:05:16,050 --> 00:05:19,340
can create a new bucket here and we'll go ahead and do that.

97
00:05:19,340 --> 00:05:23,840
But if we wanted to, we could select no and choose an existing bucket.

98
00:05:23,840 --> 00:05:27,240
So this might be where you enter an organizational bucket.

99
00:05:27,240 --> 00:05:28,220
But I'm going to click.

100
00:05:28,220 --> 00:05:32,140
Yes, and let's just give this a made up bucket name really quickly.

101
00:05:32,140 --> 00:05:33,570
Hopefully, that's unique.

102
00:05:33,570 --> 00:05:36,740
And let's open up advanced and you can see we can

103
00:05:36,740 --> 00:05:40,040
specify a few other advanced options.

104
00:05:40,040 --> 00:05:43,210
We can specify a specific prefix if we want,

105
00:05:43,210 --> 00:05:45,220
which is highly recommended,

106
00:05:45,220 --> 00:05:50,540
especially if you're pushing several different log files to the same bucket.

107
00:05:50,540 --> 00:05:54,330
A best practice is to go ahead and set up a custom prefix,

108
00:05:54,330 --> 00:05:57,000
so it's easier to search through Now.

109
00:05:57,000 --> 00:06:00,680
The default that's going to happen here is listed down here in the gray.

110
00:06:00,680 --> 00:06:03,560
You can see it's going to be slash A.

111
00:06:03,560 --> 00:06:10,340
W s logs, slash account IDE slash CloudTrail and then the region.

112
00:06:10,340 --> 00:06:13,500
Now, if this was an organization account,

113
00:06:13,500 --> 00:06:17,940
we would see the organization IDE within this prefix as well.

114
00:06:17,940 --> 00:06:21,040
So just keep that in mind, it will look slightly different.

115
00:06:21,040 --> 00:06:25,450
The next thing is we can encrypt our log files with Kms.

116
00:06:25,450 --> 00:06:31,960
So this is going to allow us to encrypt all of our log files using a kms key

117
00:06:31,960 --> 00:06:37,340
instead of the standard S3 encryption that this comes with.

118
00:06:37,340 --> 00:06:39,860
So if we have our own customer managed key that we

119
00:06:39,860 --> 00:06:43,140
want to use we can specify that here,

120
00:06:43,140 --> 00:06:46,660
otherwise it's going to encrypt the files no matter what.

121
00:06:46,660 --> 00:06:53,260
But it's going to use a W S s services, IT encryption within S3.

122
00:06:53,260 --> 00:06:54,570
So no matter what,

123
00:06:54,570 --> 00:06:58,720
you're going to have protected logs from an encryption standpoint Now,

124
00:06:58,720 --> 00:07:03,510
the next part here enable log file validation is very,

125
00:07:03,510 --> 00:07:06,240
very, very important.

126
00:07:06,240 --> 00:07:08,760
This is a critical piece of information.

127
00:07:08,760 --> 00:07:09,810
You need to know.

128
00:07:09,810 --> 00:07:15,740
What this option does is it allows us to validate that our log files

129
00:07:15,740 --> 00:07:19,640
have not been tampered with in any shape or form,

130
00:07:19,640 --> 00:07:22,700
and a little gotcha on this option.

131
00:07:22,700 --> 00:07:25,790
If you send your files to a bucket and you have this

132
00:07:25,790 --> 00:07:31,110
enabled and then you move those files, it's going to notify you that Hey,

133
00:07:31,110 --> 00:07:33,220
these error, not the original files.

134
00:07:33,220 --> 00:07:36,340
Even if you move them back into the same bucket,

135
00:07:36,340 --> 00:07:38,360
it will ruin the validation,

136
00:07:38,360 --> 00:07:43,920
and it will flag it for not being a true original copy of the logs.

137
00:07:43,920 --> 00:07:46,340
So if you enable this option,

138
00:07:46,340 --> 00:07:50,470
be sure that you're sending it to the final destination

139
00:07:50,470 --> 00:07:54,040
for your log files within your accounts.

140
00:07:54,040 --> 00:07:55,040
And then, lastly,

141
00:07:55,040 --> 00:08:00,740
here we have the option to send SMS notifications for every log file delivery.

142
00:08:00,740 --> 00:08:03,620
Now, I don't see this option used very much,

143
00:08:03,620 --> 00:08:07,480
but it is possible if you have some type of application,

144
00:08:07,480 --> 00:08:11,830
such as a third-party monitoring service that has an endpoint that we

145
00:08:11,830 --> 00:08:14,680
want to notify whenever log files error delivered.

146
00:08:14,680 --> 00:08:18,150
So maybe that third-party security application could go

147
00:08:18,150 --> 00:08:20,940
ahead and received that notification.

148
00:08:20,940 --> 00:08:23,270
It parses the event that it received.

149
00:08:23,270 --> 00:08:26,170
And then it goes in and collect those log files so it

150
00:08:26,170 --> 00:08:30,280
can do its own custom workflow with, um And then finally,

151
00:08:30,280 --> 00:08:33,800
as with every A W s resource we can ad attack.

152
00:08:33,800 --> 00:08:35,060
So I'm not going to do that.

153
00:08:35,060 --> 00:08:37,240
Let's click on create.

154
00:08:37,240 --> 00:08:38,240
And there we go.

155
00:08:38,240 --> 00:08:40,740
We now have created our trail.

156
00:08:40,740 --> 00:08:41,180
Now,

157
00:08:41,180 --> 00:08:44,790
an important note here is the first CloudTrail that you

158
00:08:44,790 --> 00:08:48,040
make your very first custom trail is free.

159
00:08:48,040 --> 00:08:52,030
Anyone's beside that are going to cost you so everyone

160
00:08:52,030 --> 00:08:56,370
gets one free to customize now what you will incur costs

161
00:08:56,370 --> 00:09:00,140
on is right here the S3 bucket.

162
00:09:00,140 --> 00:09:05,600
So you're going to incur data costs and API call costs for storing

163
00:09:05,600 --> 00:09:08,220
and delivering these objects to your buckets,

164
00:09:08,220 --> 00:09:10,440
so just keep that in mind.

165
00:09:10,440 --> 00:09:14,160
Now, before we wrap up here, Let's go ahead and switch our region.

166
00:09:14,160 --> 00:09:20,840
Let's go to us East one and I want to check my CloudTrail trails in US East one.

167
00:09:20,840 --> 00:09:21,600
And there it is.

168
00:09:21,600 --> 00:09:26,270
It's the same exact trail, and you can see the home region here.

169
00:09:26,270 --> 00:09:26,740
US.

170
00:09:26,740 --> 00:09:31,240
East to is different than the one we're in now, us East one.

171
00:09:31,240 --> 00:09:35,380
So this is already propagated all the way to the

172
00:09:35,380 --> 00:09:37,240
different regions within our account.

173
00:09:37,240 --> 00:09:46,000
And let's actually go ahead and in this clip here, take a short break and then we'll pick up in the next one where we left off

