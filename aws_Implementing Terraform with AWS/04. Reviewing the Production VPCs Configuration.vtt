WEBVTT
1
00:00:01.140 --> 00:00:03.210
[Autogenerated] all right, here we are in visual studio code.

2
00:00:03.210 --> 00:00:06.280
I've got my exercise files going down the left.

3
00:00:06.280 --> 00:00:11.810
The folder that we're interested in here is called to Dash West Dash Vpc.

4
00:00:11.810 --> 00:00:14.680
And in here we've got a set of commands.

5
00:00:14.680 --> 00:00:18.180
We've got our main dot t f file and if you want to change what

6
00:00:18.180 --> 00:00:21.540
the variables are used in the main dot T f,

7
00:00:21.540 --> 00:00:26.360
you can rename that terra form dot t f far as that example to terra form

8
00:00:26.360 --> 00:00:30.340
dot t f bars and then update the settings within it.

9
00:00:30.340 --> 00:00:33.840
Let's take a look at what's in that main dot t f.

10
00:00:33.840 --> 00:00:34.320
Okay,

11
00:00:34.320 --> 00:00:37.550
so the first thing we're doing is establishing some variables and you'll

12
00:00:37.550 --> 00:00:41.740
notice this is very similar to the Dev VPC configuration.

13
00:00:41.740 --> 00:00:45.620
Except now we're creating to VPC s instead of just one.

14
00:00:45.620 --> 00:00:49.250
So first we have to define a region one which will be US East

15
00:00:49.250 --> 00:00:53.240
one and then a region to which is us West one.

16
00:00:53.240 --> 00:00:56.000
You can also change these by submitting different values

17
00:00:56.000 --> 00:00:58.180
for the variable falsy scrolling down.

18
00:00:58.180 --> 00:01:03.510
We're going to define our vpc cider range for the East vpc so

19
00:01:03.510 --> 00:01:08.160
that's gonna be 10 10.0 dot zero slash 16 and then the cider

20
00:01:08.160 --> 00:01:12.360
ranges for the public sub nets and the database sub nets in

21
00:01:12.360 --> 00:01:15.250
that east VPC scrolling down.

22
00:01:15.250 --> 00:01:20.480
We repeat the same thing for the West vpc So we have our cider range and

23
00:01:20.480 --> 00:01:24.390
then the public sub nets and finally the database sub nets.

24
00:01:24.390 --> 00:01:24.880
Alright,

25
00:01:24.880 --> 00:01:29.640
so that sets up all of our values we're going to use for the configuration.

26
00:01:29.640 --> 00:01:32.910
All right, scrolling down, we get into the interesting part,

27
00:01:32.910 --> 00:01:34.570
which is the providers,

28
00:01:34.570 --> 00:01:40.940
and we have to providers being created here to instances of the AWS provider.

29
00:01:40.940 --> 00:01:44.320
They're almost the same with a few minor changes.

30
00:01:44.320 --> 00:01:45.970
If we look at the first provider,

31
00:01:45.970 --> 00:01:49.680
you could see that the region is set to hvar dot region underscore

32
00:01:49.680 --> 00:01:53.650
one which is us East one the way that we have that variable

33
00:01:53.650 --> 00:01:57.270
configured and we're giving it the alias of East.

34
00:01:57.270 --> 00:02:00.950
So we know that this instance of the provider is dealing with the U.

35
00:02:00.950 --> 00:02:01.260
S.

36
00:02:01.260 --> 00:02:03.290
East one region,

37
00:02:03.290 --> 00:02:08.030
the second provider is using var dot region underscore to which we

38
00:02:08.030 --> 00:02:12.000
have set to us West one and the alias is set to west.

39
00:02:12.000 --> 00:02:16.940
So we know that this provider is dealing with the US West one region.

40
00:02:16.940 --> 00:02:19.200
We aren't specifying any credentials in here,

41
00:02:19.200 --> 00:02:23.540
so it's just going to use the default profile in our credentials

42
00:02:23.540 --> 00:02:27.040
file that we created in the previous module.

43
00:02:27.040 --> 00:02:29.400
All right, so that's everything for the providers.

44
00:02:29.400 --> 00:02:32.830
Let's scroll down a little bit and we get into data sources and

45
00:02:32.830 --> 00:02:36.170
you'll remember from the Dev VPC configuration.

46
00:02:36.170 --> 00:02:40.120
We query the availability zones for each region,

47
00:02:40.120 --> 00:02:44.140
so we know which availability zones to use for our sub nets.

48
00:02:44.140 --> 00:02:47.640
As part of the configuration for this data source,

49
00:02:47.640 --> 00:02:50.140
I've specified a provider argument,

50
00:02:50.140 --> 00:02:53.250
and that's how it knows which provider to use when

51
00:02:53.250 --> 00:02:55.690
it's querying the availability zones.

52
00:02:55.690 --> 00:02:56.290
This way,

53
00:02:56.290 --> 00:03:00.520
I will get the availability zones for us East one and the

54
00:03:00.520 --> 00:03:04.990
availability zones for us West one scrolling down some more.

55
00:03:04.990 --> 00:03:10.540
We get into our modules and I've got the first module here for VPC East.

56
00:03:10.540 --> 00:03:15.450
We're using the same VPC module that we used in the Dev VPC.

57
00:03:15.450 --> 00:03:18.980
You notice the name for this is prod vpc east,

58
00:03:18.980 --> 00:03:22.800
and we're giving it the proper variables for the cider ranges,

59
00:03:22.800 --> 00:03:25.670
the public sub nets and the database sub nets.

60
00:03:25.670 --> 00:03:29.660
The important part is down at the providers level you'll see

61
00:03:29.660 --> 00:03:33.460
under providers who have said it equal to a map where a W S

62
00:03:33.460 --> 00:03:36.530
is equal to a W s dot east.

63
00:03:36.530 --> 00:03:40.620
So that's how the module knows to use the A W s dot

64
00:03:40.620 --> 00:03:42.940
east instance of the provider.

65
00:03:42.940 --> 00:03:48.500
If we scroll down to the VPC West module, you'll note it's basically the same.

66
00:03:48.500 --> 00:03:52.870
Except we swapped out the proper variables for our west VPC.

67
00:03:52.870 --> 00:03:56.260
And if we scroll down under the provider section just as,

68
00:03:56.260 --> 00:04:01.220
you would expect we've set a W s equal to a W s dot west.

69
00:04:01.220 --> 00:04:06.340
So that sets up everything we need to create these two VP CSS.

70
00:04:06.340 --> 00:04:07.960
If we scroll down a little bit more,

71
00:04:07.960 --> 00:04:12.330
we get to the outputs and the outputs are simply the vpc IDE for the

72
00:04:12.330 --> 00:04:17.720
East vpc and the VPC IDE for the West Vpc All right,

73
00:04:17.720 --> 00:04:24.000
that's the entire configuration. So why don't we go about deploying that using terra form

