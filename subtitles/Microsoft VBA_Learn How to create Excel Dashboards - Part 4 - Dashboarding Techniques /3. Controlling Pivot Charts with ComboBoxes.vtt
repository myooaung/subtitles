WEBVTT
ï»¿1
00:00:00.000 --> 00:00:03.140
Hi,

2
00:00:03.140 --> 00:00:03.480
guys.

3
00:00:03.480 --> 00:00:04.500
So in this video,

4
00:00:04.500 --> 00:00:09.210
we're going to discuss how we can create Ah,

5
00:00:09.210 --> 00:00:12.880
combo box that controls a pivot chart.

6
00:00:12.880 --> 00:00:14.910
So you can see here that,

7
00:00:14.910 --> 00:00:17.150
um I've got a combo box here.

8
00:00:17.150 --> 00:00:21.050
And when I just choose a different year,

9
00:00:21.050 --> 00:00:28.650
it just changes the data on the chart to plot the sales for that particular year.

10
00:00:28.650 --> 00:00:29.880
Okay,

11
00:00:29.880 --> 00:00:30.260
s.

12
00:00:30.260 --> 00:00:35.500
So if a choose your 2012 you can see here that it's the data the data plotted.

13
00:00:35.500 --> 00:00:39.150
It has changed to the for the sales in 2012.

14
00:00:39.150 --> 00:00:40.120
Now,

15
00:00:40.120 --> 00:00:40.640
Ah,

16
00:00:40.640 --> 00:00:44.260
let's see how we can create the this kind of effect,

17
00:00:44.260 --> 00:00:49.690
because here that I've got a combo box here and we will check what it's connected to,

18
00:00:49.690 --> 00:00:50.210
so right,

19
00:00:50.210 --> 00:00:52.310
click on it and click on formal control.

20
00:00:52.310 --> 00:00:58.860
And you can see here that the MPA trains for the combo box is ah arranged called the year

21
00:00:58.860 --> 00:00:59.550
list.

22
00:00:59.550 --> 00:01:05.950
And also there is a selling here on sell em seven on the combo box row data sheet.

23
00:01:05.950 --> 00:01:07.700
Okay,

24
00:01:07.700 --> 00:01:08.720
Now,

25
00:01:08.720 --> 00:01:11.260
let's check the combo box row data sheet.

26
00:01:11.260 --> 00:01:17.370
You can see here that we've got a table that contains some sales data,

27
00:01:17.370 --> 00:01:18.430
and there is ah,

28
00:01:18.430 --> 00:01:20.730
that colander is highlighted in yellow.

29
00:01:20.730 --> 00:01:25.390
It's a calculated column that extracts the year from the order date.

30
00:01:25.390 --> 00:01:26.380
Okay,

31
00:01:26.380 --> 00:01:29.930
And also I've got a pivot table here,

32
00:01:29.930 --> 00:01:34.550
and this is what's what the pivot Short is connected directly to.

33
00:01:34.550 --> 00:01:38.000
So this is what the what?

34
00:01:38.000 --> 00:01:39.380
This pivot short,

35
00:01:39.380 --> 00:01:40.090
actually.

36
00:01:40.090 --> 00:01:40.350
Ah,

37
00:01:40.350 --> 00:01:41.450
plots.

38
00:01:41.450 --> 00:01:42.440
Okay.

39
00:01:42.440 --> 00:01:47.490
And you can see here that there's a filter for the year and actually the combo box.

40
00:01:47.490 --> 00:01:50.920
What it does is it changes the year in this filter,

41
00:01:50.920 --> 00:01:53.580
and I'll show you how it's it's by using a macro,

42
00:01:53.580 --> 00:01:56.260
I'll show you how we can create such a macro,

43
00:01:56.260 --> 00:02:00.050
and you can see her that there is upgraded another.

44
00:02:00.050 --> 00:02:00.990
Um,

45
00:02:00.990 --> 00:02:08.720
I've created another pivot table here with the year only with the Year column on Lee,

46
00:02:08.720 --> 00:02:15.110
and it's just listing the years and you can see here this arranging sending order by

47
00:02:15.110 --> 00:02:17.810
clicking on that button and then clicking on sort,

48
00:02:17.810 --> 00:02:19.050
smallest to largest.

49
00:02:19.050 --> 00:02:28.340
And the reason I created this this pivot table is toe have the list of years to have the

50
00:02:28.340 --> 00:02:30.040
hammock range for the year list,

51
00:02:30.040 --> 00:02:37.960
and so that this this pivot table would feed that range and it would be because the range

52
00:02:37.960 --> 00:02:38.520
is dynamic,

53
00:02:38.520 --> 00:02:41.400
so If you add data for 2015 for example,

54
00:02:41.400 --> 00:02:48.360
this pivot table would expand and the range would expend as well ah to include the year

55
00:02:48.360 --> 00:02:49.510
2015

56
00:02:49.510 --> 00:02:54.470
And so the year 2015 would be included on the list as well.

57
00:02:54.470 --> 00:02:55.010
Of course,

58
00:02:55.010 --> 00:02:57.430
both these pivot tables,

59
00:02:57.430 --> 00:03:01.500
they get fed from the same row Data source to this table here,

60
00:03:01.500 --> 00:03:02.950
we've got on the left.

61
00:03:02.950 --> 00:03:05.240
Great.

62
00:03:05.240 --> 00:03:09.170
Now let's check our dynamic range here the year list.

63
00:03:09.170 --> 00:03:10.950
It's a simple range that I've created.

64
00:03:10.950 --> 00:03:17.340
Using the offset function as we've seen on the video for creating dynamic range is using

65
00:03:17.340 --> 00:03:20.210
the offset functions to please refer back to that video.

66
00:03:20.210 --> 00:03:21.640
If you want Teoh,

67
00:03:21.640 --> 00:03:25.810
if you need a refresher and how to create dynamic ranges Okay,

68
00:03:25.810 --> 00:03:32.370
Now we're gonna I'm gonna close the name manager here and you can see here that there is a

69
00:03:32.370 --> 00:03:32.890
cell here,

70
00:03:32.890 --> 00:03:34.560
which is the combo box selling.

71
00:03:34.560 --> 00:03:37.820
This is the selling for the combo box.

72
00:03:37.820 --> 00:03:43.620
For it out puts the index number of the year selected So because on this list,

73
00:03:43.620 --> 00:03:46.680
2012 is the second year on the list,

74
00:03:46.680 --> 00:03:53.380
so it outputs to and you can see here that If I choose 2013 it will open 23 and so on and

75
00:03:53.380 --> 00:03:53.950
so forth.

76
00:03:53.950 --> 00:03:56.400
And this is just ah,

77
00:03:56.400 --> 00:03:59.820
on this cell of we've got an index function that,

78
00:03:59.820 --> 00:04:00.540
um,

79
00:04:00.540 --> 00:04:04.140
gets this the year itself out of,

80
00:04:04.140 --> 00:04:04.690
ah,

81
00:04:04.690 --> 00:04:07.640
out of the year list dynamic cranes.

82
00:04:07.640 --> 00:04:08.080
So,

83
00:04:08.080 --> 00:04:08.670
actually,

84
00:04:08.670 --> 00:04:14.550
we just use the index function to extract the actual year from the dynamic range.

85
00:04:14.550 --> 00:04:15.790
Ah,

86
00:04:15.790 --> 00:04:19.410
you Azaz we have We would have the extra year,

87
00:04:19.410 --> 00:04:25.570
and then we will build a macro to actually take this actual year and put it here on the

88
00:04:25.570 --> 00:04:27.450
pivot table filter.

89
00:04:27.450 --> 00:04:28.390
Okay,

90
00:04:28.390 --> 00:04:31.050
this is how we can control.

91
00:04:31.050 --> 00:04:32.020
Ah,

92
00:04:32.020 --> 00:04:37.290
the pivot table and pivot chart using the combo box.

93
00:04:37.290 --> 00:04:38.050
Okay,

94
00:04:38.050 --> 00:04:42.270
so this is the basic idea behind Ah,

95
00:04:42.270 --> 00:04:46.920
that controlling behind controlling a pivot chart using a combo box.

96
00:04:46.920 --> 00:04:50.650
So let's build the macro.

97
00:04:50.650 --> 00:04:52.780
Okay,

98
00:04:52.780 --> 00:04:53.070
guys.

99
00:04:53.070 --> 00:04:59.230
So now we're going to see how we can create the macro that we're going to attach to the

100
00:04:59.230 --> 00:05:01.430
combo box in order to ah,

101
00:05:01.430 --> 00:05:05.420
change the filter on on this pivot table,

102
00:05:05.420 --> 00:05:06.350
the year filter.

103
00:05:06.350 --> 00:05:08.490
So what we need to do,

104
00:05:08.490 --> 00:05:09.120
first of all,

105
00:05:09.120 --> 00:05:10.720
to record the macro,

106
00:05:10.720 --> 00:05:15.210
we're going to go to our developer Tab on the ribbon and then click on record,

107
00:05:15.210 --> 00:05:15.750
Macro.

108
00:05:15.750 --> 00:05:18.980
And then I'm gonna name my macro here,

109
00:05:18.980 --> 00:05:20.850
Change underscore year.

110
00:05:20.850 --> 00:05:22.370
Then I'm gonna click,

111
00:05:22.370 --> 00:05:23.050
OK,

112
00:05:23.050 --> 00:05:24.750
in order to start recording.

113
00:05:24.750 --> 00:05:32.430
And now what we need to do is to just do a year change here on the pivot table filters.

114
00:05:32.430 --> 00:05:36.550
I'm gonna change the pivot table filter to be 2013 for example,

115
00:05:36.550 --> 00:05:37.180
and then click.

116
00:05:37.180 --> 00:05:37.750
OK,

117
00:05:37.750 --> 00:05:43.020
And then I'm going to stop recording my macro by going to the developer tub on the ribbon

118
00:05:43.020 --> 00:05:46.500
and then clicking on Stop recording that.

119
00:05:46.500 --> 00:05:48.400
I'm gonna go to my macro to edit it.

120
00:05:48.400 --> 00:05:54.950
Eso I'm going to go to the macro owes button here on the developer tab on the ribbon,

121
00:05:54.950 --> 00:06:00.120
click on it and then just gonna highlight my macro that I've recorded and click on it it.

122
00:06:00.120 --> 00:06:01.160
By the way,

123
00:06:01.160 --> 00:06:02.300
there is another macro here,

124
00:06:02.300 --> 00:06:07.760
which is the change the year macro that is actually attached already to the combo box.

125
00:06:07.760 --> 00:06:13.620
The one that I have ah illustrated the functionality of the combo box with.

126
00:06:13.620 --> 00:06:16.710
So I'm actually creating a duplicate off the same macro here.

127
00:06:16.710 --> 00:06:22.180
I'm gonna how I like my change year macro and then click on it it.

128
00:06:22.180 --> 00:06:23.850
And now,

129
00:06:23.850 --> 00:06:25.770
as you can see here on the code,

130
00:06:25.770 --> 00:06:26.710
the first line,

131
00:06:26.710 --> 00:06:35.690
what it does is that it clears the filter on the year here on the the year filter on the

132
00:06:35.690 --> 00:06:36.780
pivot table.

133
00:06:36.780 --> 00:06:41.720
So it clears the year filter and the second line on the macro.

134
00:06:41.720 --> 00:06:46.210
What it does is it puts the year 2013 into that filter.

135
00:06:46.210 --> 00:06:49.650
So we need to make two changes.

136
00:06:49.650 --> 00:06:50.730
First of all,

137
00:06:50.730 --> 00:06:51.870
on the two lines.

138
00:06:51.870 --> 00:06:53.770
It refers to the active sheet,

139
00:06:53.770 --> 00:07:00.190
but we can't refer to the active sheet because the macro is gonna be run on from this sheet

140
00:07:00.190 --> 00:07:02.020
here the combo box dashboard sheet,

141
00:07:02.020 --> 00:07:07.550
which is a different cheat than the one containing the pivot table,

142
00:07:07.550 --> 00:07:09.360
which is a combo box raw data sheet.

143
00:07:09.360 --> 00:07:17.920
So what we need to do is to refer to the combo box Rhodey to sheet instead of the active

144
00:07:17.920 --> 00:07:20.990
sheet because of referred to the active sheet.

145
00:07:20.990 --> 00:07:23.350
Then we're referring to the combo box dashboard cheap.

146
00:07:23.350 --> 00:07:28.490
So I'm just gonna right here instead of active sheet,

147
00:07:28.490 --> 00:07:44.450
I'm gonna write worksheets combo box row data combo box raw data,

148
00:07:44.450 --> 00:07:47.960
and it doesn't it doesn't matter.

149
00:07:47.960 --> 00:07:49.730
The case off the letters,

150
00:07:49.730 --> 00:07:51.510
whether they are upper case.

151
00:07:51.510 --> 00:07:52.490
Lower case.

152
00:07:52.490 --> 00:07:55.130
This won't make a difference on day.

153
00:07:55.130 --> 00:07:58.790
I mean that on the combo box Rotator the the name of the sheet.

154
00:07:58.790 --> 00:08:03.630
It doesn't matter if it's written and Olin cops or only in small letters.

155
00:08:03.630 --> 00:08:10.990
I'm also gonna replace the active sheet on the second line here with worksheets combo box

156
00:08:10.990 --> 00:08:18.200
raw data on the first part of the second line and the second thing that we need to do so

157
00:08:18.200 --> 00:08:23.270
after referring to the worksheets combo box rotate out.

158
00:08:23.270 --> 00:08:30.100
The second thing we need to do here is to change the year 2013 to be,

159
00:08:30.100 --> 00:08:31.840
ah,

160
00:08:31.840 --> 00:08:39.920
this cell in the to be the cell and seven So the value in cell and seven in combo box raw

161
00:08:39.920 --> 00:08:44.000
data sheet because we need the value of the combo box,

162
00:08:44.000 --> 00:08:46.390
which is represented by cell,

163
00:08:46.390 --> 00:08:48.600
and seven okay,

164
00:08:48.600 --> 00:08:55.690
to be put in this ah filter on the year filter here on the pivot table.

165
00:08:55.690 --> 00:08:59.690
So what we need to do is to write worksheets,

166
00:08:59.690 --> 00:09:00.410
combo box,

167
00:09:00.410 --> 00:09:04.220
raw data dot range and seven,

168
00:09:04.220 --> 00:09:10.150
because now we're referring to that cell and seven dot value,

169
00:09:10.150 --> 00:09:13.750
and it's very important to write an adult value port here.

170
00:09:13.750 --> 00:09:23.980
And I'm just gonna save my macro by clicking on control on s on my keyboard.

171
00:09:23.980 --> 00:09:28.350
I'm gonna close the vb vb a editor,

172
00:09:28.350 --> 00:09:29.660
Okay.

173
00:09:29.660 --> 00:09:33.190
And then I'm gonna go to my combo box dashboard sheet,

174
00:09:33.190 --> 00:09:39.470
and I'm going to right click on my combo box because I need to assign the macro that I've

175
00:09:39.470 --> 00:09:41.320
just recorded to the combo box.

176
00:09:41.320 --> 00:09:49.220
So as the macro to be launched or to be fired whenever I changed the value on the combo box

177
00:09:49.220 --> 00:09:49.220
,

178
00:09:49.220 --> 00:09:56.690
I'm gonna click on a sign macro and then click on change Underscore year and then click.

179
00:09:56.690 --> 00:09:57.410
OK,

180
00:09:57.410 --> 00:10:02.000
so right now what?

181
00:10:02.000 --> 00:10:04.690
What we need to do is to try our macro.

182
00:10:04.690 --> 00:10:08.190
So I'm just gonna put here the year 2011 And you can see here,

183
00:10:08.190 --> 00:10:16.410
guys that the chart is interacting with the change on the combo box The change of year on

184
00:10:16.410 --> 00:10:17.300
the combo box.

185
00:10:17.300 --> 00:10:18.310
Okay.

186
00:10:18.310 --> 00:10:28.520
And you can see here guys as well that I've got a cell here that actually it writes sales

187
00:10:28.520 --> 00:10:29.440
and then a dash,

188
00:10:29.440 --> 00:10:31.360
and then the,

189
00:10:31.360 --> 00:10:38.280
uh the year that I've just chosen and how to do this effect is is using an equation and

190
00:10:38.280 --> 00:10:40.590
concoct in ating using the n percent.

191
00:10:40.590 --> 00:10:46.970
So I'm just concoct in ating the word sales and then space and then a dash and then space

192
00:10:46.970 --> 00:10:53.450
here this string between the two double quotes and ken cutting concoct in a ting it with

193
00:10:53.450 --> 00:10:56.710
the cell K five in combo box ready to hear.

194
00:10:56.710 --> 00:11:03.440
So with the cell containing the filter and then I've assigned this Ah,

195
00:11:03.440 --> 00:11:09.530
the stacks box here on the chart or this chart title I've assigned it to this cell.

196
00:11:09.530 --> 00:11:10.010
Normally,

197
00:11:10.010 --> 00:11:16.670
we would hide this cell here having sales 2013 bus just I've kept it visible for

198
00:11:16.670 --> 00:11:17.450
illustration.

199
00:11:17.450 --> 00:11:25.250
So I've assigned that by by going Cuba clicking on this chart title and then clicking here

200
00:11:25.250 --> 00:11:28.770
inside the for middle bore and,

201
00:11:28.770 --> 00:11:29.250
you know,

202
00:11:29.250 --> 00:11:33.360
it would normally wouldn't have it Wouldn't have anything on the formula bar.

203
00:11:33.360 --> 00:11:37.330
I clicked on equal and then just clicked that sell,

204
00:11:37.330 --> 00:11:38.040
impressed,

205
00:11:38.040 --> 00:11:38.650
enter.

206
00:11:38.650 --> 00:11:45.790
So now you can see here that the title of the charters interacting with my selection on the

207
00:11:45.790 --> 00:11:46.560
combo box.

208
00:11:46.560 --> 00:11:49.490
So this is guys how you can create,

209
00:11:49.490 --> 00:11:50.300
um,

210
00:11:50.300 --> 00:11:53.690
combo boxes that can control perfect charts.

211
00:11:53.690 --> 00:11:58.550
So thank you guys for watching this video and please follow me onto the next video

