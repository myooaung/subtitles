WEBVTT
ï»¿1
00:00:00.000 --> 00:00:11.350
in this video,

2
00:00:11.350 --> 00:00:16.870
we'll look at how we can use in a rape formula to perform a look up operation using

3
00:00:16.870 --> 00:00:18.250
multiple criteria.

4
00:00:18.250 --> 00:00:23.750
Let's open up 03 using Can Captain ation in a rate for Mueller's.

5
00:00:23.750 --> 00:00:28.150
So this is an example that we've seen in previous videos.

6
00:00:28.150 --> 00:00:31.000
We have a list of sales transactions,

7
00:00:31.000 --> 00:00:34.150
and we want to find out the unit cost for every road.

8
00:00:34.150 --> 00:00:36.390
But in order to do so,

9
00:00:36.390 --> 00:00:42.950
we needed to use to cry interior the purchase ideas not sufficient,

10
00:00:42.950 --> 00:00:45.850
because when we look in the purchases data,

11
00:00:45.850 --> 00:00:51.690
every item that was purchased is listed on a separate road.

12
00:00:51.690 --> 00:00:55.550
So to find the price that was paid for a particular product,

13
00:00:55.550 --> 00:00:59.650
we need to combine product I D and purchase I t.

14
00:00:59.650 --> 00:01:03.450
It will use an array formula.

15
00:01:03.450 --> 00:01:10.450
We can create a combined column virtually simply by concoct innate into a raise.

16
00:01:10.450 --> 00:01:16.800
We don't physically have to create an extra column before we discuss the formula that

17
00:01:16.800 --> 00:01:18.350
creates unnamed ranges,

18
00:01:18.350 --> 00:01:19.980
which we can use in the formula.

19
00:01:19.980 --> 00:01:22.800
So in the product idea,

20
00:01:22.800 --> 00:01:23.910
hurt society,

21
00:01:23.910 --> 00:01:27.950
and we can't reference the entire column.

22
00:01:27.950 --> 00:01:30.150
When you're working with the race,

23
00:01:30.150 --> 00:01:34.350
you need to reference just the data cells not the anti column.

24
00:01:34.350 --> 00:01:41.290
They control ship down to select all the way to the bottom and to create the names formulas

25
00:01:41.290 --> 00:01:43.600
create from selection.

26
00:01:43.600 --> 00:01:50.380
We want the name speaks up from the top row when we click.

27
00:01:50.380 --> 00:01:51.050
OK,

28
00:01:51.050 --> 00:01:53.700
then we do the same for you.

29
00:01:53.700 --> 00:02:11.370
That price that Excel creates our three named Ranges to perform the look up we use.

30
00:02:11.370 --> 00:02:16.850
A combination of index and Match index is the outer function.

31
00:02:16.850 --> 00:02:21.250
On its first argument is the array.

32
00:02:21.250 --> 00:02:22.580
That's to say,

33
00:02:22.580 --> 00:02:25.620
the array that contains the item that you're looking for.

34
00:02:25.620 --> 00:02:26.040
So,

35
00:02:26.040 --> 00:02:26.470
of course,

36
00:02:26.470 --> 00:02:27.390
in our case,

37
00:02:27.390 --> 00:02:30.630
it's going to be the unit price column within the purchases.

38
00:02:30.630 --> 00:02:31.350
Work feet,

39
00:02:31.350 --> 00:02:36.050
then to calculate the road that will contain the answer.

40
00:02:36.050 --> 00:02:43.920
We messed the match function as the row number arguments of the index function her match.

41
00:02:43.920 --> 00:02:46.850
Our first argument is the look up value,

42
00:02:46.850 --> 00:02:55.160
so we're placing our formula in road to column F of the sales worksheet contains the

43
00:02:55.160 --> 00:02:56.350
product i D.

44
00:02:56.350 --> 00:02:59.650
And column C contains the purchase i d.

45
00:02:59.650 --> 00:03:08.550
So look at value is the can Katyn ation off these two values F 2% C two.

46
00:03:08.550 --> 00:03:15.470
Then we specify the array within which were looking all that can caffeinated value.

47
00:03:15.470 --> 00:03:18.470
And because we're creating in the rape will get.

48
00:03:18.470 --> 00:03:22.550
What we do is to can Katyn ate the two columns,

49
00:03:22.550 --> 00:03:25.470
so we use product i d.

50
00:03:25.470 --> 00:03:27.650
Ampersand purchase I d.

51
00:03:27.650 --> 00:03:30.040
That's to say the entire products i D.

52
00:03:30.040 --> 00:03:37.250
Column can captain ated with the entire Purchase i D column and when contaminated to a race

53
00:03:37.250 --> 00:03:37.250
,

54
00:03:37.250 --> 00:03:44.070
Excel of automatically in Katyn eight Road one of product i D with Road one of Purchase I.

55
00:03:44.070 --> 00:03:48.050
D and place that into a virtual results Ray.

56
00:03:48.050 --> 00:03:51.060
And it's within this virtual array.

57
00:03:51.060 --> 00:03:56.650
But Excel will be searching for the lookout value when it finds a match.

58
00:03:56.650 --> 00:04:01.900
The row number is returned to the index function on the unit.

59
00:04:01.900 --> 00:04:05.180
Price on that road will be the result of the function.

60
00:04:05.180 --> 00:04:13.850
So let's write out formula we use in a nested function.

61
00:04:13.850 --> 00:04:15.650
So let's expand the formula bar.

62
00:04:15.650 --> 00:04:23.130
So the outer function people's index enter.

63
00:04:23.130 --> 00:04:26.450
And for the array argument,

64
00:04:26.450 --> 00:04:29.850
we simply specify the unit price column,

65
00:04:29.850 --> 00:04:31.950
which we've got a name for.

66
00:04:31.950 --> 00:04:40.910
Coma old enter and then for the road number weakness,

67
00:04:40.910 --> 00:04:41.930
the match function.

68
00:04:41.930 --> 00:04:44.500
But look up.

69
00:04:44.500 --> 00:04:47.970
Value is a concatenation off product.

70
00:04:47.970 --> 00:04:49.790
I d purchase i D.

71
00:04:49.790 --> 00:04:55.150
So to Empress end.

72
00:04:55.150 --> 00:04:58.260
See to coma.

73
00:04:58.260 --> 00:05:01.580
I went to the look up array.

74
00:05:01.580 --> 00:05:04.650
We can captain eight to a race,

75
00:05:04.650 --> 00:05:07.380
and we do them in exactly the same order.

76
00:05:07.380 --> 00:05:08.340
Product.

77
00:05:08.340 --> 00:05:08.980
I d.

78
00:05:08.980 --> 00:05:13.490
Empress end purchase I.

79
00:05:13.490 --> 00:05:13.950
D.

80
00:05:13.950 --> 00:05:16.670
Coleman.

81
00:05:16.670 --> 00:05:19.980
And then the match type is zero.

82
00:05:19.980 --> 00:05:27.100
Because we want an exact match closing parenthesis to end match all 10 sir,

83
00:05:27.100 --> 00:05:33.380
and the closing parenthesis to end index on.

84
00:05:33.380 --> 00:05:34.210
Finally,

85
00:05:34.210 --> 00:05:36.350
because this is an array formula,

86
00:05:36.350 --> 00:05:40.850
we press control shift enter rather than just enter.

87
00:05:40.850 --> 00:05:48.020
Now there are 30,000 rows also in this work fleet and when we can't be down will be

88
00:05:48.020 --> 00:05:52.550
reminded of one of the limitations off working with the rate formulas,

89
00:05:52.550 --> 00:05:55.420
they are quite process an intensive,

90
00:05:55.420 --> 00:05:58.310
so they can take a long time to calculate.

91
00:05:58.310 --> 00:06:01.850
You do have lots of rose in the work treat,

92
00:06:01.850 --> 00:06:17.070
so that's what 30,000 rose on average machine.

93
00:06:17.070 --> 00:06:23.250
So obviously you're either you're working with a slow machine or you have lots of rose.

94
00:06:23.250 --> 00:06:28.200
Then there's gonna be a trade off between the sophistication provided by using the rate

95
00:06:28.200 --> 00:06:34.210
formulas on the performance hit that you can expect if you end up pushing your computer

96
00:06:34.210 --> 00:06:36.750
system to its physical limits.

