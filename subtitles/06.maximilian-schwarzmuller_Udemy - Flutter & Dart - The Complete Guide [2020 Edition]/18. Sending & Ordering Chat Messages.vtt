WEBVTT
1
00:00:02.200 --> 00:00:07.210
Natürlich müssen wir in der Lage sein, neue Nachrichten zu senden, und deshalb werde ich ein neues Widget in den Chat-Ordner einfügen.

2
00:00:07.210 --> 00:00:09.630
Neue Nachricht beginnt jetzt.

3
00:00:09.730 --> 00:00:15.630
Dies kann auch ein Widget ohne Status sein, es sollte jedoch ein Widget mit vollständigem Status sein.

4
00:00:15.640 --> 00:00:23.720
Weil ich tatsächlich in der Lage sein möchte, die Benutzereingaben zu validieren und die Senden-Schaltfläche zu deaktivieren.

5
00:00:23.800 --> 00:00:25.860
Wenn nichts eingegeben wurde.

6
00:00:25.960 --> 00:00:29.660
Also hier sind alle als neue Nachricht benannt.

7
00:00:29.800 --> 00:00:34.900
Und dann beginnt natürlich das Importmaterial aus dem Flatterpaket.

8
00:00:35.080 --> 00:00:37.570
Und was sollen wir hierher zurückkehren?

9
00:00:37.570 --> 00:00:40.080
Nun, wir können einen Container eigentlich nicht zurückgeben.

10
00:00:40.240 --> 00:00:49.810
Sollte mit einem kleinen Rand gut funktionieren, den ich allerdings nur oben haben möchte, also werde ich hier in diesem Container

11
00:00:49.810 --> 00:00:55.990
einen oberen Rand hinzufügen, damit zwischen unserem Textfeld und der Nachrichtenliste ein gewisser Abstand

12
00:00:55.990 --> 00:01:05.370
besteht, und ich werde es auch tun Fügen Sie auch eine Polsterung mit Ätzinsekten von allen acht hinzu, damit wir auch

13
00:01:05.370 --> 00:01:09.520
etwas Platz in diesem Widget für Texteingabefelder haben.

14
00:01:09.990 --> 00:01:14.610
Und dann ist das Kind hier eine Rolle, weil ich eigentlich zwei Elemente

15
00:01:14.610 --> 00:01:22.010
nebeneinander haben möchte, das eigentliche Texteingabefeld und die Schaltfläche zum Senden der Nachricht, also brauchen wir hier die Kinder und das

16
00:01:22.070 --> 00:01:23.990
erste Kind ist ein Textfeld.

17
00:01:23.990 --> 00:01:30.550
Hier sind reguläre Textfelder, da ich diese nicht in ein Formular einbinde, das ich gerade unterwegs validiert habe.

18
00:01:30.560 --> 00:01:37.350
Sozusagen ohne ein großes Forum, da wir dies hier für dieses sehr grundlegende Eingabefeld nicht benötigen, würden Sie jetzt einen Fehler wie

19
00:01:37.350 --> 00:01:41.320
diesen erhalten, den Sie tatsächlich einschließen müssen, um dies ebenfalls zu erweitern.

20
00:01:41.340 --> 00:01:47.190
Andernfalls verursacht ein Textfeld in einer Zeile einen Fehler, da es versucht, zu viel Platz in Anspruch zu nehmen, wenn

21
00:01:47.190 --> 00:01:48.320
es erweitert wird.

22
00:01:48.330 --> 00:01:50.070
Dies wird jedoch funktionieren.

23
00:01:50.460 --> 00:01:55.920
Jetzt füge ich im Textfeld eine Dekorationseingabe hinzu, in der ich eine Bezeichnung für

24
00:01:59.460 --> 00:02:09.560
das Senden einer Nachricht festlege, um klarer zu machen, was dieses Textfeld tut, falls es nicht klar ist, und ich möchte jeden Tastendruck mit dem geänderten

25
00:02:09.560 --> 00:02:14.810
Ereignis abhören hier mit der unveränderten Funktion, wo wir die Benutzereingaben erhalten und

26
00:02:14.810 --> 00:02:21.170
wo wir dann etwas tun können, zum Beispiel eine Schaltfläche validiert und entsperrt, um sie zu senden.

27
00:02:21.170 --> 00:02:28.550
Dies ist der Punkt, den ich neben dem erweiterten Widget hinzufügen werde. Hier kann ich eine Schaltfläche erstellen, und

28
00:02:28.550 --> 00:02:39.300
dies sollte ein Abstieg sein Symbol, also hier füge ich eine Farbe des Themas des Kontextes hinzu. Primärfarbe Primärfarbe und ich füge ein Symbol hinzu, das gesendet werden

29
00:02:39.300 --> 00:02:48.180
soll. Ich kann jetzt natürlich hören, dass diese Schaltfläche auch auf einem gedrückten Handler benötigt wird, damit etwas passiert oder es passieren kann,

30
00:02:48.330 --> 00:02:50.150
wenn wir klicken darauf.

31
00:02:52.230 --> 00:02:55.330
Die Schaltfläche sollte auch nur aktiviert werden, wenn eine Nachricht eingegeben wurde.

32
00:02:55.360 --> 00:03:03.240
Sie bieten im Status "Neue Nachricht" an, dass wir diesen Status verwalten können. Wir können eine Nachricht mit variabler Eingabe haben,

33
00:03:03.240 --> 00:03:11.890
die anfänglich eine leere Zeichenfolge ist. Bei einer Änderung rufen wir den Status "set" auf und setzen die eingegebene Nachricht auf den Wert, den

34
00:03:11.890 --> 00:03:13.660
wir hier erhalten haben.

35
00:03:13.660 --> 00:03:19.630
Dies wird nun bei jedem Tastendruck ausgeführt, sodass wir die gespeicherte eingegebene Nachricht bei jedem Tastendruck aktualisieren.

36
00:03:19.630 --> 00:03:26.980
Und jetzt können wir die eingegebene Nachricht verwenden, um die Symbolschaltfläche zu sperren oder zu entsperren, indem wir nur bedingt Funktionsstörungen hinzufügen.

37
00:03:26.980 --> 00:03:36.060
Wenn Sie also auf die Schaltfläche "Ich kann" klicken, können Sie überprüfen, ob die eingegebene Nachricht, die zugeschnitten wurde, leer ist.

38
00:03:36.310 --> 00:03:43.270
Wenn es leer ist, wissen wir, dass wir keine gültige Meldung haben, selbst nachdem alle Leerzeichen von X mit Trimm entfernt wurden.

39
00:03:43.270 --> 00:03:49.660
Wenn dies der Fall ist, wird alles gedrückt, um zu wissen, was bedeutet, dass keine Funktion angeschlossen und sichtbar

40
00:03:49.660 --> 00:03:52.370
ist. Deaktiviert automatisch eine Schaltfläche, die flacher funktioniert.

41
00:03:52.690 --> 00:03:58.860
Wenn die Nachricht nicht leer ist, setze ich hier eine Funktionsstörung als Wert für unverarbeitet.

42
00:03:58.870 --> 00:04:03.520
Nun gibt es eine Funktion, die ausgeführt werden kann, wenn die Tasten gedrückt werden, und daher wird die Taste jetzt

43
00:04:05.470 --> 00:04:05.710
aktiviert.

44
00:04:05.710 --> 00:04:08.820
Im Moment senden wir keine Nachricht, aber das sollte bereits funktionieren.

45
00:04:08.830 --> 00:04:15.310
Gehen wir also zum Chat-Bildschirm und dort haben wir unten eine Spalte mit unseren Nachrichten.

46
00:04:15.310 --> 00:04:22.690
Die Nachrichten hier können wir daher jetzt einfach unser neues Nachrichten-Widget hinzufügen.

47
00:04:22.690 --> 00:04:31.550
Und natürlich müssen Sie neue Nachrichten ab dem jeweiligen Pfad hier importieren. Wenn Sie diese speichern, haben wir diese

48
00:04:31.580 --> 00:04:36.800
Nachricht hier unten und führen eine nervige schwebende Aktionsschaltfläche aus.

49
00:04:37.010 --> 00:04:38.990
Wir können dies nicht vollständig löschen.

50
00:04:39.050 --> 00:04:42.460
Wir brauchen den schwebenden Aktionsknopf nicht mehr, also lasst uns ihn loswerden.

51
00:04:44.290 --> 00:04:44.800
So wie das.

52
00:04:45.400 --> 00:04:48.160
Und jetzt hier ist zum Senden der Nachrichtentaste deaktiviert.

53
00:04:48.160 --> 00:04:51.640
Wenn ich jedoch eine gültige Nachricht eingebe, ist diese aktiviert und ich kann sie drücken.

54
00:04:52.060 --> 00:04:54.080
Aber im Moment passiert natürlich nichts.

55
00:04:54.160 --> 00:04:55.300
Also müssen wir das ändern.

56
00:04:55.300 --> 00:05:00.660
Wir müssen sicherstellen, dass wir auch unkonzentriert sind, wenn wir dies drücken.

57
00:05:00.670 --> 00:05:07.460
Dieses Feld, damit die Tastatur automatisch verschwindet, aber dann wird die gesamte Nachricht gesendet.

58
00:05:07.540 --> 00:05:13.030
Jetzt beginne ich mit einer unscharfen Sache, bei der eine Funktionsstörung ausgelöst werden sollte, und ich möchte hier nicht

59
00:05:13.030 --> 00:05:14.860
alles in dieser anonymen Funktion schreiben.

60
00:05:14.950 --> 00:05:24.820
Stattdessen füge Robert hier oben eine Funktion hinzu. Nachricht senden. Dort verwende ich zunächst den Fokusbereich außerhalb des Kontexts und rufe

61
00:05:24.880 --> 00:05:33.030
unscharf auf, um die möglicherweise geöffnete Tastatur zu schließen, und die gesendete Nachricht, die sie anbieten, ist hier

62
00:05:33.060 --> 00:05:40.420
wie folgt verbunden Ohne Klammern, die nur darauf zeigen, und anstatt Nachricht senden, möchten wir

63
00:05:40.420 --> 00:05:45.400
jetzt Fire Store verwenden, um diese neue Nachricht zu erstellen.

64
00:05:45.400 --> 00:05:53.620
Dazu importieren wir das Paket Cloud Fire Storage Cloud Fire Store Dot Dart und dann können

65
00:05:53.620 --> 00:05:59.800
wir hier die Fire Store-Dateninstanz verwenden und auf die Chet-Sammlung abzielen.

66
00:05:59.800 --> 00:06:05.200
Und hier wollen wir jetzt ein neues Dokument hinzufügen, das wir mit der Methode add machen.

67
00:06:05.220 --> 00:06:11.550
Dies erfordert nun eine Karte, die das neue Dokument beschreibt, und wir möchten hier ein

68
00:06:11.640 --> 00:06:19.330
Textfeld haben, da jede Chat-Nachricht ein Textfeld haben sollte. Unsere Dummy-Nachricht hat ein Textfeld, und die Werte sollten natürlich

69
00:06:19.330 --> 00:06:21.230
die eingegebene Nachricht sein.

70
00:06:21.350 --> 00:06:28.240
Was also in dieser Variablen gespeichert ist und das sollte alles sein, was wir tun müssen, um eine neue Nachricht zu senden.

71
00:06:28.320 --> 00:06:31.840
Dies gibt uns eine Zukunft und wir könnten warten, bis sie abgeschlossen ist.

72
00:06:31.860 --> 00:06:36.510
Wir könnten einen Ladespinner zeigen, aber ich denke, in einer Chat-Anwendung brauchen wir das nicht wirklich.

73
00:06:36.540 --> 00:06:38.630
Das sollte also wirklich alles sein, was wir brauchen.

74
00:06:38.640 --> 00:06:44.410
Und bitte beachten Sie, dass wir auch kein Authentifizierungstoken oder ähnliches hinzufügen müssen.

75
00:06:44.430 --> 00:06:48.530
Dies alles wird hier hinter den Kulissen von Firebase verwaltet.

76
00:06:48.630 --> 00:06:54.920
Wenn wir dies einfach speichern, sollten wir in der Lage sein, eine neue Nachricht zu senden, wenn ich eine eingebe.

77
00:06:55.150 --> 00:06:59.870
Funktioniert das und ich klicke auf Senden? Hier ist meine Nachricht.

78
00:06:59.900 --> 00:07:03.640
Jetzt ist die Formatierung natürlich nicht endgültig, aber das ist meine Nachricht.

79
00:07:03.830 --> 00:07:04.980
Das funktioniert also.

80
00:07:05.120 --> 00:07:11.330
Nun zwei Verbesserungen, ich denke, es wäre schön, wenn das Nachrichteneingabefeld dort danach gelöscht würde.

81
00:07:11.480 --> 00:07:17.900
Außerdem möchte ich sicherstellen, dass die Nachrichten in die entgegengesetzte Richtung sortiert sind, sodass die neueste

82
00:07:17.900 --> 00:07:24.500
Nachricht hier unten und nicht oben angezeigt wird, um sicherzustellen, dass dies geschieht, um sicherzustellen, dass die

83
00:07:24.500 --> 00:07:25.900
Reihenfolge korrekt ist.

84
00:07:26.070 --> 00:07:29.430
Wir können nur einen Pfeil zur Nachricht gehen und sie sind in der Listenansicht.

85
00:07:29.420 --> 00:07:32.940
Es gibt ein kleines zusätzliches Feld, das Sie einstellen können.

86
00:07:32.940 --> 00:07:38.520
Sie können das Gegenteil auf true setzen. Dadurch wird genau das getan, was der Name andeutet. Dadurch werden die Nachrichten

87
00:07:38.610 --> 00:07:39.820
oder Felder anders sortiert.

88
00:07:39.840 --> 00:07:42.620
Es wird von unten nach oben gescrollt.

89
00:07:42.750 --> 00:07:50.300
Jetzt werden Sie sehen, dass hellos immer noch unter Staub als Arbeit bestellt ist, einfach weil die automatische Idee erstellt wurde,

90
00:07:50.310 --> 00:07:52.890
als ich dieses Dokument manuell bearbeitete.

91
00:07:53.310 --> 00:07:55.970
Aber wenn ich dieses Dokument mit Hallo lösche.

92
00:07:55.980 --> 00:08:02.720
Wenn ich also Hallo hier eingebe, siehst du jetzt, dass dies unten ist, also ist das schön.

93
00:08:02.770 --> 00:08:09.310
Um nun die Eingabe hier in Neue Nachricht zu löschen, möchte

94
00:08:09.310 --> 00:08:17.740
ich die Nachricht oder die Eingabe löschen, wenn wir eine neue Nachricht senden. Dazu können

95
00:08:17.800 --> 00:08:30.480
wir dem Textfeld hier einen Controller hinzufügen und hier in unserem Zustand einen neuen Controller erstellen, einen endgültigen Controller neuer Textbearbeitungs-Controller wie dieser.

96
00:08:33.060 --> 00:08:42.500
Verwenden Sie diesen Controller hier und senden Sie eine Nachricht, um einen Controller clear aufzurufen. Binden Sie diesen Controller jetzt

97
00:08:42.500 --> 00:08:47.620
an das Textfeld, indem Sie hier im Controller-Argument darauf zeigen.

98
00:08:48.630 --> 00:08:58.640
Wenn wir jetzt Sicherheiten haben und ich tippe, wird dies klar, Sie sehen, dass es klar ist und dies auch geschlossen ist.

99
00:08:58.700 --> 00:09:06.250
Jetzt sehen Sie jedoch auch, dass die Bestellung hier immer noch nicht ganz so funktioniert, wie sie sollte, und Sie sehen, dass

100
00:09:06.250 --> 00:09:08.780
das ganze Jahr standardmäßig in Firebase ist.

101
00:09:08.920 --> 00:09:14.350
Das älteste Dokument ist das oberste und das jüngste das unterste.

102
00:09:14.380 --> 00:09:18.540
Und da wir dies hier umkehren, ist es das Gegenteil.

103
00:09:18.760 --> 00:09:26.530
Eine Möglichkeit, dies korrekt zu bestellen und sicherzustellen, dass wir eine konsistente Reihenfolge haben, besteht darin, den Zeitstempel

104
00:09:26.560 --> 00:09:31.820
zusammen mit dem Text zu speichern, wenn ein Dokument erstellt wird.

105
00:09:31.930 --> 00:09:34.540
Und wir haben nicht nach diesem Zeitstempel bestellt.

106
00:09:34.630 --> 00:09:42.490
Hier auf NEUE NACHRICHT können wir dann zu der Stelle gehen, an der wir ein neues Dokument hinzufügen, und neben Text können wir auch

107
00:09:42.490 --> 00:09:44.810
ein Feld erstellen, das bei erstellt wurde.

108
00:09:44.950 --> 00:09:47.600
Der Name liegt bei Ihnen muss nicht erstellt werden.

109
00:09:48.010 --> 00:09:52.600
Anschließend können Sie den Zeitstempel verwenden, um einen neuen Zeitstempel zu erstellen.

110
00:09:52.600 --> 00:10:00.360
Jetzt ist der Zeitstempel eine Klasse, die jetzt mit dem Cloud Fire Store-Paket verfügbar gemacht wird.

111
00:10:00.360 --> 00:10:05.550
Wir erstellen den Zeitstempel, der Teil des Dokuments ist, das gespeichert wird, und das im Feld gespeichert

112
00:10:05.640 --> 00:10:06.810
und erstellt wird.

113
00:10:06.810 --> 00:10:12.900
Wenn wir also die Nachrichten hier abrufen, bevor wir diesen Listener oder diesen Stream eingerichtet haben, bevor wir Zugriff auf

114
00:10:12.900 --> 00:10:18.630
diesen Stream und die Sammlung erhalten, können wir tatsächlich order by aufrufen. Auf diese Weise können wir die

115
00:10:18.660 --> 00:10:24.720
Dokumente bestellen, die wir abrufen möchten bestimmtes Feld und wir können bestellen, indem wir so durch das neue Feld

116
00:10:24.750 --> 00:10:25.440
erstellt werden.

117
00:10:25.440 --> 00:10:31.770
Ich habe gerade hinzugefügt. Natürlich haben meine vorhandenen Nachrichten dieses Feld nicht, sodass ich alle diese Nachrichten

118
00:10:31.770 --> 00:10:32.940
schnell löschen werde.

119
00:10:32.940 --> 00:10:38.400
Wenn Sie viele Nachrichten haben, können Sie auch die gesamte Chat-Sammlung löschen. Stattdessen wird sie

120
00:10:38.490 --> 00:10:41.450
automatisch neu erstellt, sobald Sie erneut Nachrichten hinzufügen.

121
00:10:41.880 --> 00:10:47.460
Aber sobald es leer ist, gehe ich zurück und sende eine neue Nachricht.

122
00:10:47.460 --> 00:10:49.350
Hallo.

123
00:10:49.490 --> 00:10:50.990
Funktioniert das.

124
00:10:54.010 --> 00:10:59.140
Und Sie sehen, es ist immer noch richtig bestellt, aber einfach, weil wir angeben müssen, wie wir dies bestellen

125
00:10:59.140 --> 00:10:59.690
möchten.

126
00:10:59.920 --> 00:11:03.800
Und standardmäßig ist es aufsteigend angeordnet.

127
00:11:03.830 --> 00:11:08.760
Ich möchte jedoch in absteigender Reihenfolge bestellen, daher setze ich absteigend hier auf "wahr".

128
00:11:08.870 --> 00:11:12.320
Dies ist das zweite Argument, nach dem Sie bestellen können.

129
00:11:12.320 --> 00:11:17.030
Und wenn Sie den Abstieg zu Drew einstellen, funktioniert dies als zweite Nachricht hier.

130
00:11:18.660 --> 00:11:24.740
Also diese Nachricht, die ich etwas später eingereicht habe und die erste und wenn ich eine weitere neue Nachricht und

131
00:11:25.160 --> 00:11:27.650
keine neue Nachricht hinzufüge, werden Sie das sehen.

132
00:11:27.650 --> 00:11:33.270
Dies ist die unterste Meldung. Selbst wenn ich die App hier neu starte, wenn ich sie vollständig neu geladen

133
00:11:33.260 --> 00:11:34.910
habe, wird diese Reihenfolge beibehalten.

134
00:11:34.910 --> 00:11:40.730
Jetzt haben wir endlich die richtige Reihenfolge hier, was natürlich super wichtig ist und

135
00:11:40.820 --> 00:11:43.070
was wir letztendlich hier wollen.

136
00:11:43.070 --> 00:11:46.880
Lassen Sie uns damit an diesen Chat-Nachrichten arbeiten.

137
00:11:46.880 --> 00:11:48.670
Sie sehen so ein bisschen hässlich aus.

138
00:11:48.830 --> 00:11:53.840
Und natürlich möchten wir auch sicherstellen, dass wir schnell erkennen können, ob diese Nachricht von uns oder von einem anderen

139
00:11:53.860 --> 00:11:54.620
Benutzer stammt.
