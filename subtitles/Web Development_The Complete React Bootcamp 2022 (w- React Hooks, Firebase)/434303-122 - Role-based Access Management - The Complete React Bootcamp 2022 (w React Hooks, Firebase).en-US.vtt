WEBVTT
X-TIMESTAMP-MAP=LOCAL:00:00:00.000,MPEGTS:0

00:00:00.000 --> 00:00:01.080
Hey there.

00:00:01.080 --> 00:00:01.770
In this video,

00:00:01.770 --> 00:00:07.060
we will add button in order to be able to manage role based permission.

00:00:07.060 --> 00:00:09.950
So when we click on someone's user profile,

00:00:09.950 --> 00:00:13.080
if we are currently and had been off this group,

00:00:13.080 --> 00:00:18.790
we are able to create this user and had been to Let's not get back to code.

00:00:18.790 --> 00:00:20.750
And let's open,

00:00:20.750 --> 00:00:21.340
I guess.

00:00:21.340 --> 00:00:22.330
Message item.

00:00:22.330 --> 00:00:26.880
So here we will do a little modification to profile info,

00:00:26.880 --> 00:00:27.810
BT and model.

00:00:27.810 --> 00:00:28.970
So let's open it.

00:00:28.970 --> 00:00:33.040
And here we want to display this button here at the bottom.

00:00:33.040 --> 00:00:34.380
How we can do this?

00:00:34.380 --> 00:00:34.900
Well,

00:00:34.900 --> 00:00:36.190
it is actually easy.

00:00:36.190 --> 00:00:41.550
We can pass some Children to this component and they will be displayed over here.

00:00:41.550 --> 00:00:44.820
So here in side profile in four billion model,

00:00:44.820 --> 00:00:51.420
we're also gonna d structure Children and then those Children we will display in footer

00:00:51.420 --> 00:00:53.550
right before our close button.

00:00:53.550 --> 00:00:54.930
Now let's save it.

00:00:54.930 --> 00:00:57.220
Let's not engage to a message item.

00:00:57.220 --> 00:01:00.250
And here for profile in for Betty Anne Morrow,

00:01:00.250 --> 00:01:06.050
let's pass another bottom so this bottom will be a block element,

00:01:06.050 --> 00:01:12.110
and on click is going to be something that will define in a few of seconds.

00:01:12.110 --> 00:01:12.840
Also,

00:01:12.840 --> 00:01:17.870
it will have color blue and text is going to be the next.

00:01:17.870 --> 00:01:18.170
So,

00:01:18.170 --> 00:01:21.690
first of all we need to define when this button will be displayed.

00:01:21.690 --> 00:01:22.210
Maybe,

00:01:22.210 --> 00:01:23.170
let's commented.

00:01:23.170 --> 00:01:28.410
And here let's create a few bad apples and let's first move it to the talk like that.

00:01:28.410 --> 00:01:29.090
Okay,

00:01:29.090 --> 00:01:34.270
so first we need to define if we can grant admin permission.

00:01:34.270 --> 00:01:35.510
So for that,

00:01:35.510 --> 00:01:37.880
we need to get our contacted data.

00:01:37.880 --> 00:01:42.850
So let's get is admin from use current room.

00:01:42.850 --> 00:01:46.120
Let me open car into room context,

00:01:46.120 --> 00:01:51.190
then let me import the hook and from value Begin a peak is admin.

00:01:51.190 --> 00:01:53.980
And also we need other admits as well.

00:01:53.980 --> 00:01:56.570
So use current room value.

00:01:56.570 --> 00:01:58.760
Value admits like that.

00:01:58.760 --> 00:02:05.570
Then let's wrap our message item around memo because we use use context selector and here

00:02:05.570 --> 00:02:06.550
we will do the next.

00:02:06.550 --> 00:02:11.610
First we need to know if message author is an admin.

00:02:11.610 --> 00:02:20.750
So let's create his message author admin and we're gonna ask Edmunds Includes author,

00:02:20.750 --> 00:02:22.940
author door you I d.

00:02:22.940 --> 00:02:31.790
Then we need to know if we are the message author so we can create his author of Edible and

00:02:31.790 --> 00:02:34.610
we can ask us current.

00:02:34.610 --> 00:02:43.040
Let's import off off current user dot your I d equals author indoor you I d like this.

00:02:43.040 --> 00:02:51.070
And then we can create another edible which will name let's say can grant access or can

00:02:51.070 --> 00:02:52.350
grant admin.

00:02:52.350 --> 00:02:59.670
And we are able to grant admin permission if we are add Mons ourselves.

00:02:59.670 --> 00:03:00.500
And also,

00:03:00.500 --> 00:03:07.650
if we are not message authors so now we can use all of those valuables to display our

00:03:07.650 --> 00:03:09.040
button conditionally.

00:03:09.040 --> 00:03:10.160
So first,

00:03:10.160 --> 00:03:11.150
we're gonna poor.

00:03:11.150 --> 00:03:14.750
If we can grant admin only done,

00:03:14.750 --> 00:03:20.900
we will display this bottom and also for the message We're going to put his message,

00:03:20.900 --> 00:03:22.280
author admin.

00:03:22.280 --> 00:03:26.570
Then we're gonna say remove admin permission.

00:03:26.570 --> 00:03:29.360
As otherwise we're gonna say,

00:03:29.360 --> 00:03:34.450
give admin in this room something like that.

00:03:34.450 --> 00:03:35.180
Okay,

00:03:35.180 --> 00:03:35.540
now,

00:03:35.540 --> 00:03:36.350
actually,

00:03:36.350 --> 00:03:37.960
let's see what we did.

00:03:37.960 --> 00:03:38.860
Let me refresh.

00:03:38.860 --> 00:03:42.060
Just in case if I opened this profile,

00:03:42.060 --> 00:03:44.710
I can see give admin in this room.

00:03:44.710 --> 00:03:45.650
So when I click,

00:03:45.650 --> 00:03:49.090
nothing happens because we didn't define any functionality.

00:03:49.090 --> 00:03:55.980
So lets navigate here and all the functionality we're going to pour inside messages

00:03:55.980 --> 00:03:56.670
component,

00:03:56.670 --> 00:04:00.300
and then we're gonna pass this functionality to message item.

00:04:00.300 --> 00:04:00.920
Okay,

00:04:00.920 --> 00:04:02.990
so for message item here,

00:04:02.990 --> 00:04:10.000
we're gonna have let's say handle admin function that we will pass that we will get.

00:04:10.000 --> 00:04:11.680
And for this handle admin.

00:04:11.680 --> 00:04:12.860
We're gonna pass.

00:04:12.860 --> 00:04:13.640
Let's say,

00:04:13.640 --> 00:04:15.360
author dot your I d.

00:04:15.360 --> 00:04:15.970
All right,

00:04:15.970 --> 00:04:22.460
now we need to get this handle admin from props and let's navigate to messages.

00:04:22.460 --> 00:04:26.130
And here we're going to define constant handle admin,

00:04:26.130 --> 00:04:33.340
and let's optimize it in advance with use call back because we pass it down to child

00:04:33.340 --> 00:04:34.090
element.

00:04:34.090 --> 00:04:34.490
OK,

00:04:34.490 --> 00:04:38.290
so this handle admin will receive your i d.

00:04:38.290 --> 00:04:44.900
And then let's first define our Edmunds ref inside database so we can a call database

00:04:44.900 --> 00:04:45.700
object.

00:04:45.700 --> 00:04:51.420
Then reference is going to be rooms than it is going to be Chat I d.

00:04:51.420 --> 00:04:55.760
That we already have from use perms and then slash advance.

00:04:55.760 --> 00:04:56.900
All right,

00:04:56.900 --> 00:05:02.320
now we need to add chat ideas a dependency and hear what we need to do.

00:05:02.320 --> 00:05:07.420
We need to actually get our previous value in order to trigger it.

00:05:07.420 --> 00:05:12.730
So if we click on this button and we want to grant the permission,

00:05:12.730 --> 00:05:13.860
then it will be at it.

00:05:13.860 --> 00:05:14.640
Otherwise,

00:05:14.640 --> 00:05:16.800
if this user already have the permission,

00:05:16.800 --> 00:05:18.450
we want to revoke it.

00:05:18.450 --> 00:05:22.080
So actually to do it with real time data base,

00:05:22.080 --> 00:05:24.410
if we open its documentation,

00:05:24.410 --> 00:05:30.130
we can see this section under reading right data save data Estrin sections.

00:05:30.130 --> 00:05:31.740
So using this way,

00:05:31.740 --> 00:05:36.190
we're able to get access to the previous value and we can update it.

00:05:36.190 --> 00:05:37.480
And most importantly,

00:05:37.480 --> 00:05:38.600
it is transaction.

00:05:38.600 --> 00:05:41.550
It means that data will not be corrupted.

00:05:41.550 --> 00:05:44.700
So let's actually use exactly the same approach.

00:05:44.700 --> 00:05:51.340
So let me copy all of that and what I will dio I'm gonna call await what's convert this

00:05:51.340 --> 00:05:52.850
issue racing function.

00:05:52.850 --> 00:05:57.470
Let's call evade add men's Ralf Dar transaction.

00:05:57.470 --> 00:06:01.050
Then we receive our current or previous value,

00:06:01.050 --> 00:06:05.080
which is going to be admittance and hear what we're gonna put it.

00:06:05.080 --> 00:06:12.520
I'm gonna paste the same code that I cooperated and here I'm gonna ask if admissions exist

00:06:12.520 --> 00:06:12.520
.

00:06:12.520 --> 00:06:14.640
Only then I will perform my logic.

00:06:14.640 --> 00:06:16.570
So if admits exist,

00:06:16.570 --> 00:06:19.910
then I want to ask if admits,

00:06:19.910 --> 00:06:22.560
you I d exist.

00:06:22.560 --> 00:06:24.900
Then I want to revoke the access.

00:06:24.900 --> 00:06:28.220
So I'm gonna set admits your I d to know.

00:06:28.220 --> 00:06:31.430
And when we set value to know for real time database,

00:06:31.430 --> 00:06:37.090
it will be deleted from the database because you actually can store no values there.

00:06:37.090 --> 00:06:40.470
So now if we don't have the permission,

00:06:40.470 --> 00:06:41.480
then we're gonna grunted.

00:06:41.480 --> 00:06:45.270
So advance your i d will be set to True.

00:06:45.270 --> 00:06:47.650
Now let's remove the rest of the code.

00:06:47.650 --> 00:06:48.620
And in the end,

00:06:48.620 --> 00:06:50.040
we're gonna return admits,

00:06:50.040 --> 00:06:52.280
and it will do its thing.

00:06:52.280 --> 00:06:52.640
Right?

00:06:52.640 --> 00:06:52.990
Call.

00:06:52.990 --> 00:06:53.210
Now,

00:06:53.210 --> 00:06:58.780
we need to notify the user whether we revoked or granted the access.

00:06:58.780 --> 00:07:03.990
So we're gonna put alert door in for And what should report here?

00:07:03.990 --> 00:07:08.850
How can we specify whether we revoked or granted access for that?

00:07:08.850 --> 00:07:13.230
We can create available over here that we will resign.

00:07:13.230 --> 00:07:14.990
Let's say alert message.

00:07:14.990 --> 00:07:18.570
So when we have revoked access,

00:07:18.570 --> 00:07:19.840
we're gonna set alert.

00:07:19.840 --> 00:07:21.870
Message to admin.

00:07:21.870 --> 00:07:23.950
Permission removed.

00:07:23.950 --> 00:07:25.280
And for true,

00:07:25.280 --> 00:07:27.290
begin a specified Miller message.

00:07:27.290 --> 00:07:30.050
Admin permission granted,

00:07:30.050 --> 00:07:31.560
something like this.

00:07:31.560 --> 00:07:35.580
Then we're gonna pass this alert message to alert info,

00:07:35.580 --> 00:07:39.760
and I We need to pass this handle admin down to message item.

00:07:39.760 --> 00:07:42.000
So let's board handle admin.

00:07:42.000 --> 00:07:43.210
Handle admin.

00:07:43.210 --> 00:07:43.620
Now,

00:07:43.620 --> 00:07:45.490
let's actually take a look.

00:07:45.490 --> 00:07:47.710
Let's navigate back to our app.

00:07:47.710 --> 00:07:49.750
If I click on this user,

00:07:49.750 --> 00:07:51.560
give admin in this room.

00:07:51.560 --> 00:07:53.350
Admin Permission granted.

00:07:53.350 --> 00:07:55.490
Now I have remove admin permission.

00:07:55.490 --> 00:07:56.770
If I click on it,

00:07:56.770 --> 00:07:59.200
I can see admin permission removed.

00:07:59.200 --> 00:08:01.270
Let's navigate you our database.

00:08:01.270 --> 00:08:02.660
Let's find this room,

00:08:02.660 --> 00:08:05.750
which is room in for that room.

00:08:05.750 --> 00:08:06.220
Now.

00:08:06.220 --> 00:08:07.620
If I grant access,

00:08:07.620 --> 00:08:10.190
you can see a new value inside database.

00:08:10.190 --> 00:08:12.060
And if I remove access,

00:08:12.060 --> 00:08:14.470
I can see it has been removed from the database.

00:08:14.470 --> 00:08:15.510
All right,

00:08:15.510 --> 00:08:20.760
I guess that's all about security and role based management.

00:08:20.760 --> 00:08:24.190
Let's actually commit our changes and finish this video.

00:08:24.190 --> 00:08:25.240
But before we do that,

00:08:25.240 --> 00:08:27.470
let's move this import to the top,

00:08:27.470 --> 00:08:29.550
and then let's commit changes.

00:08:29.550 --> 00:08:31.370
So get at everything,

00:08:31.370 --> 00:08:40.330
then get commit and we're gonna say added button to grant or revoke admin access.

00:08:40.330 --> 00:08:41.260
All right,

00:08:41.260 --> 00:08:42.060
Perfect.

00:08:42.060 --> 00:08:43.370
See you in the next one.

