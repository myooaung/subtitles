WEBVTT
ï»¿1
00:00:00.000 --> 00:00:15.610
in this section will move on to look at one of excels very powerful but also very little

2
00:00:15.610 --> 00:00:16.980
known features.

3
00:00:16.980 --> 00:00:22.520
And that is the ability to transform an XML document as it's imported into excel.

4
00:00:22.520 --> 00:00:28.890
We've already seen that there are many XML documents which don't have a structure that

5
00:00:28.890 --> 00:00:35.510
lends itself to being imported into Microsoft Excel and when used in such XML documents in

6
00:00:35.510 --> 00:00:37.220
your work flows excess.

7
00:00:37.220 --> 00:00:43.990
Lt starches become very useful because they enable you to transform any XML document into a

8
00:00:43.990 --> 00:00:50.510
structure which Excel can accept on which can be imported into an XML table within an Excel

9
00:00:50.510 --> 00:00:51.350
worksheet.

10
00:00:51.350 --> 00:00:53.830
In order to apply an excess,

11
00:00:53.830 --> 00:00:59.060
lt style she to an XML document so that you can transform it into a different structure.

12
00:00:59.060 --> 00:01:01.110
You need an excess lt process,

13
00:01:01.110 --> 00:01:01.350
sir,

14
00:01:01.350 --> 00:01:07.950
and the good news is there's an excess lt process of built into Microsoft Excel.

15
00:01:07.950 --> 00:01:15.460
The bad news is not a lot of people know it even exists as we've seen.

16
00:01:15.460 --> 00:01:21.150
Most of the XML features within Microsoft Excel are accessed by the developer tab,

17
00:01:21.150 --> 00:01:23.600
but for some peculiar reason,

18
00:01:23.600 --> 00:01:30.560
the excess lt Princess in facility can only be accessed when you use file open and then

19
00:01:30.560 --> 00:01:32.650
double click on an XML file.

20
00:01:32.650 --> 00:01:35.610
If you use any other method of bringing in you,

21
00:01:35.610 --> 00:01:37.760
XML excels excess.

22
00:01:37.760 --> 00:01:40.450
Lt features will not be accessible.

23
00:01:40.450 --> 00:01:46.890
A second requirement for access in the excess lt features within Microsoft Excel is that

24
00:01:46.890 --> 00:01:52.900
you have a process in instruction in the XML document linking it to the excess.

25
00:01:52.900 --> 00:01:58.350
Lt style treat in question even if you have an excess lt style sheet available.

26
00:01:58.350 --> 00:02:00.330
But you haven't got a process.

27
00:02:00.330 --> 00:02:06.650
An instruction in the XML your transforming again these hidden excess lt process in

28
00:02:06.650 --> 00:02:07.950
features within Microsoft,

29
00:02:07.950 --> 00:02:10.280
Excel will not be accessible.

30
00:02:10.280 --> 00:02:15.340
Let's have a look at this process in action.

31
00:02:15.340 --> 00:02:21.350
So in the train involving that's going to 05 used in excess lt style sheets and then number

32
00:02:21.350 --> 00:02:24.190
one Xsl T and Microsoft Excel.

33
00:02:24.190 --> 00:02:29.490
Let's now look at a simple XML document in a style sheet that could be used to transform it

34
00:02:29.490 --> 00:02:29.490
.

35
00:02:29.490 --> 00:02:30.870
So first of all,

36
00:02:30.870 --> 00:02:32.650
that's going to tools dot xml.

37
00:02:32.650 --> 00:02:41.330
And here we've got a simple XML document with tools as the root element tool as the

38
00:02:41.330 --> 00:02:47.450
repeated element and then a series of child elements which contained the actual data.

39
00:02:47.450 --> 00:02:50.050
And at the top of this document,

40
00:02:50.050 --> 00:02:52.470
underneath the XML declaration,

41
00:02:52.470 --> 00:02:59.270
we have a process in instruction link in this document to another document in the same

42
00:02:59.270 --> 00:03:01.880
folder tools that xsl,

43
00:03:01.880 --> 00:03:05.490
which is the style shape that will be used to transform it.

44
00:03:05.490 --> 00:03:08.720
So this process an instruction is the standard,

45
00:03:08.720 --> 00:03:13.300
one that's used to link any XML document to a given style sheet.

46
00:03:13.300 --> 00:03:14.460
First of all,

47
00:03:14.460 --> 00:03:16.550
we have the name of the process and instruction,

48
00:03:16.550 --> 00:03:18.050
which is external style sheet.

49
00:03:18.050 --> 00:03:26.340
And then we've got a couple of attributes type specifying the type of linkage and a dress

50
00:03:26.340 --> 00:03:30.450
specifying the location off the linked file.

51
00:03:30.450 --> 00:03:36.850
Let's now have a look at the style sheet tools that xsl,

52
00:03:36.850 --> 00:03:46.150
and the first thing you'll notice is that it's a standard XML document has XML elements,

53
00:03:46.150 --> 00:03:48.650
and it's a well hold document.

54
00:03:48.650 --> 00:03:54.090
The root element of any xsl style sheet is style sheet,

55
00:03:54.090 --> 00:04:01.050
and it's here that will find the name Space Declaration state in the within.

56
00:04:01.050 --> 00:04:06.170
This document will prefix all elements and attributes which relate to excess.

57
00:04:06.170 --> 00:04:10.250
Lt transformation with the three letters xsl.

58
00:04:10.250 --> 00:04:11.170
Hence,

59
00:04:11.170 --> 00:04:15.250
the root element is written xsl colon style sheet.

60
00:04:15.250 --> 00:04:21.270
Within the style sheet elements we can see to top level elements.

61
00:04:21.270 --> 00:04:25.440
The term top level elements refers to those elements,

62
00:04:25.440 --> 00:04:27.970
which are Children of the style sheet element.

63
00:04:27.970 --> 00:04:31.050
So festival we have outputs,

64
00:04:31.050 --> 00:04:36.450
and here we can specify what type of out but we want to create,

65
00:04:36.450 --> 00:04:40.190
and the three most common methods are XML,

66
00:04:40.190 --> 00:04:42.150
HTML and text.

67
00:04:42.150 --> 00:04:45.410
When you're working with Excel transformations,

68
00:04:45.410 --> 00:04:47.630
you'll always be used in XML,

69
00:04:47.630 --> 00:04:54.240
as the method on the second attribute we have here in dent equals yes means that the output

70
00:04:54.240 --> 00:04:56.190
document will be human readable.

71
00:04:56.190 --> 00:05:03.650
Invent equals no means that it will be system readable but not so easily read by humans.

72
00:05:03.650 --> 00:05:08.850
And then the second top level element is the one that actually is used to do the

73
00:05:08.850 --> 00:05:09.790
transformation.

74
00:05:09.790 --> 00:05:12.150
And that's xsl template.

75
00:05:12.150 --> 00:05:14.110
Each template targets,

76
00:05:14.110 --> 00:05:18.050
a specific note said within the Input XML document,

77
00:05:18.050 --> 00:05:26.130
from its very important that the first template you define is one which targets the entire

78
00:05:26.130 --> 00:05:26.950
document.

79
00:05:26.950 --> 00:05:32.730
This means that you won't get unpredictable results in the output document because you have

80
00:05:32.730 --> 00:05:36.750
a template which handles everything in the input document.

81
00:05:36.750 --> 00:05:46.140
So to define that we use match equals or words slash and that forward slash represents the

82
00:05:46.140 --> 00:05:48.250
root of the XML document,

83
00:05:48.250 --> 00:05:49.030
which,

84
00:05:49.030 --> 00:05:49.610
of course,

85
00:05:49.610 --> 00:05:52.850
is the parent off everything inside the document.

86
00:05:52.850 --> 00:05:58.150
So what this means is that we have the entire document flowing into this template.

87
00:05:58.150 --> 00:06:00.040
And then in this case,

88
00:06:00.040 --> 00:06:06.610
we're saying that the first thing that's gonna happen in terms of output is the creation of

89
00:06:06.610 --> 00:06:09.550
a new route element called products.

90
00:06:09.550 --> 00:06:16.020
So to do that we use in xsl element and then specifying the name of that new element is

91
00:06:16.020 --> 00:06:21.350
products so we can see the import document as a rude called tools.

92
00:06:21.350 --> 00:06:29.160
We're now saying that the output document will instead have a root called products men.

93
00:06:29.160 --> 00:06:32.940
We specify what output we want inside that route.

94
00:06:32.940 --> 00:06:34.040
Element on,

95
00:06:34.040 --> 00:06:40.850
we do this by itemizing each of the note sets that we want to appear in the output document

96
00:06:40.850 --> 00:06:40.850
,

97
00:06:40.850 --> 00:06:42.260
and in this case,

98
00:06:42.260 --> 00:06:45.180
we using xsl apply templates,

99
00:06:45.180 --> 00:06:47.350
which means basically,

100
00:06:47.350 --> 00:06:53.670
look for elements called tour and see if there are any templates within this xsl style

101
00:06:53.670 --> 00:06:56.590
sheet designed for that element,

102
00:06:56.590 --> 00:07:01.540
and do whatever those templates tell you to any part of the input.

103
00:07:01.540 --> 00:07:02.350
XML,

104
00:07:02.350 --> 00:07:05.270
which isn't targeted by xsl,

105
00:07:05.270 --> 00:07:06.630
apply templates,

106
00:07:06.630 --> 00:07:09.690
simply won't be present in the output document.

107
00:07:09.690 --> 00:07:10.740
Obviously,

108
00:07:10.740 --> 00:07:11.370
in our case,

109
00:07:11.370 --> 00:07:19.320
tour is pretty much all there is the second template matches the tool element and then

110
00:07:19.320 --> 00:07:20.160
inside it.

111
00:07:20.160 --> 00:07:28.400
We say that every time we find a tour element will create a new element called product in

112
00:07:28.400 --> 00:07:30.340
the same way as we replace.

113
00:07:30.340 --> 00:07:39.210
Tours with products were now replace in tool with product inside each product element.

114
00:07:39.210 --> 00:07:44.150
We venues xsl copy off to copy the child elements of Tool,

115
00:07:44.150 --> 00:07:46.500
and this is what the asterisk means.

116
00:07:46.500 --> 00:07:53.940
It means all of the child elements and copy off will simply give you exactly what was in

117
00:07:53.940 --> 00:07:54.650
the input.

118
00:07:54.650 --> 00:07:57.170
So these two are being changed.

119
00:07:57.170 --> 00:07:59.030
Tours is becoming products.

120
00:07:59.030 --> 00:08:01.650
Tool is becoming product singular,

121
00:08:01.650 --> 00:08:04.450
but these elements remaining the same.

122
00:08:04.450 --> 00:08:08.780
They simply have a different parent element on a different grandparents element.

123
00:08:08.780 --> 00:08:15.630
So that's a quick overview of what's going on in the template as we go through this section

124
00:08:15.630 --> 00:08:15.630
.

125
00:08:15.630 --> 00:08:20.690
Obviously we'll get plenty of practice on all of these different techniques and components

126
00:08:20.690 --> 00:08:20.690
.

127
00:08:20.690 --> 00:08:23.050
But let's leave it there for the moment.

128
00:08:23.050 --> 00:08:28.250
And that's now going to Microsoft Excel to look at how the transformation takes place.

129
00:08:28.250 --> 00:08:30.550
So,

130
00:08:30.550 --> 00:08:31.080
as I said,

131
00:08:31.080 --> 00:08:32.520
if you look in developer,

132
00:08:32.520 --> 00:08:38.070
none of these commands will give you the opportunity to apply a style sheet to an XML

133
00:08:38.070 --> 00:08:39.770
document as you import it.

134
00:08:39.770 --> 00:08:46.100
What you have to do is to use file open and access the document that way.

135
00:08:46.100 --> 00:08:57.240
So that's going to number five on number one and open tools that XML So here we can see

136
00:08:57.240 --> 00:09:02.180
that Excel has recognized that this XML has a linked style feet.

137
00:09:02.180 --> 00:09:08.000
So just to reiterate in our XML document,

138
00:09:08.000 --> 00:09:10.250
if this line were present,

139
00:09:10.250 --> 00:09:13.640
this dialog box would never appear.

140
00:09:13.640 --> 00:09:19.290
It only appears when you've got a process in instruction linking the XML document to

141
00:09:19.290 --> 00:09:19.990
starchy.

142
00:09:19.990 --> 00:09:24.540
And if you have a workflow where there are several different options several different

143
00:09:24.540 --> 00:09:26.450
style streets that you might want to use,

144
00:09:26.450 --> 00:09:29.950
you simply put a process in instruction for each of them.

145
00:09:29.950 --> 00:09:34.010
And then you can choose which of them to use to do the transformation.

146
00:09:34.010 --> 00:09:36.070
So obviously we only have one,

147
00:09:36.070 --> 00:09:40.550
so we'll click OK on this warning message always appears,

148
00:09:40.550 --> 00:09:43.380
So we'll just click on yes and ignore it.

149
00:09:43.380 --> 00:09:45.640
And now we're in familiar territory.

150
00:09:45.640 --> 00:09:50.150
This is the standard dialog that appears when you import XML.

151
00:09:50.150 --> 00:09:54.050
So we'll importers accidental table click OK,

152
00:09:54.050 --> 00:10:00.050
and then we have two standard message relating to the creation off a schemer which will in

153
00:10:00.050 --> 00:10:02.350
turn generate an XML map,

154
00:10:02.350 --> 00:10:08.150
so we click OK and our data is imported.

155
00:10:08.150 --> 00:10:16.920
If we move across to develop out and bring up the XML source task pain here,

156
00:10:16.920 --> 00:10:21.850
we can see that the routine school products and the repeating element is called product.

157
00:10:21.850 --> 00:10:24.650
And if we were to export this document,

158
00:10:24.650 --> 00:10:27.050
this is the structure that we now have.

159
00:10:27.050 --> 00:10:33.620
So tours and tour on the input document have been completely overridden,

160
00:10:33.620 --> 00:10:35.350
and we now have products and products.

161
00:10:35.350 --> 00:10:44.360
But I go ahead and click on exports going to number 51 and let's just call these products

162
00:10:44.360 --> 00:10:51.200
and his products,

163
00:10:51.200 --> 00:10:57.650
and inside it we can see the transformed XML document,

164
00:10:57.650 --> 00:11:02.820
so that's a quick overview.

165
00:11:02.820 --> 00:11:04.050
Off the process,

166
00:11:04.050 --> 00:11:06.150
we have an XML document.

167
00:11:06.150 --> 00:11:08.250
It's linked to a style sheet.

168
00:11:08.250 --> 00:11:11.990
We use file open to bring it into excel.

169
00:11:11.990 --> 00:11:15.380
Excel recognizes that there's an attached style sheet,

170
00:11:15.380 --> 00:11:18.700
offers you the option off applying the style sheet.

171
00:11:18.700 --> 00:11:20.120
When you do,

172
00:11:20.120 --> 00:11:21.580
you have an XML map,

173
00:11:21.580 --> 00:11:27.550
which is based on the transformed XML document rather than the original input XML

