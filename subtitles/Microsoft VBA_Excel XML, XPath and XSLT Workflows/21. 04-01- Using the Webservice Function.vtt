WEBVTT
ï»¿1
00:00:00.000 --> 00:00:11.360
Microsoft excels.

2
00:00:11.360 --> 00:00:16.800
Web service function is used to get an XML response from a Web service,

3
00:00:16.800 --> 00:00:18.560
a Web service.

4
00:00:18.560 --> 00:00:24.950
It's an application designed to deliver a particular type of information to any client who

5
00:00:24.950 --> 00:00:28.190
requested when the request is made,

6
00:00:28.190 --> 00:00:30.620
parameter values and normally supply,

7
00:00:30.620 --> 00:00:33.150
which determine the result generated.

8
00:00:33.150 --> 00:00:40.120
It's very similar to simply visit in a Web U R L and having a Web application which

9
00:00:40.120 --> 00:00:42.050
supplies content to you.

10
00:00:42.050 --> 00:00:49.410
The big difference is that a Web service is designed to supply content not to humans,

11
00:00:49.410 --> 00:00:51.450
but to another application.

12
00:00:51.450 --> 00:00:52.800
So in this case,

13
00:00:52.800 --> 00:00:55.720
that other application is excel on.

14
00:00:55.720 --> 00:00:58.960
The mechanism that we're using is the Web service function.

15
00:00:58.960 --> 00:01:03.850
We specify the Earl of the Web service application,

16
00:01:03.850 --> 00:01:12.140
and normally that girl has embedded in it one or more parameters on the Web service as a

17
00:01:12.140 --> 00:01:13.460
result of that request,

18
00:01:13.460 --> 00:01:18.950
produces an XML response and then delivers that into the cell,

19
00:01:18.950 --> 00:01:21.350
which contains the Web service function.

20
00:01:21.350 --> 00:01:26.030
Web services can deliver other types of content apart from XML.

21
00:01:26.030 --> 00:01:28.440
But in the case of Microsoft Excel,

22
00:01:28.440 --> 00:01:31.860
XML is the only response which is understood.

23
00:01:31.860 --> 00:01:34.450
So in using excels Web service function,

24
00:01:34.450 --> 00:01:39.860
you can only work with Web services capable of producing an XML response.

25
00:01:39.860 --> 00:01:48.360
So let's take an example in the training folder will now working in zero for Web service

26
00:01:48.360 --> 00:01:50.000
filled exile exposed.

27
00:01:50.000 --> 00:01:53.960
And that's going to fold a one using the Web service function.

28
00:01:53.960 --> 00:02:02.430
Now let's examine our example international pricing that safe in that and in this example,

29
00:02:02.430 --> 00:02:07.880
we have a series of prices using G B P as the base currency.

30
00:02:07.880 --> 00:02:14.550
We want to be able to translate those prices into all of these different currencies,

31
00:02:14.550 --> 00:02:17.950
using up to date conversion rates.

32
00:02:17.950 --> 00:02:23.330
So what we want to do with the Web service function is to find a Web service which will

33
00:02:23.330 --> 00:02:25.460
give us the conversion rate from GBP.

34
00:02:25.460 --> 00:02:27.270
$2 euros,

35
00:02:27.270 --> 00:02:28.150
Canadian dollars,

36
00:02:28.150 --> 00:02:28.850
etcetera.

37
00:02:28.850 --> 00:02:33.350
So let's now return to the training folder.

38
00:02:33.350 --> 00:02:39.460
And if you open up the text vocal Morneau software for this demonstration,

39
00:02:39.460 --> 00:02:44.950
we're going to use Mondor Torborg as our Web service supplier.

40
00:02:44.950 --> 00:02:51.250
And the reason for doing this is that they have a 14 day triable service,

41
00:02:51.250 --> 00:02:56.950
which allows you to make a limited number of requests to their Web service.

42
00:02:56.950 --> 00:03:00.450
So the first thing more me to do is to sign up,

43
00:03:00.450 --> 00:03:04.700
so just copy this sign up,

44
00:03:04.700 --> 00:03:12.540
you are l and paste it into your browser using paste and go and then just fill out the

45
00:03:12.540 --> 00:03:16.550
information and click on request demo key now.

46
00:03:16.550 --> 00:03:20.260
And if all is well,

47
00:03:20.260 --> 00:03:23.580
within a few minutes you should receive an email like this one,

48
00:03:23.580 --> 00:03:25.870
which contains an A p I key.

49
00:03:25.870 --> 00:03:27.680
So I'm just gonna call me,

50
00:03:27.680 --> 00:03:31.250
They say p i and paste it into note pad.

51
00:03:31.250 --> 00:03:46.020
So now we just need to know the u r l that we need to access when we use in excels Web

52
00:03:46.020 --> 00:03:46.950
service function.

53
00:03:46.950 --> 00:03:50.990
So we go across to the website,

54
00:03:50.990 --> 00:03:53.110
click on the link on the left here,

55
00:03:53.110 --> 00:03:54.360
currency exchange rates,

56
00:03:54.360 --> 00:04:03.690
XML Web service and then just click on this web ap I access link on the first.

57
00:04:03.690 --> 00:04:04.160
You are well,

58
00:04:04.160 --> 00:04:07.450
that we see here gives us all the information that we need,

59
00:04:07.450 --> 00:04:17.960
and it gives us a breakdown of the six components to that You are l on.

60
00:04:17.960 --> 00:04:23.270
All we have to remember basically is that the base currency comes first.

61
00:04:23.270 --> 00:04:24.900
So in our example,

62
00:04:24.900 --> 00:04:27.800
obviously the base currency will be UK price.

63
00:04:27.800 --> 00:04:31.350
Then comes the target currency,

64
00:04:31.350 --> 00:04:34.030
and then components five and six.

65
00:04:34.030 --> 00:04:35.950
You'll notice a both optional.

66
00:04:35.950 --> 00:04:37.710
So in our case,

67
00:04:37.710 --> 00:04:39.350
it will simply omit them.

68
00:04:39.350 --> 00:04:45.480
The amount of convert devolves toe one and the date of conversion defaults to the current

69
00:04:45.480 --> 00:04:45.940
date.

70
00:04:45.940 --> 00:04:47.650
So that's exactly what we want.

71
00:04:47.650 --> 00:04:53.450
So we can just copy the first part of the URL admit in the last two sections.

72
00:04:53.450 --> 00:05:10.560
I'll just face that here as well and save my changes.

73
00:05:10.560 --> 00:05:16.230
So now we're ready to use the Web service function in Excel.

74
00:05:16.230 --> 00:05:18.760
Let's start with USD.

75
00:05:18.760 --> 00:05:22.890
I have you are else still on the clipboard,

76
00:05:22.890 --> 00:05:28.230
so I can just tie equals Web service and the girl is a string.

77
00:05:28.230 --> 00:05:29.890
So it has to go in double quotes,

78
00:05:29.890 --> 00:05:31.100
double quotes,

79
00:05:31.100 --> 00:05:37.850
and I can just paste it in close quotes,

80
00:05:37.850 --> 00:05:40.850
close brackets presente.

81
00:05:40.850 --> 00:05:43.150
And of course,

82
00:05:43.150 --> 00:05:46.840
the thing that I forgot to do was to put in my keys.

83
00:05:46.840 --> 00:05:49.050
I left this sort of default key in there.

84
00:05:49.050 --> 00:05:53.550
I obviously need to replace that with the A p I key that they supply to me.

85
00:05:53.550 --> 00:05:55.460
So let's just go back on,

86
00:05:55.460 --> 00:05:56.550
Grab that,

87
00:05:56.550 --> 00:06:08.750
just paste it in here now we should be good to go and we have a price.

88
00:06:08.750 --> 00:06:16.190
Let me just widen this cell so that we can see the result on then see what we need to do

89
00:06:16.190 --> 00:06:21.010
before we can actually use this value so we can see that in this case,

90
00:06:21.010 --> 00:06:24.350
the Web service actually returns the value that we want.

91
00:06:24.350 --> 00:06:27.350
The only problem is that the value is quoted,

92
00:06:27.350 --> 00:06:34.280
so all we need to do to get out calculations to work is to remove the quotation marks on.

93
00:06:34.280 --> 00:06:35.960
We can do that using excels,

94
00:06:35.960 --> 00:06:37.350
substitute function.

95
00:06:37.350 --> 00:06:42.270
So around our Web service,

96
00:06:42.270 --> 00:06:48.220
let's put the substitute function and use that to remove the double quotes so equal

97
00:06:48.220 --> 00:06:49.150
substitute.

98
00:06:49.150 --> 00:06:53.130
The Web service function is the first argument.

99
00:06:53.130 --> 00:06:53.720
In other words,

100
00:06:53.720 --> 00:06:54.550
the text.

101
00:06:54.550 --> 00:06:57.280
We put a comma at the end.

102
00:06:57.280 --> 00:06:59.070
Now we supply the old text.

103
00:06:59.070 --> 00:06:59.580
In other words,

104
00:06:59.580 --> 00:07:03.930
the text we want to remove on that text has to go in double quotes.

105
00:07:03.930 --> 00:07:05.300
Which raises the question.

106
00:07:05.300 --> 00:07:08.020
How do you put double quotes inside double quotes?

107
00:07:08.020 --> 00:07:09.950
I don't know if you've ever had to do this,

108
00:07:09.950 --> 00:07:11.590
but basically you double up.

109
00:07:11.590 --> 00:07:14.650
So you put two double quotes to represent double close.

110
00:07:14.650 --> 00:07:18.950
Hence we put open quotation marks to double quotes,

111
00:07:18.950 --> 00:07:20.810
close quotation marks.

112
00:07:20.810 --> 00:07:24.260
So four double quotes in total comma.

113
00:07:24.260 --> 00:07:26.680
What do we want to replace them with?

114
00:07:26.680 --> 00:07:27.620
Nothing.

115
00:07:27.620 --> 00:07:35.270
So we simply put open and close double quotes to indicate the mold stream close brackets.

116
00:07:35.270 --> 00:07:37.620
And,

117
00:07:37.620 --> 00:07:40.880
as you can see once the quotation marks have gone even though,

118
00:07:40.880 --> 00:07:41.920
strictly speaking,

119
00:07:41.920 --> 00:07:47.350
we still have a text value because the text value consists of numbers only Excel

120
00:07:47.350 --> 00:07:52.860
automatically converts it to a numeric value and uses it to perform the calculation.

121
00:07:52.860 --> 00:07:59.390
So I'm just going to reinstate the narrow column with so you can see all the different

122
00:07:59.390 --> 00:08:00.450
currency rates.

123
00:08:00.450 --> 00:08:07.250
And then the final thing we need to do is to modify the default formula.

124
00:08:07.250 --> 00:08:11.000
So it's not using neuro and us deep,

125
00:08:11.000 --> 00:08:19.260
but it's using G V P as the source and then picking up the conversion currency from the

126
00:08:19.260 --> 00:08:21.710
cell above the cell containing the formula.

127
00:08:21.710 --> 00:08:25.850
Simple way of doing that is to festival,

128
00:08:25.850 --> 00:08:30.810
delete euro and replace it with GBP.

129
00:08:30.810 --> 00:08:34.770
Then we delete USD.

130
00:08:34.770 --> 00:08:41.130
But this time we need to replace us D with the contents of this cell above the cell

131
00:08:41.130 --> 00:08:42.280
containing the formula.

132
00:08:42.280 --> 00:08:43.450
So to do that,

133
00:08:43.450 --> 00:08:45.150
we close quotation marks,

134
00:08:45.150 --> 00:08:51.060
then put an empress end but can capture nation and click on the cell above which in this

135
00:08:51.060 --> 00:08:52.360
case is J two,

136
00:08:52.360 --> 00:08:55.960
so that picks up the currency in that cell.

137
00:08:55.960 --> 00:09:01.450
Then we put another empress end and then opening quotation marks.

138
00:09:01.450 --> 00:09:06.450
So you just insert in that variable string into the URL.

139
00:09:06.450 --> 00:09:12.650
So when we presenter calculation should now actually be the correct one,

140
00:09:12.650 --> 00:09:21.560
what we now do is just to copy that formula to the rights and because there are no dollar

141
00:09:21.560 --> 00:09:28.000
signs were always picking up whatever currency is in the cell above the cell that contains

142
00:09:28.000 --> 00:09:28.750
out formula.

143
00:09:28.750 --> 00:09:33.560
So that's an example of using excels Web service function.

144
00:09:33.560 --> 00:09:35.090
And on this occasion,

145
00:09:35.090 --> 00:09:37.240
the result that was produced was,

146
00:09:37.240 --> 00:09:37.770
in fact,

147
00:09:37.770 --> 00:09:39.180
the result that we needed.

148
00:09:39.180 --> 00:09:40.800
In most cases,

149
00:09:40.800 --> 00:09:41.380
however,

150
00:09:41.380 --> 00:09:47.420
the Web service function returns an XML document containing a hierarchy of elements and

151
00:09:47.420 --> 00:09:48.250
attributes,

152
00:09:48.250 --> 00:09:51.250
and you then need to use the second function,

153
00:09:51.250 --> 00:09:58.290
filter XML to navigate within that structure and extract the data that you need.

154
00:09:58.290 --> 00:10:00.240
So in the next video,

155
00:10:00.240 --> 00:10:04.290
we'll move on to look at working with the Filter XML function

