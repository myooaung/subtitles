1
00:00:01,040 --> 00:00:01,430
[Autogenerated] Okay,

2
00:00:01,430 --> 00:00:07,590
let's dive into creating a cloudfront distribution within AWS.

3
00:00:07,590 --> 00:00:07,760
Now.

4
00:00:07,760 --> 00:00:12,160
We just had a brief overview and a review for what Cloudfront is.

5
00:00:12,160 --> 00:00:15,640
Let's just walk through creating a distribution,

6
00:00:15,640 --> 00:00:20,240
some at the distribution page, which is the default dashboard for cloudfront.

7
00:00:20,240 --> 00:00:23,540
And what I want to do is I'm gonna click on Create,

8
00:00:23,540 --> 00:00:26,740
and that gives us our two delivery methods.

9
00:00:26,740 --> 00:00:29,070
So if you recall back in the slides,

10
00:00:29,070 --> 00:00:34,290
we talked about the two different types being Web in our TMP.

11
00:00:34,290 --> 00:00:38,080
Now Webb is for any typical traffic, like a static site,

12
00:00:38,080 --> 00:00:42,440
or if you're redirecting files via https,

13
00:00:42,440 --> 00:00:44,880
then that's what you're gonna want to use.

14
00:00:44,880 --> 00:00:48,180
You can see that you have to store your files in an origin.

15
00:00:48,180 --> 00:00:50,340
What's well, look at here in a minute,

16
00:00:50,340 --> 00:00:52,780
and that could be a bucket or a Web server,

17
00:00:52,780 --> 00:00:54,840
depending on your application.

18
00:00:54,840 --> 00:00:59,510
And we'll actually look at both here in the upcoming clips.

19
00:00:59,510 --> 00:01:02,140
Now the other option is our TMP,

20
00:01:02,140 --> 00:01:07,240
and this is strictly for streaming media files via Adobe.

21
00:01:07,240 --> 00:01:10,140
So it's important to understand that this is a very

22
00:01:10,140 --> 00:01:12,940
specific type of delivery method,

23
00:01:12,940 --> 00:01:17,540
and a caveat for this is you have to store all of your

24
00:01:17,540 --> 00:01:20,560
files in an Amazon s three bucket.

25
00:01:20,560 --> 00:01:23,240
That's the Onley origin that you can have.

26
00:01:23,240 --> 00:01:27,050
Now, this is a very popular test question for A W s.

27
00:01:27,050 --> 00:01:30,940
So really get comfortable knowing the differences between

28
00:01:30,940 --> 00:01:33,470
the two cloudfront distribution types.

29
00:01:33,470 --> 00:01:38,350
So for this, I'll click on Web, and that brings us to our create screen.

30
00:01:38,350 --> 00:01:42,140
Now the first thing we have is our origin domain name.

31
00:01:42,140 --> 00:01:46,140
And this is essentially the origin of the data that we

32
00:01:46,140 --> 00:01:49,070
want to set up cloudfront in front of.

33
00:01:49,070 --> 00:01:53,560
So you can see here this is a list of all my s three buckets that I have

34
00:01:53,560 --> 00:01:57,250
in my account And what I'll do is I went ahead and stood up a simple

35
00:01:57,250 --> 00:02:01,040
static site in my Andrew es ist dot me bucket.

36
00:02:01,040 --> 00:02:02,230
And before we continue,

37
00:02:02,230 --> 00:02:08,540
let's just take a look at S three so I can show you what I've done here.

38
00:02:08,540 --> 00:02:12,460
So when I go to my s three buckets, we see I have my Andrew s.

39
00:02:12,460 --> 00:02:14,180
Is that me domain here?

40
00:02:14,180 --> 00:02:18,540
And this is my bucket name and you'll see that it's publicly accessible.

41
00:02:18,540 --> 00:02:18,780
Now,

42
00:02:18,780 --> 00:02:24,260
what I did here is I stood up a static site that lives within my

43
00:02:24,260 --> 00:02:27,740
s three bucket and under our bucket policy.

44
00:02:27,740 --> 00:02:32,640
You see, we're allowing anyone to get objects within this bucket.

45
00:02:32,640 --> 00:02:36,800
So if I go back here and they go to properties,

46
00:02:36,800 --> 00:02:40,000
I go to static Web site and I go to this in point,

47
00:02:40,000 --> 00:02:41,980
we'll get our static site.

48
00:02:41,980 --> 00:02:42,190
Now.

49
00:02:42,190 --> 00:02:48,140
I edited this simple site so we can show the origin that this is coming from.

50
00:02:48,140 --> 00:02:49,770
So in this case were saying, Hey,

51
00:02:49,770 --> 00:02:53,510
these files are from S3 and you'll see why I did

52
00:02:53,510 --> 00:02:56,440
this in some of the upcoming clips.

53
00:02:56,440 --> 00:02:59,000
It will become more relevant once we start dealing

54
00:02:59,000 --> 00:03:02,010
with fail overs and routing policies.

55
00:03:02,010 --> 00:03:02,900
So now that we see,

56
00:03:02,900 --> 00:03:07,960
we have our bucket sights set up and that's the basis of our origin.

57
00:03:07,960 --> 00:03:09,050
That's what I'm pointing it.

58
00:03:09,050 --> 00:03:10,640
That s three bucket.

59
00:03:10,640 --> 00:03:13,840
Now we can specify a path if we needed to.

60
00:03:13,840 --> 00:03:15,610
Now the next thing we have is our origin.

61
00:03:15,610 --> 00:03:16,410
I d.

62
00:03:16,410 --> 00:03:21,170
Now the origin I d is essentially just a description, as you can see here.

63
00:03:21,170 --> 00:03:25,240
So what I'll do is I'll say, Andrew ss dot me sight.

64
00:03:25,240 --> 00:03:28,640
And that brings us to restrict bucket access.

65
00:03:28,640 --> 00:03:32,790
So if you recall a second ago anyone from the public could

66
00:03:32,790 --> 00:03:35,840
hit Rs three bucket in our static site.

67
00:03:35,840 --> 00:03:40,540
But what we can do is we can restrict bucket access.

68
00:03:40,540 --> 00:03:45,640
So anyone trying to get content from our bucket has to go through cloudfront.

69
00:03:45,640 --> 00:03:48,500
Now, this is another important exam note.

70
00:03:48,500 --> 00:03:52,750
So be sure to understand how this works were essentially focusing

71
00:03:52,750 --> 00:03:56,840
people through cloudfront to retrieve our objects.

72
00:03:56,840 --> 00:04:00,100
There are many security benefits around this.

73
00:04:00,100 --> 00:04:00,820
So what's the like?

74
00:04:00,820 --> 00:04:02,140
Yes for this.

75
00:04:02,140 --> 00:04:05,660
And then, you see, we create an origin access identity,

76
00:04:05,660 --> 00:04:09,810
which is what we discussed in that diagram in our slides.

77
00:04:09,810 --> 00:04:12,680
So the origin, access identity?

78
00:04:12,680 --> 00:04:14,240
Oh, aye, aye.

79
00:04:14,240 --> 00:04:20,590
Is what allows us to access our content from our origin on the back in.

80
00:04:20,590 --> 00:04:24,480
So cloudfront essentially uses this identity to

81
00:04:24,480 --> 00:04:26,940
authenticate and get our content.

82
00:04:26,940 --> 00:04:31,440
So I'll create a new one here, and we'll just call it access identity,

83
00:04:31,440 --> 00:04:34,440
and then the name of the bucket will keep it the default.

84
00:04:34,440 --> 00:04:36,350
Now, the next thing is pretty handy.

85
00:04:36,350 --> 00:04:39,740
You can allow cloudfront to grant the reed permissions

86
00:04:39,740 --> 00:04:42,220
needed on the bucket so we'll select.

87
00:04:42,220 --> 00:04:44,540
Yes, and this is gonna go through an update.

88
00:04:44,540 --> 00:04:49,130
That bucket policy we looked at and that brings us to our origin headers.

89
00:04:49,130 --> 00:04:49,340
Now,

90
00:04:49,340 --> 00:04:54,680
these air custom headers that you can add depending on your application needs.

91
00:04:54,680 --> 00:04:58,870
So sometimes you might need a specific header that comes in on the

92
00:04:58,870 --> 00:05:02,640
request that you use for determining workloads.

93
00:05:02,640 --> 00:05:05,570
We'll leave this blank because we're just going to s three,

94
00:05:05,570 --> 00:05:08,310
so it's not necessarily needed.

95
00:05:08,310 --> 00:05:12,440
And then that brings us to our default cash behavior settings.

96
00:05:12,440 --> 00:05:16,340
So this is where we set our cash behavior.

97
00:05:16,340 --> 00:05:18,430
We can see we have our default path pattern.

98
00:05:18,430 --> 00:05:22,340
So it's a star, which is basically everything.

99
00:05:22,340 --> 00:05:25,970
And we can force a specific viewer protocol.

100
00:05:25,970 --> 00:05:28,670
We can have both unsecure and secured.

101
00:05:28,670 --> 00:05:38,330
Http, you can redirect http toe Http s or you can require secure http on Lee.

102
00:05:38,330 --> 00:05:39,270
So for this demo,

103
00:05:39,270 --> 00:05:44,640
I'll leave it the default and we get our allowed http methods below that.

104
00:05:44,640 --> 00:05:49,000
So this allows even more granular control on what kind of methods were

105
00:05:49,000 --> 00:05:53,890
allowing the public to make via our cloudfront distribution.

106
00:05:53,890 --> 00:05:55,510
So depending on your needs,

107
00:05:55,510 --> 00:05:59,860
a get in head might be more than enough just to get content.

108
00:05:59,860 --> 00:06:02,110
But if you need a update, some stuff,

109
00:06:02,110 --> 00:06:06,330
it might be good tohave get head options and then these put

110
00:06:06,330 --> 00:06:10,860
post patch and elite Now leave the default and we see we have

111
00:06:10,860 --> 00:06:13,420
field level encryption config.

112
00:06:13,420 --> 00:06:18,300
Now, what this does is it allows us to encrypt at the field level.

113
00:06:18,300 --> 00:06:21,770
On our private content, we see our cash methods.

114
00:06:21,770 --> 00:06:24,340
So get in head, which are by default,

115
00:06:24,340 --> 00:06:28,610
and we can actually set our cash based on selected headers

116
00:06:28,610 --> 00:06:31,440
selection so you can choose the nun option,

117
00:06:31,440 --> 00:06:33,740
which improves cashing.

118
00:06:33,740 --> 00:06:38,440
You can cash all or you can white list certain cashed headers

119
00:06:38,440 --> 00:06:42,310
and right below that we'd come on to object cashing so you

120
00:06:42,310 --> 00:06:44,910
can use the origin cash headers.

121
00:06:44,910 --> 00:06:48,380
Or you can customize them and not accept the defaults

122
00:06:48,380 --> 00:06:51,480
which are here right below that, So you can see we have a minimum,

123
00:06:51,480 --> 00:06:56,440
a maximum and a default timeto live, so use the defaults.

124
00:06:56,440 --> 00:07:02,030
Weaken forward cookies weaken Do query string forward in cashing and a

125
00:07:02,030 --> 00:07:06,970
n'importe note here is that query string for eating and cashing will slow down

126
00:07:06,970 --> 00:07:10,840
your cloudfront requests so we'll leave this at none.

127
00:07:10,840 --> 00:07:16,340
We can select smooth streaming if we're streaming live content, which we're not.

128
00:07:16,340 --> 00:07:20,000
We're just going to be displaying some simple static forms

129
00:07:20,000 --> 00:07:23,860
and then it brings us to restrict viewer access so we can use

130
00:07:23,860 --> 00:07:27,240
Sign your l's or signed cookies.

131
00:07:27,240 --> 00:07:31,530
Now we'll discuss this a little bit more in death in the upcoming clips,

132
00:07:31,530 --> 00:07:36,240
but we can essentially restrict our viewer access even

133
00:07:36,240 --> 00:07:39,810
further by requiring the viewers toe,

134
00:07:39,810 --> 00:07:44,420
have a signed your ____ or signed cookie given to them for access.

135
00:07:44,420 --> 00:07:48,670
They can't just use the default distribution.

136
00:07:48,670 --> 00:07:49,410
I'll select no.

137
00:07:49,410 --> 00:07:52,140
For now, we'll leave the compress automatically.

138
00:07:52,140 --> 00:07:53,240
Default.

139
00:07:53,240 --> 00:07:54,740
We'll leave the Lambda Functions,

140
00:07:54,740 --> 00:07:57,610
which are Lambda at EJ functions that we can deploy.

141
00:07:57,610 --> 00:07:59,040
I'll leave that blank,

142
00:07:59,040 --> 00:08:02,170
and that brings us to our distribution settings at the bottom.

143
00:08:02,170 --> 00:08:04,420
So the first thing we see is our price class,

144
00:08:04,420 --> 00:08:07,700
and this is where we can specify where we want our edge

145
00:08:07,700 --> 00:08:11,160
locations located so we can use on Lee U.

146
00:08:11,160 --> 00:08:11,410
S.

147
00:08:11,410 --> 00:08:11,990
Canada.

148
00:08:11,990 --> 00:08:15,620
In Europe, there is all of those plus Asia,

149
00:08:15,620 --> 00:08:18,660
Middle East and Africa, or we can use all.

150
00:08:18,660 --> 00:08:22,810
And this is the best performance because it cash is everything

151
00:08:22,810 --> 00:08:25,870
near pretty much everyone on the planet.

152
00:08:25,870 --> 00:08:31,410
So I'll choose that we won't use an AWS waft Web a C L.

153
00:08:31,410 --> 00:08:36,480
But you could attach one in front of our cloudfront distribution toe

154
00:08:36,480 --> 00:08:42,500
help with Web application firewall mitigation And that's another exam

155
00:08:42,500 --> 00:08:47,680
point that gets brought up a lot placing a waft rule on the account

156
00:08:47,680 --> 00:08:49,810
in front of the distribution.

157
00:08:49,810 --> 00:08:52,610
The next thing we have is our alternate domains.

158
00:08:52,610 --> 00:08:55,730
So what I'm gonna do here is give my alternate domain,

159
00:08:55,730 --> 00:08:58,760
which is going to be my Andrew estes dot me.

160
00:08:58,760 --> 00:09:02,530
And we specify this because otherwise were only going to be

161
00:09:02,530 --> 00:09:06,800
able to connect via the cloudfront domain name That's

162
00:09:06,800 --> 00:09:09,200
provided and it looks like this here.

163
00:09:09,200 --> 00:09:11,180
So I want to be reachable at Andrew s.

164
00:09:11,180 --> 00:09:13,940
Is that me for SSL?

165
00:09:13,940 --> 00:09:18,970
We can use the default cloudfront or we can specify a custom one.

166
00:09:18,970 --> 00:09:19,240
Now,

167
00:09:19,240 --> 00:09:23,300
An important thing to keep in mind here is that these

168
00:09:23,300 --> 00:09:28,400
certificates within a CM have to be in us East one.

169
00:09:28,400 --> 00:09:32,070
They cannot be in any other region for this configuration.

170
00:09:32,070 --> 00:09:37,710
And I can almost guarantee you a question like that will come up in your exam.

171
00:09:37,710 --> 00:09:43,230
So we select my ACM certain that I have from a W s in just a little background.

172
00:09:43,230 --> 00:09:48,650
This cert here actually covers both my w w w and my route domain name.

173
00:09:48,650 --> 00:09:50,540
So this one covers both.

174
00:09:50,540 --> 00:09:55,330
We can set our custom ssl client support so we can do support server,

175
00:09:55,330 --> 00:09:59,140
name, indication, which is the more modern technology.

176
00:09:59,140 --> 00:10:00,640
Or you could do legacy.

177
00:10:00,640 --> 00:10:04,140
And you can see that legacy is pretty expensive and

178
00:10:04,140 --> 00:10:06,120
they're really trying to phase this out.

179
00:10:06,120 --> 00:10:10,970
So we'll use the S and I We'll set our security policy as the default.

180
00:10:10,970 --> 00:10:13,610
But you can see we have several options here.

181
00:10:13,610 --> 00:10:20,270
And what's nice is a W s actually provides us a list of the ciphers and

182
00:10:20,270 --> 00:10:24,610
protocols that are used based on the policy that we select.

183
00:10:24,610 --> 00:10:27,740
So here at the top, we have our policy names.

184
00:10:27,740 --> 00:10:32,310
And then on the left, we have our actual protocols and ciphers.

185
00:10:32,310 --> 00:10:36,650
So this is a good matrix to see what is supported and what

186
00:10:36,650 --> 00:10:38,720
you should include based on your needs.

187
00:10:38,720 --> 00:10:42,540
So close out, we'll leave the default for now.

188
00:10:42,540 --> 00:10:45,400
Weaken, specify our http version.

189
00:10:45,400 --> 00:10:53,470
So I'll do the modern http to 1.1 and 1.0, we specify at a fault route object.

190
00:10:53,470 --> 00:10:54,230
So, for this,

191
00:10:54,230 --> 00:10:57,780
I'm gonna do index that html because that's the

192
00:10:57,780 --> 00:11:00,840
default html document for our site.

193
00:11:00,840 --> 00:11:03,540
Now we can turn on logging if we need Thio and we

194
00:11:03,540 --> 00:11:07,010
just specify a bucket and a prefix.

195
00:11:07,010 --> 00:11:11,710
So if we want a log requests through our distribution weaken,

196
00:11:11,710 --> 00:11:16,150
do that and save it in S three for further querying via

197
00:11:16,150 --> 00:11:18,530
some other technology or service.

198
00:11:18,530 --> 00:11:22,200
Maybe like a FINA, I'll turn this off.

199
00:11:22,200 --> 00:11:23,460
I'll leave enable i p.

200
00:11:23,460 --> 00:11:25,740
V six on because we'll allow it.

201
00:11:25,740 --> 00:11:29,580
I'll make sure it's enabled, and then I'll click on create and there we go.

202
00:11:29,580 --> 00:11:33,340
So we just started creating our first distribution.

203
00:11:33,340 --> 00:11:36,610
Now the current one is right here, the one that we're currently spinning up.

204
00:11:36,610 --> 00:11:39,090
You can see a state of enabled,

205
00:11:39,090 --> 00:11:43,640
and this will take several minutes for it to actually properly pra vision.

206
00:11:43,640 --> 00:11:46,290
This is a good point to go ahead and take a break.

207
00:11:46,290 --> 00:11:49,450
And then in the next clip once is this spun up will

208
00:11:49,450 --> 00:11:52,040
resume looking at the distribution,

209
00:11:52,040 --> 00:12:00,000
and then we'll also look at setting up a different origin from a load balancer as opposed to a bucket

