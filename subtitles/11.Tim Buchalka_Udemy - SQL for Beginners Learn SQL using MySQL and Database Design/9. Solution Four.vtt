WEBVTT

00:05.440 --> 00:10.940
So which five customers made the most bookings in October 2017.

00:10.980 --> 00:17.040
So from this challenge from the wording we know we should be joining between the Customers table and

00:17.040 --> 00:18.160
the bookings table.

00:18.510 --> 00:21.580
So let's do a join between these two tables.

00:21.780 --> 00:31.710
Select select and from the Customers table selects the customers first and last name so to see first

00:31.710 --> 00:32.330
name.

00:32.360 --> 00:35.260
Can I see your last name.

00:35.760 --> 00:40.370
And then from the bookings table for now I will select the ID.

00:40.650 --> 00:50.020
So the booking ID from the bookings table and then I want to join them so when I say from bookings be

00:51.430 --> 01:05.880
joining customers see on the two columns so we have the ID field in the Customers table I see the ID

01:06.690 --> 01:20.420
is equal to the customer ID in the booking stable so let's run that now just to see what we get.

01:20.590 --> 01:26.740
And you can see here we have the name the first and last name of each customer and their booking ID.

01:26.740 --> 01:29.950
So this is each booking that the customer is made.

01:30.100 --> 01:36.850
So you can see we have a long list of David may Teresa Davis and et cetera et cetera with all their

01:36.850 --> 01:38.450
booking IDs.

01:38.470 --> 01:42.780
So this doesn't really give us the number of bookings that each customer made.

01:42.790 --> 01:48.070
So to do this we're actually going to have to count on the booking ID.

01:49.030 --> 01:56.260
So this will count all the booking IDs and we're also going to have to group by

01:59.740 --> 02:06.470
the customer first name and also the customer last name.

02:07.240 --> 02:08.740
So if we run this now

02:12.500 --> 02:21.230
you can see we have each customer and they count on their booking ID so we can see of course in customers

02:21.240 --> 02:24.290
who don't have a first name entered into the database.

02:24.590 --> 02:29.930
So you can see here we have Elaine Bennett one Elaine Bennett three.

02:30.020 --> 02:30.450
Oh sorry.

02:30.470 --> 02:37.520
Elaine Bennett made one booking and Alan Bennett made free bookings and then Andrew learned Hearst made

02:37.520 --> 02:41.500
free bookings Annabel wings etc. etc..

02:41.540 --> 02:48.440
So each customer should only have one row in this resultset now with the number of bookings that they

02:48.440 --> 02:49.280
made.

02:49.670 --> 02:53.390
So now we need to find out the five customers who made the most bookings.

02:53.390 --> 02:57.580
So first of all I'm going to say the count booking ID as.

02:57.590 --> 03:01.270
So do I alias for the count booking ID.

03:01.700 --> 03:05.300
So I say as number of bookings

03:08.300 --> 03:15.590
and then I will order this data order by number of bookings

03:18.500 --> 03:19.580
in descending order.

03:19.580 --> 03:24.800
So this means it's going to go from the highest number of bookings to the lowest number of bookings.

03:25.100 --> 03:34.240
And then because we just won the top 5 customers I'm also going to limit this to five rows of data returned.

03:34.280 --> 03:41.390
So if we run this you can see has just returned five days of data in order of number of bookings.

03:41.390 --> 03:45.850
David may I was the customer who made the most bookings we have 16.

03:45.860 --> 03:47.220
John Smith with 13.

03:47.240 --> 03:54.710
And then Ray Steve and David all my 12 bookings so well don't know if you are able to get these five

03:54.710 --> 03:56.810
rows of data returned.

03:57.050 --> 04:01.780
If you go to a different solution then please post it in the Q&amp;A section and I'll take a look.

04:02.170 --> 04:04.370
But if you're able to get this then fantastic.

04:04.370 --> 04:06.470
Let's move on to the next challenge.
