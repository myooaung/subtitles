WEBVTT
1
00:00:00.420 --> 00:00:05.640
In this final bonus section we're going to be putting everything that we've learned together by building

2
00:00:05.670 --> 00:00:08.460
a clone of Twitter dot com.

3
00:00:08.460 --> 00:00:12.960
Now we're not going to recreate absolutely every feature of Twitter that will take a very long time

4
00:00:13.170 --> 00:00:16.560
but we're going to recreate the core experience.

5
00:00:16.560 --> 00:00:23.250
So we're going to allow people to of course log in and sign up and view public tweets and then search

6
00:00:23.250 --> 00:00:28.150
tweets and post their own tweets potentially more interestingly.

7
00:00:28.260 --> 00:00:33.780
We're going to be building this site in a slightly different way to how we've built sites before which

8
00:00:33.780 --> 00:00:40.860
is closer to what's known as the m the C framework or Model View Controller.

9
00:00:40.860 --> 00:00:44.270
You may have heard of this but if not it's actually pretty straightforward.

10
00:00:44.340 --> 00:00:52.740
The model is the data and data management aspect of the website which is essentially the database and

11
00:00:52.770 --> 00:00:54.750
the essential interactions with it.

12
00:00:54.780 --> 00:00:57.390
The view is the user interface.

13
00:00:57.450 --> 00:01:05.640
So that will be the HMO for the various files for each page of our site and the controller is the functionality

14
00:01:05.640 --> 00:01:08.790
of our site which we'll be writing in BHP.

15
00:01:08.880 --> 00:01:15.300
So the MVC framework essentially tries to keep each these separate for the usual reasons that it makes

16
00:01:15.300 --> 00:01:19.710
your code easier to maintain and more logical in its structure.

17
00:01:19.710 --> 00:01:24.660
So for once I'm not necessarily going to recommend that you have a go at creating Twitter dotcom yourself

18
00:01:24.690 --> 00:01:26.490
although of course you are very welcome to.

19
00:01:26.550 --> 00:01:32.430
And I'd love to see the results but this time I gently advise following along and just seeing this process

20
00:01:32.700 --> 00:01:36.340
of creating a reasonably complex Web site in this way.

21
00:01:36.800 --> 00:01:39.190
OK ready to go.

22
00:01:39.210 --> 00:01:39.720
Let's do it.

23
00:01:41.920 --> 00:01:51.700
So I'm going to start with creating the file space in fire FTB so I'll create a new directory I'm in

24
00:01:52.090 --> 00:01:56.950
complete web developer course dot com here and this is going to be twelve

25
00:02:02.200 --> 00:02:11.920
and then I'm going to create a main file called index dot BHP and this is going to be the central point

26
00:02:12.010 --> 00:02:13.870
of our complete Web site.

27
00:02:13.870 --> 00:02:18.550
So every page will be generated from index top BHP.

28
00:02:18.550 --> 00:02:26.710
Then I'm going to create a directory called views and inside the views directory where we're going to

29
00:02:26.710 --> 00:02:35.030
store the header and footer files for the site as well as the files for each individual page.

30
00:02:35.110 --> 00:02:44.890
And finally we're going to have a file called functions dot BHP where most of the code for our site

31
00:02:45.010 --> 00:02:49.360
i.e. the controller part of MVC is going to set.

32
00:02:50.570 --> 00:02:50.910
OK.

33
00:02:51.460 --> 00:02:53.670
So that's our MVC setup.

34
00:02:53.680 --> 00:02:56.320
We haven't really created the data structure yet.

35
00:02:56.560 --> 00:03:02.720
So let's just jump over to the control panel to create a database to do just that.

36
00:03:02.750 --> 00:03:04.780
So down in my askew l databases

37
00:03:08.090 --> 00:03:21.370
I'll just call it Twitter and generate a password and create all right we're going to leave that for

38
00:03:21.370 --> 00:03:27.770
the moment and I'm going to start by setting up my index stop BHP file.

39
00:03:28.030 --> 00:03:35.450
So command I to open that up and for once we're likely to be working with more than one file at once.

40
00:03:35.470 --> 00:03:41.740
So I'm actually going to bring in the menu here which will allow us to view several files at once and

41
00:03:41.800 --> 00:03:43.160
switch between them.

42
00:03:43.360 --> 00:03:46.240
There's likely a way that you can do that on your text editor as well.

43
00:03:46.240 --> 00:03:51.550
Just try opening more than one file at once and likely you'll get some kind of option either down the

44
00:03:51.550 --> 00:03:57.340
left or along the top which will allow you to switch between those files very easily.

45
00:03:57.370 --> 00:04:03.910
So remember our index top BHP file is going to be where all of our pages are generated and display to

46
00:04:03.910 --> 00:04:09.460
the user just before we do that though I'm going to do a quick hi there.

47
00:04:09.970 --> 00:04:14.100
Save that and just make sure that everything is connected up okay.

48
00:04:14.170 --> 00:04:21.580
So we should be able to access this via complete web developer course dot com slash content slash twelve

49
00:04:22.300 --> 00:04:34.160
Twitter and then claim that that would get wonderful let's jump back over to our text editor and think

50
00:04:34.160 --> 00:04:38.530
about how we're going to structure this index top BHP file.

51
00:04:39.320 --> 00:04:47.770
We're going to start by beginning our bit of BHP and then we'll likely be adding things as we go along.

52
00:04:47.900 --> 00:04:50.150
But the first thing I'm going to be is include

53
00:04:53.820 --> 00:04:57.010
functions top BHP.

54
00:04:57.330 --> 00:05:03.100
So this is currently empty but that's where we're going to include all the functions for our site.

55
00:05:03.480 --> 00:05:07.740
And then we're going to want to include three files which I haven't created yet.

56
00:05:08.430 --> 00:05:18.890
But essentially we're going to want to include from the views folder a header top BHP file.

57
00:05:19.350 --> 00:05:26.940
We're going to want to include a main content part of each page which for the moment I'm just going

58
00:05:26.940 --> 00:05:30.870
to include views slash home.

59
00:05:30.870 --> 00:05:44.150
BHP will create these in a moment and then will include views slash footer top BHP.

60
00:05:45.090 --> 00:05:47.840
And this is then how our site is going to be structured.

61
00:05:47.850 --> 00:05:53.460
So all the actual content is going to be and headed up BHP footed up HP and a number of other files

62
00:05:53.700 --> 00:05:56.760
one for each of the main pages of our web app.

63
00:05:58.650 --> 00:06:06.310
So let's say that and then go and create these three files to back in five FTE people go into views

64
00:06:07.480 --> 00:06:20.250
and then create headed up BHP will create fitted up BHP and we'll create hope.

65
00:06:20.570 --> 00:06:32.320
Top BHP and then I'm gonna open all three of those up using command o control low in windows and then

66
00:06:32.740 --> 00:06:37.600
let's get creating as we're creating a Twitter clone here.

67
00:06:37.600 --> 00:06:43.430
It seems only reasonable to use twitter bootstrap as we're very comfortable with anyway.

68
00:06:43.440 --> 00:06:48.400
So as before I'm gonna be using the version for Alpha.

69
00:06:48.400 --> 00:06:53.860
You can use the full version for it if it's available when you're watching this video and I'm gonna

70
00:06:53.860 --> 00:07:04.370
go over that see documentation again and introduction and scroll down to get the starter template.

71
00:07:04.720 --> 00:07:11.220
Now the header part of this is going to go down as far as body they're

72
00:07:14.390 --> 00:07:23.360
so I'm going to copy that into my header top BHP file so notice I've called this a dot BHP file because

73
00:07:23.360 --> 00:07:31.040
we may need to put some BHP in it but at the moment it's essentially just an HCM l document and then

74
00:07:31.160 --> 00:07:39.620
for now we'll just put hello world into home dot BHP and then

75
00:07:42.530 --> 00:07:48.340
we'll put the fitted up page page scripts just then

76
00:07:51.200 --> 00:07:52.530
okay let's have a look.

77
00:07:52.610 --> 00:07:53.690
Wonderful.

78
00:07:53.720 --> 00:07:59.660
So if we look at the source of that by controller right clicking and view page source you can see we've

79
00:07:59.660 --> 00:08:10.570
got the header H2 AML there then we've got the main content and then we've got outfitter wonderful.

80
00:08:11.240 --> 00:08:16.790
So that's essentially our MVC setup but of course in its current form it doesn't do very much.

81
00:08:16.790 --> 00:08:24.320
So in this video I'm going to take us as far as having the sign up and log in and log out sections working

82
00:08:24.490 --> 00:08:29.810
that will then give you a great framework to work with if you want to create a site like this in a similar

83
00:08:29.810 --> 00:08:32.480
way in the future.

84
00:08:32.480 --> 00:08:39.800
So let's get a nav bar up and running let's find the nav bar in components

85
00:08:43.310 --> 00:08:48.830
and there it is say in that bar we want something fairly simple here.

86
00:08:48.990 --> 00:08:54.930
That first option is pretty close to what we want so let's copy that code

87
00:08:57.860 --> 00:09:00.590
into our headed up BHP file

88
00:09:03.410 --> 00:09:07.900
and we'll put it after body there.

89
00:09:08.000 --> 00:09:11.300
So let's take a look and there it is.

90
00:09:11.300 --> 00:09:12.060
Okay.

91
00:09:12.110 --> 00:09:12.570
Wonderful.

92
00:09:13.970 --> 00:09:17.050
So I'm not particularly worried about styling.

93
00:09:17.570 --> 00:09:19.270
We're all about function in this example.

94
00:09:19.280 --> 00:09:22.070
But let's then

95
00:09:25.140 --> 00:09:35.700
just change the main name there to Twitter and we'll change the link to the home page which for us is

96
00:09:35.700 --> 00:09:40.770
that full thing there normally it would just be a slash or something to the route of the domain name

97
00:09:40.830 --> 00:09:48.390
by here because we're in a sub directory we'll use that and then we don't need a home link.

98
00:09:48.450 --> 00:09:52.410
So I'm going to get rid of that and then I'm gonna have

99
00:09:56.040 --> 00:10:02.670
your timeline as being one of the three so that's where the user can view all the tweets of the people

100
00:10:02.670 --> 00:10:03.570
that they are following

101
00:10:07.680 --> 00:10:10.920
we'll have your tweets and we'll have

102
00:10:13.620 --> 00:10:15.360
profiles.

103
00:10:15.360 --> 00:10:21.450
In fact I'll call that public profile so this will be whether they can view the list of users on the

104
00:10:21.450 --> 00:10:28.470
site and then choose to view their tweets if they want and the links here.

105
00:10:28.530 --> 00:10:32.100
I'm going to work with query strings.

106
00:10:32.100 --> 00:10:43.580
So here we're going to have page equals timeline here we'll have page equals your tweets

107
00:10:46.300 --> 00:10:56.780
and here we'll have page is equal to a public profiles and we can create those pages later on.

108
00:10:56.780 --> 00:11:01.290
And then here we want to allow the user to log in or sign up.

109
00:11:01.490 --> 00:11:04.490
So let's get rid of the search option here

110
00:11:07.660 --> 00:11:09.200
and we'll make this button.

111
00:11:09.220 --> 00:11:11.470
Log in slash.

112
00:11:11.470 --> 00:11:14.770
Sign up OK.

113
00:11:14.780 --> 00:11:16.980
Let's take a look.

114
00:11:17.040 --> 00:11:21.120
Column that looks great.

115
00:11:21.170 --> 00:11:32.680
I'm just going to add a very quick contain a div to our hello world and I'm also gonna change that to

116
00:11:32.710 --> 00:11:44.560
home page so we'll have a div with a class of container.

117
00:11:45.530 --> 00:11:50.490
And for now we'll just have home page in there.

118
00:11:51.580 --> 00:11:52.840
And then for the footer

119
00:11:55.780 --> 00:11:56.560
I'm going to have

120
00:12:01.130 --> 00:12:08.250
a footer there which is just going to have a simple paragraph with a copyright symbol which we get from

121
00:12:08.430 --> 00:12:09.980
and copy

122
00:12:14.190 --> 00:12:22.820
and I'll just call it my website 2016.

123
00:12:22.830 --> 00:12:23.270
There we go.

124
00:12:24.260 --> 00:12:33.550
Now that gives us the copyright symbol there which isn't great but in one of the examples here

125
00:12:36.560 --> 00:12:43.540
can have a look we've got a sticky footer which adds a footer to the bottom of the viewport

126
00:12:46.760 --> 00:12:57.700
which I'll just resize the browser window so you can see that there it is so let's view source and add

127
00:12:57.700 --> 00:12:59.110
that.

128
00:12:59.130 --> 00:13:03.910
So we've got a few custom styles to achieve that.

129
00:13:04.480 --> 00:13:08.320
Let's copy all of those into our own

130
00:13:11.430 --> 00:13:14.610
CSX file which I'll put here

131
00:13:18.720 --> 00:13:22.710
to create file and we'll just have styles dot CSX

132
00:13:25.250 --> 00:13:27.320
open that up as well.

133
00:13:27.320 --> 00:13:33.320
As always we want to keep everything as separate as possible so we'll keep all our styles in their own

134
00:13:34.130 --> 00:13:45.000
document and then if we just save that and then back in headed up the HP link to that style sheet so

135
00:13:45.420 --> 00:13:54.060
I'll do that here using link rail is equal to style sheet and then a tariff

136
00:13:57.510 --> 00:13:58.920
and we'll get this

137
00:14:01.480 --> 00:14:04.140
link has a full link.

138
00:14:04.150 --> 00:14:04.570
I think

139
00:14:07.360 --> 00:14:12.940
like that so the whole link and then styles don't see SS

140
00:14:16.340 --> 00:14:23.330
and then when we refresh that we can see we've got a change there but it hasn't applied to the footer

141
00:14:23.360 --> 00:14:36.000
yet because we haven't added the class of footer to Alpha to let's take a look.

142
00:14:36.100 --> 00:14:36.490
There we go.

143
00:14:37.240 --> 00:14:37.690
Wonderful.

144
00:14:38.770 --> 00:14:40.840
So I'll just add a quick container div

145
00:14:47.580 --> 00:14:49.200
to the footer content

146
00:14:57.250 --> 00:15:00.690
and we go want to get everything laid out nicely.

147
00:15:00.960 --> 00:15:01.890
There we go.

148
00:15:01.890 --> 00:15:07.820
That looks much better and we could include some links here if we wanted as well.

149
00:15:07.820 --> 00:15:10.790
Let's just have a quick look at the effect that it's had on the home page.

150
00:15:10.800 --> 00:15:15.850
Then we might want to get rid of some of these styles.

151
00:15:15.850 --> 00:15:16.240
Here we go.

152
00:15:16.240 --> 00:15:16.530
Yes.

153
00:15:16.540 --> 00:15:22.780
I'm gonna get rid of that custom CSX at the bottom that great.

154
00:15:23.620 --> 00:15:27.030
So now let's get our log in and sign up working.

155
00:15:27.310 --> 00:15:36.280
We're going to do that using a modal which we saw way back in the bootstrap section which is essentially

156
00:15:36.280 --> 00:15:37.930
a nice looking pop up

157
00:15:41.160 --> 00:15:42.860
we can see it in action here.

158
00:15:42.900 --> 00:15:45.000
So it looks like that.

159
00:15:45.110 --> 00:15:47.970
Let's see our live demo to remind us how it works.

160
00:15:47.970 --> 00:15:48.550
There we go.

161
00:15:49.260 --> 00:15:53.340
So we can have our sign up or log in form in the modal

162
00:15:56.590 --> 00:16:02.140
so let's put our mail down in the footer

163
00:16:04.730 --> 00:16:14.590
BHP file and we'll put it just before the end of the body here member That's gonna be hidden by default

164
00:16:15.910 --> 00:16:23.800
and only displayed when we need it and we can make that happen using data toggle and data target on

165
00:16:23.890 --> 00:16:35.230
our button so let's grab our headed up BHP to edit the button and here's our button.

166
00:16:35.360 --> 00:16:46.170
So let's add the data target is my model and data toggle is modal and that should now make that modal

167
00:16:46.230 --> 00:16:49.990
pop up when we click the log in sign up button.

168
00:16:50.460 --> 00:16:51.570
But it doesn't.

169
00:16:51.660 --> 00:16:56.810
I suspect that's because put it up BHP hasn't saved.

170
00:16:56.850 --> 00:17:01.220
So let's try that again refresh log in and sign up.

171
00:17:01.260 --> 00:17:01.890
There we go.

172
00:17:02.690 --> 00:17:08.160
And what's actually going on there is that when we click that it's opening up the model but then refreshing

173
00:17:08.160 --> 00:17:12.870
the page because it's submitting the form which we no longer need.

174
00:17:13.770 --> 00:17:15.350
So let's fix that in a couple of ways.

175
00:17:15.390 --> 00:17:19.650
In headed up BHP will change form to div.

176
00:17:19.800 --> 00:17:25.380
Given that this is actually a form anymore it's just a button and we'll get rid of the tape is equal

177
00:17:25.380 --> 00:17:32.640
to submit from the button as well that shit get disappearing nicely for us.

178
00:17:32.650 --> 00:17:33.130
There we go.

179
00:17:36.270 --> 00:17:48.510
Now let's add a log in form to our model so we'll change the title here in the modal from modal title

180
00:17:49.920 --> 00:17:57.610
to log in and we'll add our form to log in here.

181
00:17:57.920 --> 00:18:03.020
Let's get that from Twitter components forms

182
00:18:05.570 --> 00:18:10.730
and let's see if we can find a super simple log in form.

183
00:18:10.730 --> 00:18:11.510
They should do the job

184
00:18:19.480 --> 00:18:22.270
so our first label is gonna be email

185
00:18:24.960 --> 00:18:27.870
place holder will be email address

186
00:18:31.930 --> 00:18:37.660
and we'll call that email type is text effect or change the type to email

187
00:18:41.170 --> 00:18:48.350
I can be email and then we'll have label for password

188
00:18:53.170 --> 00:18:59.850
spell password correctly type is equal to password I.D.

189
00:19:02.830 --> 00:19:15.980
password and then place holder can just be password and then the button here becomes a log in button

190
00:19:16.910 --> 00:19:21.880
and I'll leave the count the closed button there in case they change their minds.

191
00:19:24.110 --> 00:19:26.960
Okay let's have a look now okay.

192
00:19:27.140 --> 00:19:28.400
Looks great.

193
00:19:28.400 --> 00:19:30.250
Of course the user might not want to log in.

194
00:19:30.620 --> 00:19:36.530
So let's give them an option to switch to sign up instead.

195
00:19:36.530 --> 00:19:42.910
I'll do that here and I'll see how it looks with just a simple link.

196
00:19:45.800 --> 00:19:50.120
Which will give an idea of I'll call it toggle log in

197
00:19:55.620 --> 00:20:00.140
and we'll have a text as sign up then.

198
00:20:02.490 --> 00:20:03.220
Let's have a look.

199
00:20:03.540 --> 00:20:04.020
There we go.

200
00:20:05.610 --> 00:20:12.630
So all I'm gonna change here when they click the sign up link I'm gonna change log in to sign up up

201
00:20:12.630 --> 00:20:20.490
here and I'm gonna change log in to sign up down there and I'll change sign up back to log in as well.

202
00:20:21.660 --> 00:20:32.940
And the final thing that we'll have in our form here is a small hidden input which will keep track of

203
00:20:32.940 --> 00:20:37.380
whether we're on log in mode or sign up mode.

204
00:20:37.830 --> 00:20:43.380
So I'll call this name is equal to log in active

205
00:20:46.300 --> 00:20:50.990
and the value by default will be 1 because log in will be active by default.

206
00:20:51.710 --> 00:20:52.240
Okay.

207
00:20:52.730 --> 00:20:58.230
So let's get our log in toggling sorted for the moment.

208
00:20:58.250 --> 00:21:05.630
I'm just gonna write the javascript directly into footer that BHP but we will switch this to a separate

209
00:21:06.020 --> 00:21:09.520
dot J.S. file before we finish.

210
00:21:09.590 --> 00:21:16.310
So we want some code to run when the toggle log in button is clicked

211
00:21:19.560 --> 00:21:21.690
and we want that to be a function

212
00:21:26.020 --> 00:21:34.060
and for now I'm just going to alert high to make sure that everything's connected up bright that we

213
00:21:34.100 --> 00:21:37.100
get while we're here actually.

214
00:21:37.100 --> 00:21:42.950
I'm going to add a little bit of a margin to the right of sign up just so it's a little bit removed

215
00:21:42.950 --> 00:21:49.430
from the close button let's do that over in styles dot CSX.

216
00:21:49.790 --> 00:21:59.220
I'll put these at the top so toggle log in so we'll have a padding right.

217
00:22:00.220 --> 00:22:06.540
Oh let's say 15 pixels and let's refresh that.

218
00:22:06.540 --> 00:22:07.230
Have a look.

219
00:22:07.230 --> 00:22:07.530
Yeah.

220
00:22:07.590 --> 00:22:08.130
That's better.

221
00:22:13.830 --> 00:22:25.410
OK so we want to find out whether we're in logging mode or not so let's give our logging active an I.D.

222
00:22:25.440 --> 00:22:29.390
as well be the same idea.

223
00:22:29.390 --> 00:22:37.830
Just log in active and then we can look to see if the log in active

224
00:22:41.480 --> 00:22:43.260
input has a value.

225
00:22:45.870 --> 00:22:48.040
Of 1

226
00:22:52.800 --> 00:22:56.310
then that means we're in logging mode.

227
00:22:56.310 --> 00:22:58.620
So as usual I'm just going to do a check

228
00:23:03.870 --> 00:23:07.880
to see if that is correct.

229
00:23:07.890 --> 00:23:08.310
Okay.

230
00:23:08.340 --> 00:23:10.330
It does appear to be.

231
00:23:10.500 --> 00:23:17.400
So if that's the case we now want to switch to sign up mode.

232
00:23:17.820 --> 00:23:31.460
So first off let's change log in active dot vow to zero so that we're not in log in active mode anymore.

233
00:23:34.110 --> 00:23:40.980
And then I'm going to change the idea here to log in modal title

234
00:23:45.700 --> 00:23:47.080
and then we'll change

235
00:23:50.870 --> 00:23:57.670
log in modal title HMO to sign up

236
00:24:01.290 --> 00:24:06.270
then we'll take out a button down here give that an idea

237
00:24:09.180 --> 00:24:10.760
I'll call it log in sign up button

238
00:24:16.500 --> 00:24:19.120
and then we want to take that

239
00:24:22.000 --> 00:24:24.550
and change the HDMI all to

240
00:24:27.200 --> 00:24:37.750
sign up and I think finally we want to change the toggle log in HDMI l I can select that from their

241
00:24:41.930 --> 00:24:43.010
to log in

242
00:24:45.980 --> 00:24:55.710
so that should change everything from a log in mode to a sign up mode let's have a look.

243
00:24:55.710 --> 00:24:56.250
There we go.

244
00:24:56.880 --> 00:25:02.720
So now I've changed sign up that sign up there and that's changed to log in.

245
00:25:02.790 --> 00:25:11.890
So the only thing that remains is to allow us to switch back to logging mode if necessary.

246
00:25:11.890 --> 00:25:19.950
So if logging mode is not active then we'll make it active by setting the value of log in active to

247
00:25:19.970 --> 00:25:30.800
1 or set the modal title back to log in the log in sign up button to log in and then toggle logging

248
00:25:31.190 --> 00:25:33.230
back to sign up.

249
00:25:36.290 --> 00:25:38.800
All right let's take a look.

250
00:25:38.950 --> 00:25:42.710
So sign up becomes log in log in.

251
00:25:43.040 --> 00:25:46.700
Wonderful OK.

252
00:25:46.840 --> 00:25:50.850
Now we just need to action the log in or sign up process.

253
00:25:51.190 --> 00:25:55.390
Now because we've got this nice setup here we're going to do this using Ajax.

254
00:25:55.630 --> 00:25:56.970
So let's do it.

255
00:25:58.080 --> 00:26:07.920
So back over in fitted up HP we want this to happen when they log in or sign up.

256
00:26:07.920 --> 00:26:08.820
Button is clicked

257
00:26:12.100 --> 00:26:13.940
say let's get that all setup

258
00:26:24.240 --> 00:26:25.910
here we go.

259
00:26:27.600 --> 00:26:40.830
Because I like to be sure before I write complicated J query we get wonderful SO IN ORDER TO POST SUBMIT

260
00:26:40.860 --> 00:26:44.610
our form we're going to need a script to submit to.

261
00:26:46.320 --> 00:26:51.540
So I'm going to create a new file called actions dot P BHP

262
00:26:54.800 --> 00:27:02.650
which is going to be where we do things like post a tweet or submit a logging form to actions is gonna

263
00:27:02.690 --> 00:27:06.740
be pretty simple.

264
00:27:07.910 --> 00:27:17.810
It's going to include functions that BHP and then it will route the action to the necessary function

265
00:27:18.110 --> 00:27:22.010
depending on what is being requested at the time.

266
00:27:22.010 --> 00:27:31.400
So if we go back to our Ajax then we just need to do our ajax POST

267
00:27:36.250 --> 00:27:40.810
AND THIS IS GONNA BE get done with a type of post

268
00:27:44.100 --> 00:27:52.880
the U.R.L. is going to be action dot BHP and then question mark.

269
00:27:52.880 --> 00:28:05.580
Action equals I'll call it log in sign up because we don't know which one that is at this point then

270
00:28:06.120 --> 00:28:20.740
that should be a comma and then the data that we're going to send is email and that's gonna be equal

271
00:28:20.740 --> 00:28:21.100
say

272
00:28:23.890 --> 00:28:25.210
the value of

273
00:28:30.110 --> 00:28:31.190
the email field

274
00:28:36.070 --> 00:28:38.200
plus the password

275
00:28:40.850 --> 00:28:42.320
which is going to be equal to say

276
00:28:46.860 --> 00:28:48.930
the value of the password field

277
00:28:55.300 --> 00:28:58.720
and that call should have an end symbol the

278
00:29:03.960 --> 00:29:08.760
and we also want to know if the log in active is true because we want to know whether we're attempting

279
00:29:08.760 --> 00:29:15.480
to log in or sign up this user is equal to and then

280
00:29:21.320 --> 00:29:28.580
log in active Val.

281
00:29:29.000 --> 00:29:40.320
So that's our data then we want to have a success function so this is gonna be a function with a result

282
00:29:47.230 --> 00:29:54.010
and for now we'll just alert the result.

283
00:29:54.250 --> 00:29:54.710
All right.

284
00:29:55.490 --> 00:29:58.270
So fingers crossed that's all gonna work.

285
00:29:58.280 --> 00:30:05.430
Okay now notice I chose action is equal to log in sign up in the UI well.

286
00:30:05.440 --> 00:30:10.010
So if we go over to actions that BHP and then we'll check to see if

287
00:30:13.810 --> 00:30:20.590
they get variable action is equal to a log in sign up.

288
00:30:20.770 --> 00:30:25.190
That means we want a log in or sign up then.

289
00:30:25.270 --> 00:30:26.740
For now all I'm going to do

290
00:30:31.210 --> 00:30:40.780
is display all the post variables which should then be fed back to fitted up BHP and alerted here and

291
00:30:40.780 --> 00:30:41.710
just before we run that.

292
00:30:41.710 --> 00:30:45.590
It would help if I get the U.R.L. right should be actions.

293
00:30:45.750 --> 00:30:49.410
Top BHP okay.

294
00:30:49.420 --> 00:30:50.740
So let's refresh.

295
00:30:50.920 --> 00:30:52.790
Log in and sign up and then click.

296
00:30:52.810 --> 00:30:55.280
Log in and there we go.

297
00:30:55.360 --> 00:31:00.420
We're getting the output from the action dot page P script.

298
00:31:00.880 --> 00:31:07.720
Let's just put in an email address and a password and they are getting fed through as well.

299
00:31:08.560 --> 00:31:08.980
Wonderful.

300
00:31:10.180 --> 00:31:14.670
So now we're going to be concentrating on actions not BHP.

301
00:31:14.770 --> 00:31:19.780
And this is where it will first attempt to sign the user up and then we'll write the code for logging

302
00:31:19.780 --> 00:31:25.480
the user in generally makes sense to do it that way round because we need to sign users up before we

303
00:31:25.480 --> 00:31:27.370
log them in.

304
00:31:27.460 --> 00:31:28.540
So let's have a look.

305
00:31:28.540 --> 00:31:30.460
So log in active is zero there.

306
00:31:34.140 --> 00:31:41.030
So let's do a check to see if post log in active

307
00:31:44.820 --> 00:31:46.120
is 0

308
00:31:48.830 --> 00:31:54.670
then let's echo sign user up and the nice thing about testing this.

309
00:31:54.680 --> 00:31:56.530
We don't need to refresh anything.

310
00:31:56.900 --> 00:32:01.850
We can just click that and it will buy Ajax get the result for us.

311
00:32:03.190 --> 00:32:03.460
Great.

312
00:32:04.240 --> 00:32:08.830
Now before we actually do the log in though we're going to need to validate the email address and the

313
00:32:08.830 --> 00:32:14.780
password and we'll need to do that regardless of whether they're logging in or signing up.

314
00:32:14.860 --> 00:32:17.950
So let's do this at the beginning here.

315
00:32:17.980 --> 00:32:21.280
So first off we'll check to see if there's no

316
00:32:25.230 --> 00:32:34.140
email and in fact what we'll do is we'll set up I won't call it message or call it error so I'll have

317
00:32:34.140 --> 00:32:35.250
an empty error

318
00:32:38.000 --> 00:32:38.540
variable.

319
00:32:40.550 --> 00:32:48.920
So if there's no email address we'll echo an email address is required

320
00:32:54.210 --> 00:32:57.600
else we'll then check to see if there's a password

321
00:33:02.700 --> 00:33:07.060
in fact we went echo that will set error equal to it.

322
00:33:12.960 --> 00:33:21.650
A password is required and we'll do a quick bit of validation on the email as well.

323
00:33:21.950 --> 00:33:30.080
We've done this before but we'll do a quick search for P Pate validate email address and there's a built

324
00:33:30.080 --> 00:33:31.550
in HP function to do that

325
00:33:36.850 --> 00:33:39.710
so let's grab that code

326
00:33:42.900 --> 00:33:49.400
and we actually want to check if it is not a valid email address so I'm gonna get rid of the exclamation

327
00:33:49.400 --> 00:34:00.120
mark then and what we want to check is not the password but the email

328
00:34:05.740 --> 00:34:15.610
so if that turns out to be false then we'll set error see Please enter a valid email address

329
00:34:22.020 --> 00:34:30.830
and then here we'll check to see if there is not an empty string.

330
00:34:31.040 --> 00:34:34.040
Then for now we'll just echo it.

331
00:34:39.250 --> 00:34:40.730
So let's have a look.

332
00:34:40.840 --> 00:34:45.980
If we get rid of the email and click sign up and email addresses required.

333
00:34:46.000 --> 00:34:46.570
Great.

334
00:34:46.630 --> 00:34:48.220
We put that in.

335
00:34:48.590 --> 00:34:50.630
But get rid of the password.

336
00:34:50.770 --> 00:34:52.030
We get a password is required.

337
00:34:52.060 --> 00:34:52.950
Great.

338
00:34:53.230 --> 00:34:55.970
If we put that in.

339
00:34:56.280 --> 00:34:59.880
Yep it's needing a valid email address.

340
00:35:00.090 --> 00:35:03.510
And if we validate that then we just get signed user up.

341
00:35:03.510 --> 00:35:04.030
Perfect.

342
00:35:04.410 --> 00:35:10.650
We'll get our form to display that more nicely in a minute but let's just complete the sign up process

343
00:35:10.650 --> 00:35:11.000
for now

344
00:35:15.170 --> 00:35:15.610
okay.

345
00:35:15.770 --> 00:35:19.220
So now we're going to need our database at long last.

346
00:35:19.220 --> 00:35:27.460
Or our model so let's scroll down here and we can see our Twitter database that we've connected.

347
00:35:27.590 --> 00:35:38.130
Let's click manage then that will take us over to PSP HP my admin and we can create our users table

348
00:35:39.390 --> 00:35:41.460
which is going to be pretty simple.

349
00:35:41.790 --> 00:35:48.680
We're gonna need a user name or the email address the password and an I.D. field.

350
00:35:48.720 --> 00:35:50.780
And for now that's it.

351
00:35:50.790 --> 00:35:59.920
So three columns will have the I.D. column first which we want to auto increment and we want that to

352
00:35:59.920 --> 00:36:14.500
be the primary key and then we'll have email and password both of which I'll set to text all right.

353
00:36:17.250 --> 00:36:22.960
Now before we can do anything with that we're going to need a connection string so I'm going to put

354
00:36:22.960 --> 00:36:29.880
that into functions dot BHP because that appears in all of our scripts

355
00:36:33.300 --> 00:36:40.830
and we'll do that using code that we saw in the My School section.

356
00:36:40.830 --> 00:36:51.030
So we'll create a link which is gonna be my askew ally underscore connect and the database is on the

357
00:36:51.030 --> 00:36:54.420
same server as the scripts that we're writing here.

358
00:36:54.420 --> 00:37:04.940
So I'm going to use local host to connect and then we want the database username which is the same as

359
00:37:04.940 --> 00:37:06.980
the database name itself.

360
00:37:07.010 --> 00:37:10.420
So S.L. 29 hyphen Twitter.

361
00:37:10.460 --> 00:37:13.220
Try not to select any of the whitespace

362
00:37:18.020 --> 00:37:23.990
and then we want the password which I'll copy in a minute and then we want the database name which is

363
00:37:24.350 --> 00:37:28.190
again S.L. twenty nine hyphen Twitter

364
00:37:31.430 --> 00:37:36.930
and the password is that and a et cetera et cetera

365
00:37:43.390 --> 00:37:53.400
and then we'll do a check to see if my askew out high connect error number.

366
00:37:53.890 --> 00:37:56.010
So if there's a connection error

367
00:37:59.770 --> 00:38:03.590
for now just to make sure everything is connected up I'm just going to

368
00:38:06.460 --> 00:38:09.480
print the my askew ally.

369
00:38:09.880 --> 00:38:10.420
Connect

370
00:38:13.050 --> 00:38:13.410
era

371
00:38:16.660 --> 00:38:17.840
and exit.

372
00:38:17.950 --> 00:38:27.810
So stop the script and in fact I'm going to enforce an error by getting the database name wrong.

373
00:38:28.900 --> 00:38:32.600
And if we then refresh that you can see we've got access denied.

374
00:38:32.860 --> 00:38:33.770
Great.

375
00:38:34.030 --> 00:38:39.020
If we get rid of that it should light our page without any problems.

376
00:38:39.040 --> 00:38:41.850
Wonderful okay.

377
00:38:41.850 --> 00:38:43.710
So back to action stop BHP

378
00:38:46.820 --> 00:38:51.270
I'm actually going to make it so that if there is an error there.

379
00:38:51.980 --> 00:38:59.780
Not only do we echo the error but we exit because we shouldn't try to assign the user up if we've got

380
00:38:59.780 --> 00:39:00.260
a problem.

381
00:39:02.130 --> 00:39:03.320
Okay.

382
00:39:03.500 --> 00:39:08.680
And we need to check for here is when we're trying to sign the user up is to make sure that there's

383
00:39:08.690 --> 00:39:13.130
no one with their email address already registered.

384
00:39:13.130 --> 00:39:21.820
So let's write our query or create a query and I'll just give us a bit more room to work with.

385
00:39:21.830 --> 00:39:29.940
So we want to select start everything from users.

386
00:39:30.110 --> 00:39:32.180
Remember we're selecting from the

387
00:39:35.300 --> 00:39:37.460
users table that we just created

388
00:39:42.130 --> 00:39:48.440
where email equals and then we want

389
00:39:53.240 --> 00:39:59.590
my askew ally real escape string.

390
00:39:59.640 --> 00:40:06.330
Remember we need to protect ourselves from potential askew l injection attacks here and we'll do that

391
00:40:06.330 --> 00:40:14.450
with our link and the variable that we actually want to put in his the post email variable

392
00:40:19.380 --> 00:40:23.870
and I'll pop a limit one on the end.

393
00:40:24.390 --> 00:40:25.230
Just forget habit.

394
00:40:25.230 --> 00:40:28.350
Not that we should expect to see more than one.

395
00:40:28.610 --> 00:40:31.630
Then we'll get our results.

396
00:40:33.960 --> 00:40:36.110
Just gonna be my askew ally.

397
00:40:36.180 --> 00:40:36.720
Query

398
00:40:40.070 --> 00:40:42.410
link and query

399
00:40:45.450 --> 00:40:51.600
and then all we want to do is to see if there are any results for this particular query and we can do

400
00:40:51.600 --> 00:40:52.470
that by checking

401
00:40:56.040 --> 00:40:56.760
my rescue out.

402
00:40:56.770 --> 00:41:01.710
I num rows for that result.

403
00:41:04.000 --> 00:41:08.940
And if it's greater than 0 then we'll set.

404
00:41:08.990 --> 00:41:18.540
Error equals that email address is already taken.

405
00:41:19.610 --> 00:41:22.760
And then right at the end here

406
00:41:25.600 --> 00:41:31.150
we'll have a check to see if the error is non empty and if it is then display it.

407
00:41:32.710 --> 00:41:34.260
I think I'd like to check that.

408
00:41:35.380 --> 00:41:35.800
So

409
00:41:38.510 --> 00:41:44.390
that's first off just pop back into sign up mode click sign up and excellent.

410
00:41:44.390 --> 00:41:52.100
That is working as required and then I'm just going to put in a random email address select it and then

411
00:41:53.600 --> 00:41:56.750
enter it manually into our users table

412
00:42:02.730 --> 00:42:03.460
every game.

413
00:42:04.740 --> 00:42:08.130
So now if we browse we've got our email there.

414
00:42:08.130 --> 00:42:14.020
So if I try and add that email address should give me an error.

415
00:42:14.030 --> 00:42:17.320
It's giving me a blank result.

416
00:42:17.990 --> 00:42:21.000
And that's because of course this should be equal zero.

417
00:42:23.010 --> 00:42:27.460
So if we get no results that's when we want that error to appear.

418
00:42:30.570 --> 00:42:34.050
And I think that's because I've got a slight issue with my brackets here.

419
00:42:35.710 --> 00:42:42.080
So I should close brackets there rather than at the end of the string.

420
00:42:42.100 --> 00:42:42.770
Try that again.

421
00:42:43.510 --> 00:42:48.820
So jump back over to Chrome click sign up and that e-mail address is already taken.

422
00:42:48.820 --> 00:42:50.140
Wonderful.

423
00:42:50.140 --> 00:42:53.590
And if I just change the email address I don't get that error.

424
00:42:53.740 --> 00:42:54.580
So that's looking good get

425
00:42:57.610 --> 00:42:58.390
so if

426
00:43:03.430 --> 00:43:16.180
that's not the case let's create the user so we'll create a new query which will be inset into users

427
00:43:17.500 --> 00:43:22.030
and we want to create just the email and password

428
00:43:25.470 --> 00:43:32.430
actually we'll use that symbol for these email and password

429
00:43:36.730 --> 00:43:40.570
and this is going to have values

430
00:43:46.540 --> 00:43:48.160
and I'm gonna copy over

431
00:43:51.290 --> 00:44:00.310
that string that which escapes the email and then we also want to escape

432
00:44:04.750 --> 00:44:05.950
the password.

433
00:44:09.920 --> 00:44:10.650
There we go.

434
00:44:12.110 --> 00:44:18.140
And then we'll just check to make sure that we've run that correctly.

435
00:44:18.280 --> 00:44:30.600
So my ask you Ally query with a link and the query string so if that worked

436
00:44:33.570 --> 00:44:37.220
we want to return something to say that it worked.

437
00:44:37.230 --> 00:44:43.500
So what I'm going to do is just echo one and then we'll consider one to be that kind of correct code

438
00:44:43.530 --> 00:44:44.330
that everything's worked.

439
00:44:44.340 --> 00:44:46.320
Okay.

440
00:44:46.320 --> 00:44:50.790
Else we've got an error of

441
00:44:55.540 --> 00:44:56.570
couldn't create use.

442
00:44:56.800 --> 00:45:00.280
And I'll just have something generic like Please try again later

443
00:45:03.320 --> 00:45:09.910
and there's just a couple of issues that I've missed out the single quotes around the password.

444
00:45:09.910 --> 00:45:18.030
And I've also managed to miss that out of my askew I like query that okay.

445
00:45:18.760 --> 00:45:19.590
So let's take a look.

446
00:45:19.600 --> 00:45:23.250
If we now try and sign up this user we get a one.

447
00:45:23.260 --> 00:45:24.310
Fantastic.

448
00:45:24.310 --> 00:45:29.310
And if we try and do it again we should get that e-mail address is already taken.

449
00:45:31.010 --> 00:45:31.420
Brilliant.

450
00:45:31.780 --> 00:45:38.910
Let's just check and make sure that the user is indeed in our database.

451
00:45:38.910 --> 00:45:46.080
So that's very good but we definitely don't want to be storing the passwords in plain text like that.

452
00:45:46.080 --> 00:45:49.360
So let's update our code here.

453
00:45:49.560 --> 00:45:57.230
Before we echo the one to hash the password as we saw in the My School section.

454
00:45:57.380 --> 00:46:06.320
So first off so we can use the My askew ally insert I.D. to generate our hash and I'll do that all in

455
00:46:06.320 --> 00:46:08.750
one query.

456
00:46:08.840 --> 00:46:19.170
So what we're gonna do is update the user's table and we're going to set the password equal C.

457
00:46:19.520 --> 00:46:21.170
And now we're going to do our hashing

458
00:46:26.100 --> 00:46:39.950
so we'll use MDG five and we're going to empty five the M.D. 53rd version of our I.D. which we're gonna

459
00:46:39.950 --> 00:46:47.990
get from my S2 ally in set I.D. from our link.

460
00:46:49.280 --> 00:46:52.580
And then we want to append that to

461
00:46:56.120 --> 00:46:57.260
the password

462
00:47:01.840 --> 00:47:15.640
and we want to do that where the user I.D. is equal to my SKU ally insert I.D. link

463
00:47:19.300 --> 00:47:31.370
and we'll limit one just in case of so that should now save our password as a nice hashed version.

464
00:47:31.400 --> 00:47:33.890
So let's put a B on the end of that and just check.

465
00:47:33.920 --> 00:47:34.220
Okay.

466
00:47:34.250 --> 00:47:35.380
Looks good.

467
00:47:35.480 --> 00:47:37.750
Looks like we've signed the user up.

468
00:47:37.940 --> 00:47:44.860
Let's jump back to Firefox and take a look.

469
00:47:44.960 --> 00:47:48.430
Kay hasn't actually updated anything that's of course because

470
00:47:51.970 --> 00:47:53.650
I haven't actually run the query

471
00:47:58.330 --> 00:47:58.920
every guy.

472
00:47:58.950 --> 00:48:00.970
Let's try that again.

473
00:48:01.200 --> 00:48:04.800
So we'll sign them up with a C this time looking promising

474
00:48:07.350 --> 00:48:08.270
and there we go.

475
00:48:08.280 --> 00:48:11.600
We've got a nicely securely hashed password.

476
00:48:12.150 --> 00:48:12.890
Wonderful.

477
00:48:12.990 --> 00:48:13.830
So we're pretty close.

478
00:48:13.830 --> 00:48:20.010
We can now sign users up let's just log them in.

479
00:48:20.040 --> 00:48:24.770
So this was the log in active if statement which I can just check ends there.

480
00:48:25.770 --> 00:48:26.130
So

481
00:48:29.470 --> 00:48:37.300
if log in active is a one or is not zero then we're going to try and log the users in.

482
00:48:37.300 --> 00:48:47.440
So I'm actually going to use the same query as before to find the users to find the user by their email

483
00:48:47.440 --> 00:48:49.250
address.

484
00:48:49.250 --> 00:48:59.950
But this time I actually want to get a result so I'm gonna set ro equal to my rescue while I fetch

485
00:49:03.770 --> 00:49:15.670
associated and I want to select the res or really just one row associated with that result and then

486
00:49:16.540 --> 00:49:34.290
if the password in that right is equal to and then I'm gonna be my M.D. five hashing again this time

487
00:49:34.290 --> 00:49:41.820
we want to empty five not the my my askew ally insert I.D. but the row I.D.

488
00:49:46.810 --> 00:49:55.640
like that so we're gonna take the row I.D. MDG 5 that and append the posted password to that MDG 5 that

489
00:49:56.050 --> 00:50:00.940
and that should all equal these saved password if they've entered their password correctly.

490
00:50:04.160 --> 00:50:06.220
So if that's the case.

491
00:50:06.770 --> 00:50:12.020
Echo one else we'll have an error

492
00:50:17.830 --> 00:50:26.760
could not find that username slash password combination please try again.

493
00:50:30.670 --> 00:50:31.300
All right.

494
00:50:33.200 --> 00:50:34.620
So let's take a look.

495
00:50:36.580 --> 00:50:40.120
If we now attempt to log the user in instead of signing them up

496
00:50:45.150 --> 00:50:52.650
and often the simplest things I forgot the dollar sign in front of my error that and of course I don't

497
00:50:52.650 --> 00:50:53.370
actually need

498
00:50:56.740 --> 00:51:00.250
curly brackets around that.

499
00:51:00.250 --> 00:51:06.670
I was thinking of having an if statement there in front of my right but we don't need that because we're

500
00:51:06.670 --> 00:51:12.160
gonna have this error either way whether it finds a row or not.

501
00:51:14.400 --> 00:51:16.280
All right let's try that again.

502
00:51:16.280 --> 00:51:16.800
There we go.

503
00:51:17.180 --> 00:51:20.690
So we've got a one that because we've got a correct log in.

504
00:51:20.720 --> 00:51:26.030
If I change the password then we get an error message

505
00:51:30.120 --> 00:51:30.960
fabulous.

506
00:51:31.110 --> 00:51:34.020
So we're pretty close now we've got sign up and logging working.

507
00:51:34.020 --> 00:51:35.910
There are two things that remain.

508
00:51:35.910 --> 00:51:42.030
The first is that we need to show the user some friendly error messages and actually do the logging

509
00:51:42.030 --> 00:51:48.330
in and signing up and then finally we need to add the possibility to log out as well.

510
00:51:48.330 --> 00:51:51.960
So here we go for the friendly error messages.

511
00:51:52.140 --> 00:51:59.880
We're going to do that in footer BHP here and then instead of just alerting results we're going to test

512
00:51:59.880 --> 00:52:04.400
to see if result is equal to 1

513
00:52:08.900 --> 00:52:17.530
and all I'm going to do here is redirect them to the home page because they will already be logged in

514
00:52:19.920 --> 00:52:30.140
so I'm going to do that using window dot location dot a sign and then the full home page that

515
00:52:33.690 --> 00:52:40.280
and if that's not the case that's display the error message in a friendly way

516
00:52:43.020 --> 00:52:50.790
so that's gonna be actually it's in footer as well isn't it because the model is up here we'll put it

517
00:52:51.180 --> 00:52:56.280
just above the email field so we'll have

518
00:53:01.280 --> 00:53:03.160
in the motel body.

519
00:53:03.160 --> 00:53:12.180
Hey Dave with a class of alert and alert danger

520
00:53:15.510 --> 00:53:20.260
and an I.D. of log in alert

521
00:53:23.020 --> 00:53:29.190
and initially we'll set a going to alert to be hidden.

522
00:53:32.480 --> 00:53:35.790
So I will just set the display to be.

523
00:53:39.470 --> 00:53:41.900
And then down and fix it up BHP

524
00:53:44.890 --> 00:53:47.920
if the response is not one then

525
00:53:51.540 --> 00:54:06.940
we'll find log in alert and we'll set the HMO to whatever the result is and we'll show it.

526
00:54:07.050 --> 00:54:08.070
So we'll make it display

527
00:54:12.080 --> 00:54:12.810
all right.

528
00:54:12.810 --> 00:54:13.460
Let's have a look.

529
00:54:16.380 --> 00:54:27.110
So if I try and log in with something empty then we get a decent response fantastic.

530
00:54:27.130 --> 00:54:33.140
That's just for a couple of days couldn't find that username password combination.

531
00:54:33.140 --> 00:54:40.400
Wonderful displaying the error message very nicely.

532
00:54:40.420 --> 00:54:51.720
So now I'm going to attempt to sign up with a new email address and that should redirect me to the main

533
00:54:51.720 --> 00:54:53.370
page.

534
00:54:53.370 --> 00:54:53.960
Fabulous.

535
00:54:54.720 --> 00:54:58.060
So that's now showing nicely to the user.

536
00:54:58.110 --> 00:55:02.130
We are going to need to actually do the log in.

537
00:55:02.370 --> 00:55:13.070
That's gonna be pretty easy at the beginning of functions dot BHP I'm gonna call a session start and

538
00:55:13.070 --> 00:55:28.370
then in actions dot BHP will set the session I.D. to be equal to in that case my ask you Ally insert

539
00:55:30.090 --> 00:55:30.540
I.D.

540
00:55:33.620 --> 00:55:50.900
link and down here we'll set these session I.D. to be right I.D. So with that we should create a session

541
00:55:51.950 --> 00:55:59.240
which tells us that the user is logged in and then over in headed up BHP we're going to do our final

542
00:55:59.240 --> 00:56:06.470
bit which is to change the code of this button to log out if the user is logged in.

543
00:56:06.470 --> 00:56:14.870
So round here I'm gonna initially cheat and just display the session variable

544
00:56:18.250 --> 00:56:21.970
so now if I sign up

545
00:56:25.100 --> 00:56:32.000
I'll just choose Rob at Rob dot com and then a password and then sign up.

546
00:56:32.510 --> 00:56:36.080
And interestingly we've got the idea variable but it's set to zero.

547
00:56:37.130 --> 00:56:40.340
I suspect that's because we've called a number query here.

548
00:56:41.450 --> 00:56:56.230
So what I'm gonna do is actually set the session I.D. here and then to keep everything the same I'll

549
00:56:56.230 --> 00:57:03.680
use session I.D. instead of my SKU ally inset I.D. in the query

550
00:57:08.760 --> 00:57:09.100
okay.

551
00:57:09.110 --> 00:57:11.360
Let's try that again.

552
00:57:11.540 --> 00:57:12.290
So log in.

553
00:57:12.290 --> 00:57:21.280
Sign up on our B rope to at Rob dot com password log in.

554
00:57:21.290 --> 00:57:21.830
Quite right.

555
00:57:21.830 --> 00:57:25.040
I wanted to sign up and there we go.

556
00:57:26.410 --> 00:57:34.290
So that's got our I.D. working for us.

557
00:57:34.520 --> 00:57:40.770
So now it's just a matter of checking here.

558
00:57:44.440 --> 00:57:45.670
To see if

559
00:57:51.960 --> 00:57:56.200
we've got a session I.D.

560
00:58:03.630 --> 00:58:04.620
And if we have

561
00:58:07.350 --> 00:58:09.020
we're going to need a logout button.

562
00:58:12.430 --> 00:58:15.520
So initially just copy that

563
00:58:21.270 --> 00:58:30.230
to logged out and we'll fix that in a moment but if we're not logged in then we'll have the same old

564
00:58:30.230 --> 00:58:30.590
button

565
00:58:33.950 --> 00:58:34.660
as before

566
00:58:40.190 --> 00:58:40.560
OK.

567
00:58:40.990 --> 00:58:48.060
So to log out I'm going to change this to a link and we're not gonna be using a modem or anything here.

568
00:58:48.070 --> 00:58:58.290
We're just going to link to question mark function is equal to log out

569
00:59:01.220 --> 00:59:11.210
and then close our link so before we write the log out function let's just refresh that and we do indeed

570
00:59:11.210 --> 00:59:21.010
have a log out page log out link sorry and then over in functions that BHP and I looked for function

571
00:59:21.040 --> 00:59:22.450
is log out there.

572
00:59:24.460 --> 00:59:29.130
So it functions dot BHP will have if

573
00:59:36.290 --> 00:59:40.400
they get variable function is equal to log out

574
00:59:43.930 --> 00:59:49.010
and then we'll just use session on set.

575
00:59:50.830 --> 00:59:56.670
And that should unset all of our session variables.

576
59:56.690 --> 1:00:01.490
So now if we click the log out button nothing happens.

577
1:00:01.760 --> 1:00:05.720
Not to worry.

578
1:00:05.880 --> 1:00:12.770
That's because I've gotten to add eight ref to my attribute nine.

579
1:00:14.550 --> 1:00:22.220
So let's try that again log out then that should reload the home page and you can see we've now got

580
1:00:22.520 --> 1:00:26.270
the log in sign up button so the user is definitely logged out.

581
1:00:27.350 --> 1:00:28.170
Phew.

582
1:00:28.190 --> 1:00:35.720
So it took us quite a while to get there but we now have a very general purpose page with a neat log

583
1:00:35.720 --> 1:00:43.610
in and sign up system which works and it's secure and the users can sign up log in and log out very

584
1:00:43.610 --> 1:00:45.530
simply.

585
1:00:45.560 --> 1:00:46.780
So I think that's time sir.

586
1:00:46.800 --> 1:00:53.810
And this video here and we'll begin in the next one to start creating the home page for our users.
