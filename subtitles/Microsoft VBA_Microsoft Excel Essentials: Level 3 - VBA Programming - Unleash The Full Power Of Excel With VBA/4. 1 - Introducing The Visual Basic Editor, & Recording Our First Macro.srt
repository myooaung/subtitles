1
00:00:00,000 --> 00:00:03,420
Okay,

2
00:00:03,420 --> 00:00:03,990
guys.

3
00:00:03,990 --> 00:00:06,020
And welcome to this lecture.

4
00:00:06,020 --> 00:00:06,340
Now,

5
00:00:06,340 --> 00:00:11,980
what we're gonna have a look at in this later is the visual basic editor on recording a

6
00:00:11,980 --> 00:00:18,400
simple macro on you'll remember from the 15 Golden Rules of cold coding.

7
00:00:18,400 --> 00:00:25,990
Rule number 12 is to use excels built in translator because trying to work out VB a coding

8
00:00:25,990 --> 00:00:30,530
from scratch is tremendously difficult and not always obvious.

9
00:00:30,530 --> 00:00:33,910
But using the clunky built in translator Sorry,

10
00:00:33,910 --> 00:00:34,630
Microsoft,

11
00:00:34,630 --> 00:00:39,460
you can get a good idea of the syntax and the structure that you need to use.

12
00:00:39,460 --> 00:00:40,530
Okay,

13
00:00:40,530 --> 00:00:40,920
Now,

14
00:00:40,920 --> 00:00:46,850
this file you can download from this lecture as a resource so you can play along on.

15
00:00:46,850 --> 00:00:51,420
What we're gonna do is we're gonna look at the different ways of accessing the visual basic

16
00:00:51,420 --> 00:00:55,210
editor on also different ways of recording a macro.

17
00:00:55,210 --> 00:00:56,050
So,

18
00:00:56,050 --> 00:00:57,080
firstly,

19
00:00:57,080 --> 00:01:02,610
to get into the visual basic editor on my preferred method on the preferred method of

20
00:01:02,610 --> 00:01:09,820
everyone I've ever taught from Excel on your keyboard hit Olt and F 11 and your visual

21
00:01:09,820 --> 00:01:11,880
basic and it's out will open.

22
00:01:11,880 --> 00:01:13,170
I'm just going to scroll that down.

23
00:01:13,170 --> 00:01:14,450
So it's full screen.

24
00:01:14,450 --> 00:01:15,680
They go on.

25
00:01:15,680 --> 00:01:18,480
This is the visual basic editor.

26
00:01:18,480 --> 00:01:22,390
Now it's made up of three primary areas.

27
00:01:22,390 --> 00:01:29,160
There is the project VB a project which is this area just here There is the properties area

28
00:01:29,160 --> 00:01:29,160
,

29
00:01:29,160 --> 00:01:33,780
which is this area just here on the main coding window.

30
00:01:33,780 --> 00:01:34,190
Now,

31
00:01:34,190 --> 00:01:34,840
at the moment,

32
00:01:34,840 --> 00:01:36,100
we have no code written,

33
00:01:36,100 --> 00:01:38,050
so we have nothing to edit.

34
00:01:38,050 --> 00:01:41,260
But these are the three key areas.

35
00:01:41,260 --> 00:01:43,200
Okay,

36
00:01:43,200 --> 00:01:44,510
I'm just gonna close that for a minute.

37
00:01:44,510 --> 00:01:46,670
We're gonna have looking and mill the way to get into it.

38
00:01:46,670 --> 00:01:50,700
If you don't have the developer tab in excel,

39
00:01:50,700 --> 00:01:51,510
just right.

40
00:01:51,510 --> 00:01:56,090
Click on any of the terms that you do have choose customized ribbon,

41
00:01:56,090 --> 00:02:02,510
and this window will appear on what you want to do is come down to develop at and just tick

42
00:02:02,510 --> 00:02:04,460
the developer button and click.

43
00:02:04,460 --> 00:02:05,180
OK,

44
00:02:05,180 --> 00:02:07,020
and then you'll have developer.

45
00:02:07,020 --> 00:02:11,790
So from develop a menu or from the developer Riman,

46
00:02:11,790 --> 00:02:14,590
you can click visual basic on Boom.

47
00:02:14,590 --> 00:02:17,360
You're straight back into the visual basic editor.

48
00:02:17,360 --> 00:02:18,500
Okay,

49
00:02:18,500 --> 00:02:20,010
now turn to put some code.

50
00:02:20,010 --> 00:02:23,640
And so what we're gonna do is we're gonna record a simple macro,

51
00:02:23,640 --> 00:02:25,850
so I'm just gonna close that for a second.

52
00:02:25,850 --> 00:02:31,870
Then we have three different ways of recording a macro from the developer ribbon.

53
00:02:31,870 --> 00:02:33,670
We can go to this button.

54
00:02:33,670 --> 00:02:36,560
Just he had that says record macro.

55
00:02:36,560 --> 00:02:43,430
Now all macro is going to do is record a set of keystrokes that you perform while it is

56
00:02:43,430 --> 00:02:44,260
recording.

57
00:02:44,260 --> 00:02:48,820
So you don't have to whisper while it's recording because it doesn't record audio.

58
00:02:48,820 --> 00:02:53,670
I'm thinking a friend that I used to work with for that one who is always silent.

59
00:02:53,670 --> 00:02:54,990
Williams recording macros.

60
00:02:54,990 --> 00:02:55,950
You know who you are.

61
00:02:55,950 --> 00:03:00,800
You could also use the view menu on.

62
00:03:00,800 --> 00:03:05,430
Do you have a Mac Rose option over here with a little down arrow where you could hit record

63
00:03:05,430 --> 00:03:10,360
macro or my preferred method is to use the little button down here.

64
00:03:10,360 --> 00:03:10,680
Now,

65
00:03:10,680 --> 00:03:14,190
if you don't see a button down here next to ready,

66
00:03:14,190 --> 00:03:19,770
just right click come up to the macro recording and you'll notice Well,

67
00:03:19,770 --> 00:03:22,020
not record in and just ticket.

68
00:03:22,020 --> 00:03:23,850
So when you click off,

69
00:03:23,850 --> 00:03:25,350
you have this little button.

70
00:03:25,350 --> 00:03:27,900
So when the but looks like this,

71
00:03:27,900 --> 00:03:29,400
you are not recording.

72
00:03:29,400 --> 00:03:31,150
But as soon as you click it,

73
00:03:31,150 --> 00:03:32,080
boom,

74
00:03:32,080 --> 00:03:33,930
you get this window on.

75
00:03:33,930 --> 00:03:36,630
That means you are now recording a macro,

76
00:03:36,630 --> 00:03:38,090
or you will be when you click.

77
00:03:38,090 --> 00:03:38,650
OK,

78
00:03:38,650 --> 00:03:39,560
now,

79
00:03:39,560 --> 00:03:42,390
a few things to consider here Macro names.

80
00:03:42,390 --> 00:03:44,990
You can call them pretty much anything you want.

81
00:03:44,990 --> 00:03:46,090
By default,

82
00:03:46,090 --> 00:03:51,650
Excel will call the macro one micro to macro three and on and on and on.

83
00:03:51,650 --> 00:03:55,000
But it's generally a good idea to call your macro,

84
00:03:55,000 --> 00:03:58,300
give it a name that actually describes what it does.

85
00:03:58,300 --> 00:04:03,490
So what we're actually going to do with this particular macro is we're gonna highlights all

86
00:04:03,490 --> 00:04:04,600
of our formulas.

87
00:04:04,600 --> 00:04:05,280
Now,

88
00:04:05,280 --> 00:04:12,650
there are three rules that you must dear to your names cannot be longer than 255 characters

89
00:04:12,650 --> 00:04:12,650
.

90
00:04:12,650 --> 00:04:15,090
They cannot have spaces,

91
00:04:15,090 --> 00:04:17,310
and they cannot begin with the number.

92
00:04:17,310 --> 00:04:19,400
Pretty much anything else is allowed.

93
00:04:19,400 --> 00:04:24,650
So I'm gonna call this highlights on.

94
00:04:24,650 --> 00:04:26,270
I tend to use Camel case.

95
00:04:26,270 --> 00:04:26,660
That is,

96
00:04:26,660 --> 00:04:27,680
I capitalize.

97
00:04:27,680 --> 00:04:31,760
The first letter of each word some people prefer underscores.

98
00:04:31,760 --> 00:04:32,980
I'm just a camel case.

99
00:04:32,980 --> 00:04:36,960
So highlight my form.

100
00:04:36,960 --> 00:04:37,500
You,

101
00:04:37,500 --> 00:04:38,390
Laz,

102
00:04:38,390 --> 00:04:42,180
I'm not going to assign a keyboard shortcut.

103
00:04:42,180 --> 00:04:43,250
Um,

104
00:04:43,250 --> 00:04:46,800
now store macro in this workbook,

105
00:04:46,800 --> 00:04:48,320
but we have different choices.

106
00:04:48,320 --> 00:04:50,190
We could have new workbook,

107
00:04:50,190 --> 00:04:54,140
which is pretty obvious one that us on a personal macro workbook.

108
00:04:54,140 --> 00:04:55,100
Well,

109
00:04:55,100 --> 00:04:56,830
we'll discuss this a little later on,

110
00:04:56,830 --> 00:04:57,360
but for now,

111
00:04:57,360 --> 00:05:01,050
we're just gonna choose this workbook on description.

112
00:05:01,050 --> 00:05:04,910
What we're going to say is this will cool,

113
00:05:04,910 --> 00:05:05,730
uh,

114
00:05:05,730 --> 00:05:08,050
in yellow.

115
00:05:08,050 --> 00:05:10,240
Oh,

116
00:05:10,240 --> 00:05:12,350
my phone.

117
00:05:12,350 --> 00:05:13,350
Um,

118
00:05:13,350 --> 00:05:14,830
I can't look on type.

119
00:05:14,830 --> 00:05:16,530
This will color in yellow,

120
00:05:16,530 --> 00:05:17,450
all my formulas.

121
00:05:17,450 --> 00:05:18,150
Okay,

122
00:05:18,150 --> 00:05:20,970
we are no recording a macro.

123
00:05:20,970 --> 00:05:22,120
As you can see,

124
00:05:22,120 --> 00:05:25,370
that this little symbol has changed to a square.

125
00:05:25,370 --> 00:05:26,280
Okay,

126
00:05:26,280 --> 00:05:27,650
let's do something.

127
00:05:27,650 --> 00:05:35,050
So what we want to do is come to the home ribbon we're gonna come to find on and select.

128
00:05:35,050 --> 00:05:39,090
We're going to go to go to special on.

129
00:05:39,090 --> 00:05:42,670
What we're gonna do is choose formulas on.

130
00:05:42,670 --> 00:05:45,760
We want formulas that result in numbers.

131
00:05:45,760 --> 00:05:46,650
Okay,

132
00:05:46,650 --> 00:05:50,710
so you can see automatically that all of the's cells,

133
00:05:50,710 --> 00:05:53,350
which contain formulas that result in numbers,

134
00:05:53,350 --> 00:05:54,550
have been highlighted.

135
00:05:54,550 --> 00:05:58,440
And then what we're gonna do is color them in yellow.

136
00:05:58,440 --> 00:05:59,760
So from the home tab,

137
00:05:59,760 --> 00:06:01,490
I'm just gonna hit yellow,

138
00:06:01,490 --> 00:06:03,290
and then I'm gonna click off.

139
00:06:03,290 --> 00:06:04,350
That's just click that.

140
00:06:04,350 --> 00:06:05,560
So there you go.

141
00:06:05,560 --> 00:06:08,090
That is everything that we wanted to do.

142
00:06:08,090 --> 00:06:12,270
So now we're gonna happily stop that recording and then begin again.

143
00:06:12,270 --> 00:06:14,490
Have a look at the code that's being generated.

144
00:06:14,490 --> 00:06:18,270
So we have three ways to stop a macro recording.

145
00:06:18,270 --> 00:06:20,850
We can hit the little stop button down here,

146
00:06:20,850 --> 00:06:22,450
which is normally the way I do it.

147
00:06:22,450 --> 00:06:28,350
We could go to the view tab to Mac Rose on press the stop recording button.

148
00:06:28,350 --> 00:06:33,030
Or we could go to the developer tab over to hear impressed.

149
00:06:33,030 --> 00:06:33,990
Stop recording.

150
00:06:33,990 --> 00:06:35,740
I prefer to use this one,

151
00:06:35,740 --> 00:06:36,540
so I'm just gonna hit.

152
00:06:36,540 --> 00:06:37,150
Stop.

153
00:06:37,150 --> 00:06:37,900
Okay,

154
00:06:37,900 --> 00:06:41,800
so let me just hit Cult and 11.

155
00:06:41,800 --> 00:06:45,680
And you can now see that we have a new thing.

156
00:06:45,680 --> 00:06:46,880
Appeared in R V B.

157
00:06:46,880 --> 00:06:47,770
A project.

158
00:06:47,770 --> 00:06:51,800
We have a little folder called Modules with a plus button side of it.

159
00:06:51,800 --> 00:06:53,070
So I'm just gonna hit plus,

160
00:06:53,070 --> 00:06:56,000
and you can see that we have module one.

161
00:06:56,000 --> 00:06:58,550
I'm just gonna double click on module one.

162
00:06:58,550 --> 00:07:01,950
And there is our first macro.

163
00:07:01,950 --> 00:07:07,330
You'll see that it is called a sub,

164
00:07:07,330 --> 00:07:09,100
which is short for subroutine.

165
00:07:09,100 --> 00:07:13,850
And it begins with the word sub and ends with the word end sub.

166
00:07:13,850 --> 00:07:15,350
Wherever you have a sub,

167
00:07:15,350 --> 00:07:16,950
you must have an end sub.

168
00:07:16,950 --> 00:07:18,990
And when you record a macro,

169
00:07:18,990 --> 00:07:21,000
that automatically happens.

170
00:07:21,000 --> 00:07:22,390
The name of the foot.

171
00:07:22,390 --> 00:07:24,870
The name of the macro is the one I typed in.

172
00:07:24,870 --> 00:07:29,460
And you can see that that's repeated here on our description.

173
00:07:29,460 --> 00:07:31,190
This will color it in yellow.

174
00:07:31,190 --> 00:07:33,810
All my formulas has also been added here.

175
00:07:33,810 --> 00:07:34,460
Now,

176
00:07:34,460 --> 00:07:39,120
a couple of things to notice is that some of the words it's very difficult to see,

177
00:07:39,120 --> 00:07:45,910
but some of the words are in blue on they are reserved words such as Sub Andi,

178
00:07:45,910 --> 00:07:50,870
I think with Andi and with and with our controlled words,

179
00:07:50,870 --> 00:07:51,950
reserved words.

180
00:07:51,950 --> 00:07:53,610
Some of the coat,

181
00:07:53,610 --> 00:07:55,200
some of it is in green,

182
00:07:55,200 --> 00:07:56,650
which is a remark.

183
00:07:56,650 --> 00:08:03,160
Remember the 15 golden Rules of coding number seven realm extensively,

184
00:08:03,160 --> 00:08:08,520
because remarks are always in green and you can always tell because there's a little

185
00:08:08,520 --> 00:08:10,490
apostrophe at the front of the line,

186
00:08:10,490 --> 00:08:15,190
so this technically is non execute herbal code.

187
00:08:15,190 --> 00:08:18,350
You can write absolutely anything you want in here,

188
00:08:18,350 --> 00:08:22,750
and it won't make a slightest bit of difference to the code because there is an apostrophe

189
00:08:22,750 --> 00:08:23,350
at the front.

190
00:08:23,350 --> 00:08:28,770
These are literally just for remarks on the rest of the lines.

191
00:08:28,770 --> 00:08:31,960
The black lines is the execute herbal code.

192
00:08:31,960 --> 00:08:34,270
Now you can come anywhere in this,

193
00:08:34,270 --> 00:08:39,770
and you can insert spaces or insert blank lines by just hitting enter to make the code a

194
00:08:39,770 --> 00:08:41,550
little bit easier to read on.

195
00:08:41,550 --> 00:08:46,910
That won't affect the code in any way because this is the execute herbal code.

196
00:08:46,910 --> 00:08:51,250
This is the excusable code on this is the excusable code.

197
00:08:51,250 --> 00:08:53,760
So now we have our macro recorded.

198
00:08:53,760 --> 00:08:56,960
Let's have a look at how we can use that now.

199
00:08:56,960 --> 00:08:59,610
We didn't assign a keyboard shortcut.

200
00:08:59,610 --> 00:09:04,820
So we're gonna have a look at the various different ways that we can use to execute or play

201
00:09:04,820 --> 00:09:13,700
that code from Excel that we just Then we just remove that highlighting to know felt There

202
00:09:13,700 --> 00:09:13,930
we go.

203
00:09:13,930 --> 00:09:15,320
So we're back to where we were.

204
00:09:15,320 --> 00:09:19,130
So to play or execute that macro,

205
00:09:19,130 --> 00:09:20,960
we could come to developer,

206
00:09:20,960 --> 00:09:27,860
we could hit Mac Rose and we could double quick highlight my formulas.

207
00:09:27,860 --> 00:09:33,780
So just double clicking that will automatically play or execute that code.

208
00:09:33,780 --> 00:09:35,800
Let me just put that back.

209
00:09:35,800 --> 00:09:37,310
So there's Method number one.

210
00:09:37,310 --> 00:09:40,990
No fell from view.

211
00:09:40,990 --> 00:09:43,180
We could come to Mac Rose,

212
00:09:43,180 --> 00:09:45,570
choose view microbes.

213
00:09:45,570 --> 00:09:49,120
We could highlight that on we could press run.

214
00:09:49,120 --> 00:09:54,990
That would also cause the same thing to happen that would execute the code languages

215
00:09:54,990 --> 00:09:55,640
Berland back.

216
00:09:55,640 --> 00:09:56,860
Um,

217
00:09:56,860 --> 00:10:01,390
we can also do it directly from the visual basic editor.

218
00:10:01,390 --> 00:10:03,050
So I'm just gonna bring that back up.

219
00:10:03,050 --> 00:10:05,220
And here we have two options.

220
00:10:05,220 --> 00:10:08,470
We can either come to run and press run,

221
00:10:08,470 --> 00:10:10,780
or we could press at five.

222
00:10:10,780 --> 00:10:15,990
Or we could just literally be somewhere any of accursed anywhere in the code and hit the

223
00:10:15,990 --> 00:10:16,710
play button.

224
00:10:16,710 --> 00:10:18,730
And then when we go back,

225
00:10:18,730 --> 00:10:21,380
we can see that that code is executed.

226
00:10:21,380 --> 00:10:22,600
So okay,

227
00:10:22,600 --> 00:10:24,030
so that's all well and good.

228
00:10:24,030 --> 00:10:25,910
So let's straight on her neck sheet.

229
00:10:25,910 --> 00:10:36,610
So let's go to develop on a Mac Rose DoubleClick and they go that codes executed

230
00:10:36,610 --> 00:10:37,310
beautifully.

231
00:10:37,310 --> 00:10:39,700
We could go to this one.

232
00:10:39,700 --> 00:10:43,220
Let's do the view one this time down to here.

233
00:10:43,220 --> 00:10:45,900
Few micro's on run I go.

234
00:10:45,900 --> 00:10:49,520
There's all of ourselves highlighted that have formulas we consume.

235
00:10:49,520 --> 00:10:51,100
It will do the same on that and weaken.

236
00:10:51,100 --> 00:10:53,680
Do assume it will do the same on that.

237
00:10:53,680 --> 00:10:54,830
So they go.

238
00:10:54,830 --> 00:10:57,090
There's our very first macro recorded.

239
00:10:57,090 --> 00:11:04,350
There is the visual basic editor on That is your first glimpse at visual basic for

240
00:11:04,350 --> 00:11:06,060
applications code.

241
00:11:06,060 --> 00:11:06,940
Okay,

242
00:11:06,940 --> 00:11:08,450
I'll see you in the next lecture

