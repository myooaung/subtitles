WEBVTT
ï»¿1
00:00:00.000 --> 00:00:06.510
Hello and welcome to another student Questions and Sida Lecture.

2
00:00:06.510 --> 00:00:12.630
Now this question is from a Latin Amat asks how to protect different cells with different

3
00:00:12.630 --> 00:00:15.580
protection levels on the same worksheet.

4
00:00:15.580 --> 00:00:19.720
Now the object of the exercise is that on that wants to create a spreadsheet that he can

5
00:00:19.720 --> 00:00:21.420
pass out to different users.

6
00:00:21.420 --> 00:00:25.550
But he doesn't want them to be able to change the order of the columns,

7
00:00:25.550 --> 00:00:27.070
mess up the titles or,

8
00:00:27.070 --> 00:00:29.420
more importantly or equally as importantly,

9
00:00:29.420 --> 00:00:30.720
mess up the formulas.

10
00:00:30.720 --> 00:00:35.970
All we want them to be able to access are the cells that they should be working in.

11
00:00:35.970 --> 00:00:40.520
Now you can download this file from this particular lecturer and you'll find out that we

12
00:00:40.520 --> 00:00:41.230
have sheet one,

13
00:00:41.230 --> 00:00:42.150
which is this one Here.

14
00:00:42.150 --> 00:00:46.750
We have a paste into this workbook and there's a subroutine that your pace into the

15
00:00:46.750 --> 00:00:47.760
workbook open.

16
00:00:47.760 --> 00:00:54.090
Andi this which has to subroutines the validate me on the protect me or something like that

17
00:00:54.090 --> 00:00:55.470
that protect me subroutine,

18
00:00:55.470 --> 00:00:57.280
which we're gonna wish through now.

19
00:00:57.280 --> 00:00:59.190
So here we have it.

20
00:00:59.190 --> 00:01:04.670
This is the This is the word book that I've recreated from an image posted in the Q and A

21
00:01:04.670 --> 00:01:05.280
So what?

22
00:01:05.280 --> 00:01:05.790
We have.

23
00:01:05.790 --> 00:01:10.100
I'm just using the ROK and tamping over and you see that we can select all these cells.

24
00:01:10.100 --> 00:01:12.440
But if I had the upper Okay,

25
00:01:12.440 --> 00:01:14.720
I cannot go up and they think the Dan air.

26
00:01:14.720 --> 00:01:15.180
Okay,

27
00:01:15.180 --> 00:01:16.360
I cannot go down.

28
00:01:16.360 --> 00:01:21.090
I can only go across so I can use all of these cells until I get here.

29
00:01:21.090 --> 00:01:23.030
And then when they hit the arrow key,

30
00:01:23.030 --> 00:01:25.660
it's going to skip over the formula and the game.

31
00:01:25.660 --> 00:01:29.240
Let me into stuff in here until I get here and again,

32
00:01:29.240 --> 00:01:31.450
it's going to force me over the formula,

33
00:01:31.450 --> 00:01:34.050
so the formula tabs are going to be protected.

34
00:01:34.050 --> 00:01:36.100
So let's take a look at the code.

35
00:01:36.100 --> 00:01:37.070
Firstly,

36
00:01:37.070 --> 00:01:38.080
this workbook,

37
00:01:38.080 --> 00:01:40.950
I'm just going to close those for a second so you can seal the code.

38
00:01:40.950 --> 00:01:44.130
What we have here is a It's just a workbook.

39
00:01:44.130 --> 00:01:44.560
Open.

40
00:01:44.560 --> 00:01:46.750
We have one variable,

41
00:01:46.750 --> 00:01:51.020
which is just gonna hold the row number of the first row toe lock.

42
00:01:51.020 --> 00:01:53.920
So let me just strengthen it so you can see it a bit better.

43
00:01:53.920 --> 00:01:54.380
Okay,

44
00:01:54.380 --> 00:01:57.790
so what we have is un protect the active sheet.

45
00:01:57.790 --> 00:01:58.130
Obviously,

46
00:01:58.130 --> 00:01:59.540
this is a protected sheet,

47
00:01:59.540 --> 00:02:04.690
so active sheet that's un protect password equals password So this can obviously be

48
00:02:04.690 --> 00:02:05.900
whatever you want it today.

49
00:02:05.900 --> 00:02:06.460
No,

50
00:02:06.460 --> 00:02:11.790
What we need to do is remove any locked percent protection from the first blank row.

51
00:02:11.790 --> 00:02:13.600
You'll know that if you right,

52
00:02:13.600 --> 00:02:15.680
click this and choose this is protected.

53
00:02:15.680 --> 00:02:16.880
So that's not gonna work.

54
00:02:16.880 --> 00:02:24.000
Let me just briefly on protecting the sheet review on Protect Sheet password.

55
00:02:24.000 --> 00:02:26.110
And now we're going to find out if I can type.

56
00:02:26.110 --> 00:02:26.570
There you go,

57
00:02:26.570 --> 00:02:29.430
right click format cells.

58
00:02:29.430 --> 00:02:30.010
Andi,

59
00:02:30.010 --> 00:02:32.520
this is the box I'm talking about here.

60
00:02:32.520 --> 00:02:35.230
This is the box that we want unchecked.

61
00:02:35.230 --> 00:02:36.670
So let's go back to the code.

62
00:02:36.670 --> 00:02:37.700
So here,

63
00:02:37.700 --> 00:02:41.270
active sheets us on protect password equals password that's going on.

64
00:02:41.270 --> 00:02:46.300
Protect hale sheet Now remove any locked protection from the first blank row.

65
00:02:46.300 --> 00:02:48.840
That's this road immediately here,

66
00:02:48.840 --> 00:02:50.960
Row five and to get to row.

67
00:02:50.960 --> 00:02:58.900
If I were going to say say range a 1,048,576 because this is Excel 2013 it's exactly the

68
00:02:58.900 --> 00:03:07.010
same in 2016 dot end Excel up going to say goes right the way up to the top to hear offset

69
00:03:07.010 --> 00:03:11.460
by one which is going to bring this down to here then we're going to say that entire row

70
00:03:11.460 --> 00:03:13.420
dot locked equals false,

71
00:03:13.420 --> 00:03:16.900
and that's going to remove all those little ticks that we just looked at.

72
00:03:16.900 --> 00:03:21.440
Now where we need to do is find the second blank row,

73
00:03:21.440 --> 00:03:22.990
which is rose six.

74
00:03:22.990 --> 00:03:24.290
So x,

75
00:03:24.290 --> 00:03:27.940
the variable here is gonna be ranged one million odd up,

76
00:03:27.940 --> 00:03:29.670
offset by two.

77
00:03:29.670 --> 00:03:33.080
So we're gonna cut to a four and down to a six,

78
00:03:33.080 --> 00:03:35.550
so x will be worth six.

79
00:03:35.550 --> 00:03:46.020
Then we're gonna lock everything from a six down to Q 1,048,576 dot locked equals.

80
00:03:46.020 --> 00:03:46.360
True,

81
00:03:46.360 --> 00:03:51.000
that's going to put a little tick in that box now because we know dealing middle line six.

82
00:03:51.000 --> 00:03:55.080
Where we actually want to do is lock the formulas online five.

83
00:03:55.080 --> 00:03:57.170
So we're going to say range the formulas Aaron,

84
00:03:57.170 --> 00:03:58.140
K and P,

85
00:03:58.140 --> 00:03:58.630
by the way.

86
00:03:58.630 --> 00:04:03.380
So formula at its OK X minus one.

87
00:04:03.380 --> 00:04:05.190
So six minus one is five.

88
00:04:05.190 --> 00:04:09.620
So this is going to be K five dot locked equal stream and exactly the same with P.

89
00:04:09.620 --> 00:04:14.140
And that is gonna look the formulas on the line that we want the users to enter into.

90
00:04:14.140 --> 00:04:15.200
Okay.

91
00:04:15.200 --> 00:04:20.650
And the last thing we need to do is go to the first cell that we want the user to populate

92
00:04:20.650 --> 00:04:20.650
.

93
00:04:20.650 --> 00:04:21.370
So again,

94
00:04:21.370 --> 00:04:23.740
we're going to go right to the bottom of the sheet up,

95
00:04:23.740 --> 00:04:25.810
offset by one and select.

96
00:04:25.810 --> 00:04:29.880
And that's gonna put our cell here on finally on workbook open.

97
00:04:29.880 --> 00:04:32.190
We're gonna password protect now,

98
00:04:32.190 --> 00:04:33.380
whatever options you have,

99
00:04:33.380 --> 00:04:35.140
any you can just record a macro.

100
00:04:35.140 --> 00:04:35.620
Andi,

101
00:04:35.620 --> 00:04:38.710
it will tell you what the different variables should bay.

102
00:04:38.710 --> 00:04:43.290
So that is how we lock this thing when the workbook opens.

103
00:04:43.290 --> 00:04:45.350
With this particular piece of code here.

104
00:04:45.350 --> 00:04:48.410
Now I'm losing my voice to apologize.

105
00:04:48.410 --> 00:04:50.890
So let's have a look at the other bits of code.

106
00:04:50.890 --> 00:04:52.000
The valuation code.

107
00:04:52.000 --> 00:04:53.880
So Project Explorer,

108
00:04:53.880 --> 00:04:54.580
Module one.

109
00:04:54.580 --> 00:04:55.600
Now let me close that.

110
00:04:55.600 --> 00:05:00.260
Now all of this code that that will be locked obviously a lonely bell to pick this will be

111
00:05:00.260 --> 00:05:02.290
tied to this validate me button.

112
00:05:02.290 --> 00:05:03.760
So once the uses ended,

113
00:05:03.760 --> 00:05:04.690
something fat less.

114
00:05:04.690 --> 00:05:07.580
Enter something in here and we go on,

115
00:05:07.580 --> 00:05:08.910
let's say hello.

116
00:05:08.910 --> 00:05:10.990
I'm excellently done this for three cells,

117
00:05:10.990 --> 00:05:12.820
but you'll get the picture in just a second.

118
00:05:12.820 --> 00:05:13.710
Sago.

119
00:05:13.710 --> 00:05:14.740
We got three bits a day,

120
00:05:14.740 --> 00:05:16.320
so we got some gobbledygook in there.

121
00:05:16.320 --> 00:05:16.770
Hello,

122
00:05:16.770 --> 00:05:18.250
in there and number in there.

123
00:05:18.250 --> 00:05:20.720
Now you can see that gobbledygook in here.

124
00:05:20.720 --> 00:05:23.680
This is a data validation from list.

125
00:05:23.680 --> 00:05:27.610
So the user is only gonna be able to pick something from the list.

126
00:05:27.610 --> 00:05:30.120
And if you need to add that list in code,

127
00:05:30.120 --> 00:05:32.490
you can easily add it into this module.

128
00:05:32.490 --> 00:05:33.330
Now,

129
00:05:33.330 --> 00:05:36.880
this is obviously going to fail because hello isn't a date.

130
00:05:36.880 --> 00:05:38.590
And neither is hello,

131
00:05:38.590 --> 00:05:39.250
a number.

132
00:05:39.250 --> 00:05:41.680
So what we have in the days of validation,

133
00:05:41.680 --> 00:05:45.550
this one up here is a very simple thing.

134
00:05:45.550 --> 00:05:49.350
We have an error check here variable called aero Check.

135
00:05:49.350 --> 00:05:50.880
And every time we find an era,

136
00:05:50.880 --> 00:05:52.710
it's going to increase by one.

137
00:05:52.710 --> 00:05:56.810
We're gonna use that at the end to tell the user if they made any mistakes.

138
00:05:56.810 --> 00:05:57.570
So again,

139
00:05:57.570 --> 00:05:59.200
what we're going to do will step through this.

140
00:05:59.200 --> 00:06:03.640
We have unprotected the sheet using the password password.

141
00:06:03.640 --> 00:06:06.790
We're going to go to the first populate herbal cell.

142
00:06:06.790 --> 00:06:12.430
That's the one the user me just typed into by going to the bottom of sheet all the way up

143
00:06:12.430 --> 00:06:13.530
on going there.

144
00:06:13.530 --> 00:06:15.490
So now we're in this cell now.

145
00:06:15.490 --> 00:06:21.400
Remove any error highlights if there are any which will have shortly this will remove them

146
00:06:21.400 --> 00:06:23.650
and set them all back to know felt.

147
00:06:23.650 --> 00:06:26.310
Now we've got a few things that we can use.

148
00:06:26.310 --> 00:06:30.420
There is no function that I'm aware of where you contest.

149
00:06:30.420 --> 00:06:32.980
If a cell contains text,

150
00:06:32.980 --> 00:06:38.900
you contest if it contains characters on the way to do that is by looking at the length.

151
00:06:38.900 --> 00:06:43.560
So we're going to say if the length of the active cell doesn't equal blank,

152
00:06:43.560 --> 00:06:49.420
then color that cell in red active cell die interior duck collect equals V be read on.

153
00:06:49.420 --> 00:06:51.950
Increase our error check by one.

154
00:06:51.950 --> 00:06:55.350
So air attack equals air check plus one F eight.

155
00:06:55.350 --> 00:06:56.680
There is something in that cell,

156
00:06:56.680 --> 00:07:01.160
so it's perfectly happy our first test is being passed on again.

157
00:07:01.160 --> 00:07:05.640
This is just in column May so repeat this for any columns with text.

158
00:07:05.640 --> 00:07:08.920
Check the length so into our second test.

159
00:07:08.920 --> 00:07:11.010
Now there is a built in function in VB.

160
00:07:11.010 --> 00:07:12.160
A little edgy check.

161
00:07:12.160 --> 00:07:13.600
If something is a date,

162
00:07:13.600 --> 00:07:16.050
the active seldom upset.

163
00:07:16.050 --> 00:07:17.250
No rose.

164
00:07:17.250 --> 00:07:19.190
One column which is here.

165
00:07:19.190 --> 00:07:22.030
If that value is not a date,

166
00:07:22.030 --> 00:07:23.990
so is date equals false.

167
00:07:23.990 --> 00:07:25.080
Then do this.

168
00:07:25.080 --> 00:07:28.410
So when we hit F eight Hello isn't a date,

169
00:07:28.410 --> 00:07:31.530
so never gonna color in that cell there.

170
00:07:31.530 --> 00:07:35.780
So we're going to say active cell offset one over interior decor equals for you.

171
00:07:35.780 --> 00:07:37.670
Be red and you can see that that's going to read.

172
00:07:37.670 --> 00:07:40.740
Now we're going to increase our every check by one.

173
00:07:40.740 --> 00:07:45.760
So Aerotek started at 00 equals zero plus one.

174
00:07:45.760 --> 00:07:47.120
We now have an error.

175
00:07:47.120 --> 00:07:47.590
Now,

176
00:07:47.590 --> 00:07:50.090
the next thing is to check for a numeric.

177
00:07:50.090 --> 00:07:50.590
Now,

178
00:07:50.590 --> 00:07:52.320
let me just move over a little bit.

179
00:07:52.320 --> 00:07:53.320
There's are numeric.

180
00:07:53.320 --> 00:07:58.850
So never gonna check f column f if this is a numeric value.

181
00:07:58.850 --> 00:07:59.780
So again,

182
00:07:59.780 --> 00:08:03.650
if is numeric active cell offset five Because we're here.

183
00:08:03.650 --> 00:08:07.510
12345 If that equals false,

184
00:08:07.510 --> 00:08:08.030
that is,

185
00:08:08.030 --> 00:08:11.120
It's not a numeric performed this test here.

186
00:08:11.120 --> 00:08:15.580
So active cell offset 123450.5 interior color equals red,

187
00:08:15.580 --> 00:08:17.050
so you can see that that's going red.

188
00:08:17.050 --> 00:08:19.680
A nella aerotek is worth two.

189
00:08:19.680 --> 00:08:21.080
So now we have.

190
00:08:21.080 --> 00:08:23.330
If the aerotek doesn't equal zero,

191
00:08:23.330 --> 00:08:23.910
that is.

192
00:08:23.910 --> 00:08:28.790
Errors were found that sound validation display a message box that says,

193
00:08:28.790 --> 00:08:31.120
please check your inputs and correct any errors.

194
00:08:31.120 --> 00:08:32.420
So lets his f eight.

195
00:08:32.420 --> 00:08:33.460
So there we go.

196
00:08:33.460 --> 00:08:36.630
Please check your inputs and correct any errors in red.

197
00:08:36.630 --> 00:08:38.750
So the user knows they have to go back.

198
00:08:38.750 --> 00:08:40.860
And also the song just gonna hit.

199
00:08:40.860 --> 00:08:41.450
Okay,

200
00:08:41.450 --> 00:08:45.920
Then we're gonna lock the the the We're gonna lock the sheet again.

201
00:08:45.920 --> 00:08:48.430
Password protected on We're gonna end.

202
00:08:48.430 --> 00:08:50.040
So that's the end of the program.

203
00:08:50.040 --> 00:08:51.390
That's how we validate it.

204
00:08:51.390 --> 00:08:52.000
No,

205
00:08:52.000 --> 00:08:54.050
if we say 20 foot,

206
00:08:54.050 --> 00:09:01.290
say Christmas 21st the 25th of the 12 2017 and 123 on,

207
00:09:01.290 --> 00:09:07.710
obviously you'll need to repeat all of these different checks for each of the columns on.

208
00:09:07.710 --> 00:09:08.850
Then we re run the code.

209
00:09:08.850 --> 00:09:12.250
We can see that column a is still text.

210
00:09:12.250 --> 00:09:14.360
That's good column B is a date,

211
00:09:14.360 --> 00:09:15.910
so we've moved straight over that.

212
00:09:15.910 --> 00:09:21.080
On column F is also is numeric side evaluates to true.

213
00:09:21.080 --> 00:09:23.660
So now our area check is worth zero.

214
00:09:23.660 --> 00:09:26.510
So we're going to completely bypass that message,

215
00:09:26.510 --> 00:09:30.190
and we're going to come down to the bottom here and call Protect me.

216
00:09:30.190 --> 00:09:34.940
Now Protect me is just a variation of the code we looked at on workbook open.

217
00:09:34.940 --> 00:09:40.720
We're going to say the entire road that we're currently on row five locket because once the

218
00:09:40.720 --> 00:09:43.360
user is entered it and it's being validated,

219
00:09:43.360 --> 00:09:45.050
then we want it to be locked.

220
00:09:45.050 --> 00:09:49.420
They're obviously Here is where you can add in your formulas to Colin,

221
00:09:49.420 --> 00:09:50.750
K and P.

222
00:09:50.750 --> 00:09:58.340
We're in a so offset 10 takes us to K on Offset 15 takes us to pee and you can do your

223
00:09:58.340 --> 00:09:58.920
formula.

224
00:09:58.920 --> 00:09:59.570
Whatever it is,

225
00:09:59.570 --> 00:10:01.560
they're So that's where you had your formulas.

226
00:10:01.560 --> 00:10:03.600
So act yourself.

227
00:10:03.600 --> 00:10:07.050
That entire row dot locked equals troop locks the entire room.

228
00:10:07.050 --> 00:10:11.860
We want to unlock everything in the row below on.

229
00:10:11.860 --> 00:10:13.160
We want to do exactly the same.

230
00:10:13.160 --> 00:10:15.120
Thing is we did when we opened the workbook.

231
00:10:15.120 --> 00:10:16.650
We're going to go to the bottom of the sheet,

232
00:10:16.650 --> 00:10:18.410
go up offset by two,

233
00:10:18.410 --> 00:10:21.930
because now we want the user to be able to access row six,

234
00:10:21.930 --> 00:10:23.580
but nothing from seven.

235
00:10:23.580 --> 00:10:24.190
And Bill Oh,

236
00:10:24.190 --> 00:10:25.640
we're going to step through.

237
00:10:25.640 --> 00:10:26.570
We're going to say that.

238
00:10:26.570 --> 00:10:28.370
So a to J.

239
00:10:28.370 --> 00:10:30.350
Which is going to take us all the way down.

240
00:10:30.350 --> 00:10:32.450
We're gonna look OK,

241
00:10:32.450 --> 00:10:38.610
We're gonna lock P and then we want to go to the first populate herbal cell that the user

242
00:10:38.610 --> 00:10:39.260
can have,

243
00:10:39.260 --> 00:10:41.370
which is now at rose six.

244
00:10:41.370 --> 00:10:44.350
I hope my voice holds out Florist on.

245
00:10:44.350 --> 00:10:46.470
Then we're going to protect the sheet again.

246
00:10:46.470 --> 00:10:48.060
N sub and sub.

247
00:10:48.060 --> 00:10:50.370
So now if we go up here,

248
00:10:50.370 --> 00:10:51.660
we'll find that become,

249
00:10:51.660 --> 00:10:52.040
actually,

250
00:10:52.040 --> 00:10:53.750
select any of the cells.

251
00:10:53.750 --> 00:10:55.450
Except for these and again,

252
00:10:55.450 --> 00:10:56.360
when we tab over,

253
00:10:56.360 --> 00:10:57.950
we'll get to formula on.

254
00:10:57.950 --> 00:10:59.840
We wont bearable to select it.

255
00:10:59.840 --> 00:11:06.570
Now what I'm gonna do for a second close safe on when I reopen that book when it finishes

256
00:11:06.570 --> 00:11:07.770
saving,

257
00:11:07.770 --> 00:11:08.980
There we go.

258
00:11:08.980 --> 00:11:09.960
Um,

259
00:11:09.960 --> 00:11:15.800
when I reopen that workbook that should take a straight down to row six but not allow us to

260
00:11:15.800 --> 00:11:17.450
pick anything else.

261
00:11:17.450 --> 00:11:18.900
Hopefully,

262
00:11:18.900 --> 00:11:20.080
that made a lot of sense.

263
00:11:20.080 --> 00:11:21.020
Is always you condemn,

264
00:11:21.020 --> 00:11:23.490
blurred this file from this lecture on,

265
00:11:23.490 --> 00:11:24.820
have a play around with code,

266
00:11:24.820 --> 00:11:28.050
and I hope that helps is always If you have any questions,

267
00:11:28.050 --> 00:11:30.090
just drop her a note into the Q and A,

268
00:11:30.090 --> 00:11:31.560
and I'll be happy to get back to you.

269
00:11:31.560 --> 00:11:32.890
Have a great day.

