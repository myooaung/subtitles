WEBVTT
ï»¿1
00:00:00.000 --> 00:00:02.300
Okay,

2
00:00:02.300 --> 00:00:02.680
guys,

3
00:00:02.680 --> 00:00:02.800
um,

4
00:00:02.800 --> 00:00:03.770
welcome back.

5
00:00:03.770 --> 00:00:08.980
And then we're down to the pivot table code as opposed to pivot chart code,

6
00:00:08.980 --> 00:00:11.190
which is what we were looking at in the last lecture.

7
00:00:11.190 --> 00:00:14.320
Or so now we have to pivot tables.

8
00:00:14.320 --> 00:00:16.920
We have a profit by sales body,

9
00:00:16.920 --> 00:00:22.150
which gives us a little pivot table and tells us how much property sales person generated.

10
00:00:22.150 --> 00:00:26.990
And then we have an equivalent public table called profit by category,

11
00:00:26.990 --> 00:00:30.580
but gives us the same information but broken down by category.

12
00:00:30.580 --> 00:00:34.380
And these are the two sets of code as we recorded them.

13
00:00:34.380 --> 00:00:41.350
Now we can see here that the 1st 2 lines were range a 60 g 466 dot select,

14
00:00:41.350 --> 00:00:44.360
which is identical in both instances.

15
00:00:44.360 --> 00:00:44.750
Well,

16
00:00:44.750 --> 00:00:47.940
because we have a day to capture routing way up the front,

17
00:00:47.940 --> 00:00:50.300
we don't need tohave those now.

18
00:00:50.300 --> 00:00:51.640
We also have a sheets.

19
00:00:51.640 --> 00:00:56.880
Add now because we're going to be working in the newly created sheet and that will be the

20
00:00:56.880 --> 00:00:57.780
active sheet.

21
00:00:57.780 --> 00:01:01.610
We also don't need that bit of code so we can delete that.

22
00:01:01.610 --> 00:01:02.610
Now,

23
00:01:02.610 --> 00:01:06.330
let's get down to this first lack of code here.

24
00:01:06.330 --> 00:01:07.870
If you have a look,

25
00:01:07.870 --> 00:01:13.160
the only difference between the two of them is the table destination,

26
00:01:13.160 --> 00:01:16.320
and in this instance it say she too,

27
00:01:16.320 --> 00:01:17.820
because it had in a new sheet.

28
00:01:17.820 --> 00:01:21.270
Which was she to at Row three Column one.

29
00:01:21.270 --> 00:01:29.000
You'll notice that the source data for this table on the source data for this table is

30
00:01:29.000 --> 00:01:30.290
exactly the same.

31
00:01:30.290 --> 00:01:34.280
The only thing different in this first block of code is this.

32
00:01:34.280 --> 00:01:40.970
Say's onto sheet to because he landed a new sheets and then they also added a new sheet on

33
00:01:40.970 --> 00:01:43.000
it moved it to sheet three.

34
00:01:43.000 --> 00:01:44.290
So essentially,

35
00:01:44.290 --> 00:01:47.970
that's the same piece of code bar the destination on.

36
00:01:47.970 --> 00:01:53.440
We're going to get around that by using the active sheet because we were creating a new

37
00:01:53.440 --> 00:01:58.310
sheet and we're just gonna drop it into the active sheet will change which sell it goes

38
00:01:58.310 --> 00:01:58.690
into,

39
00:01:58.690 --> 00:02:01.550
but it's definitely going to be the active active sheet.

40
00:02:01.550 --> 00:02:02.160
Okay,

41
00:02:02.160 --> 00:02:07.230
so then we have the sheets to dock select in cells 31 We don't need that because we're

42
00:02:07.230 --> 00:02:08.780
gonna be working on the active sheet.

43
00:02:08.780 --> 00:02:10.790
Someone delete that from both of them,

44
00:02:10.790 --> 00:02:15.350
and then we come down to this with end with part just yet.

45
00:02:15.350 --> 00:02:21.570
And here is where the key difference between the two pieces of code is obviously this one

46
00:02:21.570 --> 00:02:24.910
was called Pivot Table 11 and this was called pivot table 13.

47
00:02:24.910 --> 00:02:26.970
That's because as you generate them,

48
00:02:26.970 --> 00:02:31.130
they incremental number on Dhere is the difference.

49
00:02:31.130 --> 00:02:38.770
This one say sales person this one say's category and essentially buy the naming of the

50
00:02:38.770 --> 00:02:39.330
table.

51
00:02:39.330 --> 00:02:44.420
That is the only difference between the two pieces of code.

52
00:02:44.420 --> 00:02:49.840
So what we're gonna do is we're going to do everything that we want to do with this piece

53
00:02:49.840 --> 00:02:51.850
of code just here on.

54
00:02:51.850 --> 00:02:53.150
Then we're going to copy this,

55
00:02:53.150 --> 00:02:58.300
pace it over here and just make a slight modification to the name on where we're going to

56
00:02:58.300 --> 00:02:58.850
drop it.

57
00:02:58.850 --> 00:03:03.310
So everything we're going to do in the next couple lectures is all gonna be on the profit

58
00:03:03.310 --> 00:03:04.280
by sales spot.

59
00:03:04.280 --> 00:03:04.770
Now,

60
00:03:04.770 --> 00:03:10.350
the first thing that we need to do is build a can Katyn ated string to replace this here.

61
00:03:10.350 --> 00:03:12.010
If you have a look at it,

62
00:03:12.010 --> 00:03:15.090
you'll notice that the format is slightly different.

63
00:03:15.090 --> 00:03:15.430
In fact,

64
00:03:15.430 --> 00:03:17.880
you may see that better if I click off right.

65
00:03:17.880 --> 00:03:20.600
You'll remember from when we did a pivot chart,

66
00:03:20.600 --> 00:03:27.690
we had an apostrophe before the sheet name no What I'm gonna do is I'm just gonna copy all

67
00:03:27.690 --> 00:03:28.180
of that,

68
00:03:28.180 --> 00:03:32.670
and I'm gonna add it up here to our days at capture.

69
00:03:32.670 --> 00:03:36.010
I'm going to say sorry.

70
00:03:36.010 --> 00:03:45.670
Build So data string for pivot tables,

71
00:03:45.670 --> 00:03:48.850
intent,

72
00:03:48.850 --> 00:03:50.860
upholstery and paste.

73
00:03:50.860 --> 00:03:52.890
That is the string that we're looking to build.

74
00:03:52.890 --> 00:03:54.560
So I'm just gonna portia second,

75
00:03:54.560 --> 00:03:57.070
build that string and I'll be back with you in just a second.

76
00:03:57.070 --> 00:04:00.130
Okay,

77
00:04:00.130 --> 00:04:00.550
guys,

78
00:04:00.550 --> 00:04:01.520
welcome back.

79
00:04:01.520 --> 00:04:01.750
Now,

80
00:04:01.750 --> 00:04:03.540
I have no of written this string.

81
00:04:03.540 --> 00:04:05.490
That's no called my pin data,

82
00:04:05.490 --> 00:04:07.210
which is my source sheet,

83
00:04:07.210 --> 00:04:11.780
which we've already captured while we're looking at the source sheet on the apostrophe Me

84
00:04:11.780 --> 00:04:12.510
partially here.

85
00:04:12.510 --> 00:04:14.990
But instead of using the are the roast,

86
00:04:14.990 --> 00:04:19.040
the R one C one format I would have done is said a six.

87
00:04:19.040 --> 00:04:24.430
Because that's where we started our data dot current region dot address And that's gonna

88
00:04:24.430 --> 00:04:29.280
dynamically capture that data region regardless of how big a list.

89
00:04:29.280 --> 00:04:29.640
Now,

90
00:04:29.640 --> 00:04:31.430
obviously it's the address that we want.

91
00:04:31.430 --> 00:04:37.320
So can Katyn ated that is gonna return exactly the same string but in a one style,

92
00:04:37.320 --> 00:04:40.350
because I want to use this across the module.

93
00:04:40.350 --> 00:04:42.570
I've declared that way at the top here.

94
00:04:42.570 --> 00:04:48.750
Our string and it holds the built date arranged for the profit by sales bod on and the

95
00:04:48.750 --> 00:04:50.130
profit by category.

96
00:04:50.130 --> 00:04:53.150
So now what I'm gonna do is I'm just gonna copy that,

97
00:04:53.150 --> 00:04:57.540
and I'm gonna pay sit over our data source.

98
00:04:57.540 --> 00:04:57.860
You know,

99
00:04:57.860 --> 00:05:02.300
I can eliminate the quotes on just paste that in there,

100
00:05:02.300 --> 00:05:07.200
and the next thing we need to do is get rid of this pivot table name here.

101
00:05:07.200 --> 00:05:08.940
So what we're gonna do Luckily,

102
00:05:08.940 --> 00:05:13.680
renaming a pivot table is a lot simpler than renaming a pivot charts.

103
00:05:13.680 --> 00:05:15.230
So all we need to do is say,

104
00:05:15.230 --> 00:05:18.890
active sheet don't on.

105
00:05:18.890 --> 00:05:20.910
Then we say pivot tables,

106
00:05:20.910 --> 00:05:21.280
people,

107
00:05:21.280 --> 00:05:24.110
tables from brackets,

108
00:05:24.110 --> 00:05:27.430
open quotes on whatever the name of the pivot table is.

109
00:05:27.430 --> 00:05:29.490
That's probably gonna error when I click off a movie.

110
00:05:29.490 --> 00:05:31.050
It would copy that.

111
00:05:31.050 --> 00:05:35.820
So at the moment are pivot table is called that and look,

112
00:05:35.820 --> 00:05:36.140
Italy,

113
00:05:36.140 --> 00:05:38.230
it's just a simple dot name.

114
00:05:38.230 --> 00:05:39.590
And we're going to say,

115
00:05:39.590 --> 00:05:41.920
here we're going to call it profit by sounds,

116
00:05:41.920 --> 00:05:45.680
but proof by sales.

117
00:05:45.680 --> 00:05:50.780
And that will be the name of our pivot table from now on.

118
00:05:50.780 --> 00:05:58.940
So all they need to do is copy that on remove this reference to pivot table 11 on removed

119
00:05:58.940 --> 00:05:59.990
that reference period.

120
00:05:59.990 --> 00:06:01.530
Table 11 on.

121
00:06:01.530 --> 00:06:02.580
There they go.

122
00:06:02.580 --> 00:06:03.880
Were more or less good to go.

123
00:06:03.880 --> 00:06:04.810
Okay,

124
00:06:04.810 --> 00:06:07.420
so let's have a run of that code.

125
00:06:07.420 --> 00:06:09.850
So what I'm gonna do is copy this.

126
00:06:09.850 --> 00:06:11.330
I'm gonna have it.

127
00:06:11.330 --> 00:06:13.250
So I run order way up the top.

128
00:06:13.250 --> 00:06:15.190
Wherever it is up here,

129
00:06:15.190 --> 00:06:17.710
we know the code works perfectly well up to this point.

130
00:06:17.710 --> 00:06:18.710
So I'm just going to click on it.

131
00:06:18.710 --> 00:06:20.830
This subroutine hit debug it,

132
00:06:20.830 --> 00:06:25.410
run to cursor and he ago we can see that we are all the way through.

133
00:06:25.410 --> 00:06:27.410
We've created this so far.

134
00:06:27.410 --> 00:06:28.720
And now we're back over here.

135
00:06:28.720 --> 00:06:29.500
F eight.

136
00:06:29.500 --> 00:06:31.380
Andi the book.

137
00:06:31.380 --> 00:06:32.550
What did I not do?

138
00:06:32.550 --> 00:06:33.180
Right,

139
00:06:33.180 --> 00:06:33.520
Okay.

140
00:06:33.520 --> 00:06:35.480
I forgot to correct this on.

141
00:06:35.480 --> 00:06:41.370
What we're gonna say is we want this in the active sheet at range.

142
00:06:41.370 --> 00:06:42.400
And where should we have it?

143
00:06:42.400 --> 00:06:43.190
Let's have it.

144
00:06:43.190 --> 00:06:50.870
A 23 arrange a 23 close quotes close brackets Andi,

145
00:06:50.870 --> 00:06:54.040
click off and there hopefully will get past that.

146
00:06:54.040 --> 00:06:55.480
Bears are chart being built.

147
00:06:55.480 --> 00:06:59.610
Pivot Table 11 is going to be changed to profit by sales.

148
00:06:59.610 --> 00:07:01.250
But fantastic.

149
00:07:01.250 --> 00:07:04.040
That is going to sort it by sales person.

150
00:07:04.040 --> 00:07:04.510
They go,

151
00:07:04.510 --> 00:07:05.310
there's ourselves,

152
00:07:05.310 --> 00:07:07.000
folks Andi.

153
00:07:07.000 --> 00:07:07.860
That should.

154
00:07:07.860 --> 00:07:08.580
Then Oops,

155
00:07:08.580 --> 00:07:11.360
debug whatever I missed off their picked a pivot table.

156
00:07:11.360 --> 00:07:12.050
11

157
00:07:12.050 --> 00:07:14.140
So this core profit by cells,

158
00:07:14.140 --> 00:07:16.640
blood now isn't copy on.

159
00:07:16.640 --> 00:07:21.500
That's going to be profit by sales spot on hopefully f eight.

160
00:07:21.500 --> 00:07:22.440
On they go.

161
00:07:22.440 --> 00:07:24.380
That is the end of our subroutine.

162
00:07:24.380 --> 00:07:25.870
So fantastic.

163
00:07:25.870 --> 00:07:31.060
But the next thing we're going to do is have a look change in this header from row labels

164
00:07:31.060 --> 00:07:32.500
to something more meaningful.

165
00:07:32.500 --> 00:07:33.000
Okay,

166
00:07:33.000 --> 00:07:34.290
I'll see you in the next lecture.

