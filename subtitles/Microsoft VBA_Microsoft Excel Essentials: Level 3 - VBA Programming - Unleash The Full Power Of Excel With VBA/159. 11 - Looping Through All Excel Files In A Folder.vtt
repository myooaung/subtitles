WEBVTT
ï»¿1
00:00:00.000 --> 00:00:02.300
Okay,

2
00:00:02.300 --> 00:00:02.680
guys.

3
00:00:02.680 --> 00:00:03.620
And welcome back.

4
00:00:03.620 --> 00:00:09.410
One of the first things that we need to learn how to do is to loop through an open and

5
00:00:09.410 --> 00:00:14.380
close each of the Excel files in a specific folder.

6
00:00:14.380 --> 00:00:15.000
So what,

7
00:00:15.000 --> 00:00:17.580
we're gonna dio I've just knocked up a rough,

8
00:00:17.580 --> 00:00:18.350
better code.

9
00:00:18.350 --> 00:00:22.330
Very simple piece of code that's going to do precisely that.

10
00:00:22.330 --> 00:00:25.810
So this one's called Private sub open all files in folders.

11
00:00:25.810 --> 00:00:28.080
We're not going to do anything with them at the moment,

12
00:00:28.080 --> 00:00:31.850
but this is gonna form the shell of what we're going to modify a little later on.

13
00:00:31.850 --> 00:00:35.110
So here we have the folder name Seiko.

14
00:00:35.110 --> 00:00:37.240
Long slash users slash allen slash There.

15
00:00:37.240 --> 00:00:41.740
Stop slash demo slash on Just to show you what's in that folder.

16
00:00:41.740 --> 00:00:42.710
This is it.

17
00:00:42.710 --> 00:00:43.160
Here.

18
00:00:43.160 --> 00:00:50.270
So we have 12345678 Excel files on their name 2016 11 Eastern Milton,

19
00:00:50.270 --> 00:00:53.220
Southern western 2016 12 eastern,

20
00:00:53.220 --> 00:00:53.700
northern,

21
00:00:53.700 --> 00:00:54.860
southern and western.

22
00:00:54.860 --> 00:00:59.150
Now what we have is the past two here.

23
00:00:59.150 --> 00:01:00.510
Demo hard,

24
00:01:00.510 --> 00:01:02.460
cold ID on what this does.

25
00:01:02.460 --> 00:01:09.190
The file name is gonna hold the complete path and file name to each of these files in turn

26
00:01:09.190 --> 00:01:09.190
.

27
00:01:09.190 --> 00:01:11.440
So literally what this will do.

28
00:01:11.440 --> 00:01:17.150
We will hard code the folder name and then using this file name directory,

29
00:01:17.150 --> 00:01:21.050
the folder name we've just specified above wild card.

30
00:01:21.050 --> 00:01:23.800
That means it could be absolutely anything.

31
00:01:23.800 --> 00:01:28.880
Will have an extension dot x l Question Mark Question Mark.

32
00:01:28.880 --> 00:01:29.540
No question.

33
00:01:29.540 --> 00:01:32.430
Mark is a wild card for any letter.

34
00:01:32.430 --> 00:01:34.060
Where is the asterisk?

35
00:01:34.060 --> 00:01:37.150
Is a wild card for any letter or number.

36
00:01:37.150 --> 00:01:43.680
So basically anything that's in this folder here that we've specified just here that has

37
00:01:43.680 --> 00:01:51.100
the extension dot x l on anything else it can be XLs em XLs X on it could be called

38
00:01:51.100 --> 00:01:56.530
Absolutely anything will be loaded to the file name full name on.

39
00:01:56.530 --> 00:01:58.080
Then we just have a simple do loop.

40
00:01:58.080 --> 00:01:59.200
Now what the do loop does?

41
00:01:59.200 --> 00:02:00.740
It says workbooks open.

42
00:02:00.740 --> 00:02:01.950
We've seen this before.

43
00:02:01.950 --> 00:02:05.050
It's gonna say folder name and file name.

44
00:02:05.050 --> 00:02:08.940
So it's going to take this path and it's going to take this full name,

45
00:02:08.940 --> 00:02:13.790
which can be anything providing the 1st 2 letters after the dust is excel.

46
00:02:13.790 --> 00:02:16.130
So that will be workbooks open.

47
00:02:16.130 --> 00:02:16.770
Obviously,

48
00:02:16.770 --> 00:02:20.670
we will put some more clever code in here to do something with it once it's open.

49
00:02:20.670 --> 00:02:22.350
But just to demonstrate this,

50
00:02:22.350 --> 00:02:26.830
the next thing we're gonna do you say workbooks file name which we have here.

51
00:02:26.830 --> 00:02:28.730
Close save changes.

52
00:02:28.730 --> 00:02:29.250
Now,

53
00:02:29.250 --> 00:02:34.770
here is where we move on to the next file that meets this criteria.

54
00:02:34.770 --> 00:02:36.020
So essentially,

55
00:02:36.020 --> 00:02:38.150
this is Iterating through one.

56
00:02:38.150 --> 00:02:41.030
So let me just run this code and so you can see what it does.

57
00:02:41.030 --> 00:02:42.130
Something hit their fate.

58
00:02:42.130 --> 00:02:44.550
And here you can see my hover over.

59
00:02:44.550 --> 00:02:48.390
We have 2016 11 Eastern region,

60
00:02:48.390 --> 00:02:51.450
which is the first file in this faller.

61
00:02:51.450 --> 00:02:52.640
So they were going to it.

62
00:02:52.640 --> 00:02:55.710
A race Andi just hidden behind there.

63
00:02:55.710 --> 00:02:58.750
We have the Eastern Region fault file on there.

64
00:02:58.750 --> 00:02:59.760
We're gonna close it.

65
00:02:59.760 --> 00:03:02.390
And now look what happens when we hover over this.

66
00:03:02.390 --> 00:03:05.070
At the moment it says Eastern region.

67
00:03:05.070 --> 00:03:06.580
But when I hit F ace,

68
00:03:06.580 --> 00:03:09.070
no changes to Northern Region,

69
00:03:09.070 --> 00:03:14.170
which is the next Excel file that matches this criteria in the folder.

70
00:03:14.170 --> 00:03:14.690
So,

71
00:03:14.690 --> 00:03:14.920
Luke,

72
00:03:14.920 --> 00:03:15.680
through on,

73
00:03:15.680 --> 00:03:16.360
there we go.

74
00:03:16.360 --> 00:03:17.930
You can't actually see very well.

75
00:03:17.930 --> 00:03:19.360
But there is the northern region.

76
00:03:19.360 --> 00:03:24.700
And if I just play that that will open each of those files in turn and then immediately

77
00:03:24.700 --> 00:03:25.250
close them,

78
00:03:25.250 --> 00:03:28.110
we're gonna have a look at our to butcher that in the next section.

79
00:03:28.110 --> 00:03:29.070
I think it's an exception.

80
00:03:29.070 --> 00:03:30.150
We're gonna have a look at a book,

81
00:03:30.150 --> 00:03:31.770
you know,

82
00:03:31.770 --> 00:03:32.850
in the next section.

83
00:03:32.850 --> 00:03:33.320
In fact,

84
00:03:33.320 --> 00:03:37.240
what we're going to to so far up to this point A So far as I can recall,

85
00:03:37.240 --> 00:03:42.710
in the courses we've never actually looked how to do this dynamically.

86
00:03:42.710 --> 00:03:43.400
We've always,

87
00:03:43.400 --> 00:03:43.850
I think,

88
00:03:43.850 --> 00:03:45.010
hard coded.

89
00:03:45.010 --> 00:03:49.580
Where the pastor specific falls we're looking at are what we're gonna look at in the next

90
00:03:49.580 --> 00:03:52.010
lecture is how to use the folder picker.

91
00:03:52.010 --> 00:03:52.650
Okay,

92
00:03:52.650 --> 00:03:54.150
I'll see you in the next lecture.

