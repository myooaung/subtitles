WEBVTT
ï»¿1
00:00:00.000 --> 00:00:00.310
Okay,

2
00:00:00.310 --> 00:00:00.560
guys.

3
00:00:00.560 --> 00:00:04.950
So now we're going to discuss the workbook before close event.

4
00:00:04.950 --> 00:00:07.000
And as the name suggests,

5
00:00:07.000 --> 00:00:13.330
this before close event gets triggered whenever you try to close a workbook and it gets

6
00:00:13.330 --> 00:00:15.550
triggered before the workbook is close.

7
00:00:15.550 --> 00:00:16.120
Okay,

8
00:00:16.120 --> 00:00:16.370
So,

9
00:00:16.370 --> 00:00:16.730
actually,

10
00:00:16.730 --> 00:00:23.300
whatever code you right in there will be executed before the actual closing of the workbook

11
00:00:23.300 --> 00:00:24.260
happens,

12
00:00:24.260 --> 00:00:25.640
and you can get it.

13
00:00:25.640 --> 00:00:26.120
Of course,

14
00:00:26.120 --> 00:00:28.000
by going to your vb a editor.

15
00:00:28.000 --> 00:00:28.350
Ah,

16
00:00:28.350 --> 00:00:33.810
double clicking here on this workbook and selecting from this menu workbook and selecting

17
00:00:33.810 --> 00:00:36.200
both foreclose from this menu.

18
00:00:36.200 --> 00:00:39.870
So this is how you can get the before close event.

19
00:00:39.870 --> 00:00:40.390
Now,

20
00:00:40.390 --> 00:00:44.750
there is actually a parameter here called Cancel.

21
00:00:44.750 --> 00:00:50.500
And what this parameter does is that it allows you to actually cancel the closing off the

22
00:00:50.500 --> 00:00:50.980
workbook.

23
00:00:50.980 --> 00:00:52.070
So by default,

24
00:00:52.070 --> 00:00:54.120
its value is false.

25
00:00:54.120 --> 00:00:55.250
However,

26
00:00:55.250 --> 00:00:57.590
if we change its value to true,

27
00:00:57.590 --> 00:00:59.850
if you set its value to true,

28
00:00:59.850 --> 00:01:01.950
then the workbook it's not gonna close.

29
00:01:01.950 --> 00:01:02.290
Okay?

30
00:01:02.290 --> 00:01:05.930
So you can actually prank someone with that parameter.

31
00:01:05.930 --> 00:01:06.720
So see that?

32
00:01:06.720 --> 00:01:10.110
So I'm just going to set cancel equals true,

33
00:01:10.110 --> 00:01:10.470
okay.

34
00:01:10.470 --> 00:01:12.010
And then a message box.

35
00:01:12.010 --> 00:01:15.590
This workbook is not closing.

36
00:01:15.590 --> 00:01:16.450
Okay,

37
00:01:16.450 --> 00:01:19.710
so I'm just gonna try closing the workbook now.

38
00:01:19.710 --> 00:01:23.390
And this code is gonna be triggered when I tried to close the work.

39
00:01:23.390 --> 00:01:28.550
But so I'm just gonna close it here and you can see her message box.

40
00:01:28.550 --> 00:01:30.490
This workbook is not closing.

41
00:01:30.490 --> 00:01:32.830
And the workbook did not close.

42
00:01:32.830 --> 00:01:33.400
Okay,

43
00:01:33.400 --> 00:01:34.800
so by default,

44
00:01:34.800 --> 00:01:37.070
the value off cancel is false.

45
00:01:37.070 --> 00:01:37.590
However,

46
00:01:37.590 --> 00:01:44.080
if it is set to true in your procedure or in whatever code you right in the workbook before

47
00:01:44.080 --> 00:01:44.830
close event,

48
00:01:44.830 --> 00:01:46.750
the workbook is not going to be close.

49
00:01:46.750 --> 00:01:47.520
Okay,

50
00:01:47.520 --> 00:01:48.280
so Ah,

51
00:01:48.280 --> 00:01:50.420
this is the workbook before close event,

52
00:01:50.420 --> 00:01:54.400
we're gonna have another more practical example next.

53
00:01:54.400 --> 00:01:55.370
Okay,

54
00:01:55.370 --> 00:01:55.620
guys.

55
00:01:55.620 --> 00:02:02.010
So now we're gonna have another example a more practical one axity for the workbook before

56
00:02:02.010 --> 00:02:03.030
closed events.

57
00:02:03.030 --> 00:02:04.760
This is actually the dashboard.

58
00:02:04.760 --> 00:02:06.820
The I show as an example,

59
00:02:06.820 --> 00:02:09.750
dashboard on my excel dashboards scores.

60
00:02:09.750 --> 00:02:15.510
And you can see here that I've got a workbook before close event running on that dashboard

61
00:02:15.510 --> 00:02:15.510
.

62
00:02:15.510 --> 00:02:22.190
And what that does is that it calls a macro cold show ribbon says to actually put excel to

63
00:02:22.190 --> 00:02:24.390
the previous status of showing the ribbon.

64
00:02:24.390 --> 00:02:24.730
Okay,

65
00:02:24.730 --> 00:02:25.680
because actually,

66
00:02:25.680 --> 00:02:29.140
the ribbon is hidden whenever this workbook is opened.

67
00:02:29.140 --> 00:02:33.970
And also the sheet dashboard is activated whenever this workbook is open.

68
00:02:33.970 --> 00:02:39.180
So I'm putting Excel back to its normal status of showing the ribbon and showing old tools

69
00:02:39.180 --> 00:02:39.180
,

70
00:02:39.180 --> 00:02:39.520
you know,

71
00:02:39.520 --> 00:02:40.100
at the top.

72
00:02:40.100 --> 00:02:45.710
Because what actually happens when this workbook is closed.

73
00:02:45.710 --> 00:02:51.510
And if if I don't show the ribbon or if I don't run the macro is called show ribbon before

74
00:02:51.510 --> 00:02:52.680
closing the workbook.

75
00:02:52.680 --> 00:02:53.770
Is that the foreman?

76
00:02:53.770 --> 00:02:58.140
A bar is not gonna appear when we open excel afterwards.

77
00:02:58.140 --> 00:03:03.560
So if we open even any other workbook or any workbook and excel or open a New Excel

78
00:03:03.560 --> 00:03:04.100
workbook,

79
00:03:04.100 --> 00:03:05.950
the former bar is good not gonna show.

80
00:03:05.950 --> 00:03:06.300
And,

81
00:03:06.300 --> 00:03:06.850
you know,

82
00:03:06.850 --> 00:03:12.100
despite the fact that it's very easy to show the foreman a bar by going to the view menu on

83
00:03:12.100 --> 00:03:14.660
the ribbon and just sticking the formula bar,

84
00:03:14.660 --> 00:03:16.390
some users might not know that.

85
00:03:16.390 --> 00:03:20.150
So if you're using a computer with other people is well sharing a computer,

86
00:03:20.150 --> 00:03:20.600
you know,

87
00:03:20.600 --> 00:03:20.830
no,

88
00:03:20.830 --> 00:03:24.600
having the formula bar showing will seem awkward.

89
00:03:24.600 --> 00:03:24.960
OK,

90
00:03:24.960 --> 00:03:27.450
so this is why I try to make it simple.

91
00:03:27.450 --> 00:03:29.920
If somebody else is using a computer with me,

92
00:03:29.920 --> 00:03:30.540
OK,

93
00:03:30.540 --> 00:03:35.670
so I'm actually going to show you that practically so actually gonna remove the show ribbon

94
00:03:35.670 --> 00:03:36.210
Macro,

95
00:03:36.210 --> 00:03:40.100
This is a macro or procedure that I've written in another module.

96
00:03:40.100 --> 00:03:43.510
I'm just calling it inside the workbook before close event.

97
00:03:43.510 --> 00:03:43.900
Okay,

98
00:03:43.900 --> 00:03:45.580
so I'm just going to remove it here,

99
00:03:45.580 --> 00:03:47.580
and I'm gonna save my workbook.

100
00:03:47.580 --> 00:03:48.580
And this way,

101
00:03:48.580 --> 00:03:49.020
now,

102
00:03:49.020 --> 00:03:50.370
the ribbon is hidden.

103
00:03:50.370 --> 00:03:53.580
And actually not the whole bourbon will be hidden when we open in your workbook.

104
00:03:53.580 --> 00:03:54.640
Just a four minute bar.

105
00:03:54.640 --> 00:03:56.530
So I'm just gonna close here.

106
00:03:56.530 --> 00:03:57.660
The v b a editor.

107
00:03:57.660 --> 00:04:00.170
I'm gonna close this workbook and save it.

108
00:04:00.170 --> 00:04:01.980
Okay,

109
00:04:01.980 --> 00:04:04.400
Now I have opened a new workbook.

110
00:04:04.400 --> 00:04:05.530
A blank workbook,

111
00:04:05.530 --> 00:04:06.000
actually,

112
00:04:06.000 --> 00:04:07.080
and as you can see here,

113
00:04:07.080 --> 00:04:13.930
the ribbon ah has disappeared because I have not run the show ribbon macro.

114
00:04:13.930 --> 00:04:15.830
So you can actually show the formula bargain,

115
00:04:15.830 --> 00:04:20.220
But clicking on the view menu on the ribbon here and checking the formula bar.

116
00:04:20.220 --> 00:04:22.410
And then you can see the formula bar here.

117
00:04:22.410 --> 00:04:29.680
But actually the formula bar has disappeared because I had not run the show ribbon macro.

118
00:04:29.680 --> 00:04:31.460
So this is a practical example.

119
00:04:31.460 --> 00:04:33.060
We're actually having the show.

120
00:04:33.060 --> 00:04:33.980
Ribbon macro,

121
00:04:33.980 --> 00:04:40.470
run on the before close event can make Excel act normally or show the four middle bar size

122
00:04:40.470 --> 00:04:46.980
to not have things seem awkward for other users or so who are not very good with Excel or

123
00:04:46.980 --> 00:04:52.700
not familiar with this option of viewing the formula bar using the view menu here on the

124
00:04:52.700 --> 00:04:53.200
ribbon.

125
00:04:53.200 --> 00:04:55.390
Next we will see another example is,

126
00:04:55.390 --> 00:04:55.730
Well,

127
00:04:55.730 --> 00:04:56.190
okay,

128
00:04:56.190 --> 00:05:02.950
so another thing that I use the workbook before close event for his dashi automate my work

129
00:05:02.950 --> 00:05:02.950
.

130
00:05:02.950 --> 00:05:06.260
So maybe if from building a dashboard,

131
00:05:06.260 --> 00:05:11.190
if I'm building a dashboard and I'm using a lot of tabs in my dashboard here.

132
00:05:11.190 --> 00:05:12.030
So there is a road,

133
00:05:12.030 --> 00:05:13.510
eight others the dashboard.

134
00:05:13.510 --> 00:05:17.130
And this stop is the one that should show to the customer.

135
00:05:17.130 --> 00:05:19.740
And this is the interface of the dashboard.

136
00:05:19.740 --> 00:05:21.320
And there's an analysis Stab.

137
00:05:21.320 --> 00:05:23.510
There could be another top here called lists.

138
00:05:23.510 --> 00:05:27.460
And sometimes I might build a dashboard that has lots of tabs,

139
00:05:27.460 --> 00:05:29.390
maybe six or seven.

140
00:05:29.390 --> 00:05:31.680
And I just want to close my workbook.

141
00:05:31.680 --> 00:05:32.020
And,

142
00:05:32.020 --> 00:05:32.400
you know,

143
00:05:32.400 --> 00:05:34.370
normally the the other tabs,

144
00:05:34.370 --> 00:05:36.280
except for the dashboard tab,

145
00:05:36.280 --> 00:05:37.720
should be hidden on.

146
00:05:37.720 --> 00:05:40.600
I just don't want to hide the manually like right,

147
00:05:40.600 --> 00:05:41.970
click and click on hide.

148
00:05:41.970 --> 00:05:45.060
I just want them to be hidden once I closed the workbook.

149
00:05:45.060 --> 00:05:45.700
Okay,

150
00:05:45.700 --> 00:05:47.540
so we're going to see how to do that.

151
00:05:47.540 --> 00:05:49.150
So I use this a lot,

152
00:05:49.150 --> 00:05:49.720
actually.

153
00:05:49.720 --> 00:05:53.090
So here on the before close workbook event,

154
00:05:53.090 --> 00:05:58.860
in addition to the coal show ribbon line here which is actually gonna show the ribbon and

155
00:05:58.860 --> 00:06:02.060
make things not awkward for other Excel users,

156
00:06:02.060 --> 00:06:02.820
I might write,

157
00:06:02.820 --> 00:06:09.400
actually a procedure to hide my worksheets so as not to need to hide them manually before I

158
00:06:09.400 --> 00:06:10.550
close my workbook.

159
00:06:10.550 --> 00:06:11.190
Okay,

160
00:06:11.190 --> 00:06:13.270
I'm not hiding them in this case here,

161
00:06:13.270 --> 00:06:16.540
because this is an example dashboard that I showed to the students.

162
00:06:16.540 --> 00:06:18.570
I need everything to be shown for them.

163
00:06:18.570 --> 00:06:19.970
But normally in real life,

164
00:06:19.970 --> 00:06:22.970
I would actually hide the other worksheets.

165
00:06:22.970 --> 00:06:25.470
Except for the dashboard worksheet.

166
00:06:25.470 --> 00:06:25.790
Okay,

167
00:06:25.790 --> 00:06:30.940
So any other worksheets that are using the background is they They are considered the

168
00:06:30.940 --> 00:06:32.870
backstage of this dashboard.

169
00:06:32.870 --> 00:06:33.950
I would hide them.

170
00:06:33.950 --> 00:06:34.420
Okay,

171
00:06:34.420 --> 00:06:38.360
So I'm actually going to dim ws is work sheet.

172
00:06:38.360 --> 00:06:41.960
So I'm gonna actually declare a worksheet object variable.

173
00:06:41.960 --> 00:06:52.020
And I can actually say for each ws in this workbook worksheets next ws so I can actually

174
00:06:52.020 --> 00:06:57.280
write some code to hide the worksheets except for the dashboard worksheet.

175
00:06:57.280 --> 00:07:04.870
So if ws thought name is not equal to dashboard,

176
00:07:04.870 --> 00:07:10.680
then ws start visible equals Excel Sheet hidden.

177
00:07:10.680 --> 00:07:11.800
And if so,

178
00:07:11.800 --> 00:07:17.410
this actually will hide my worksheet if its name is not dashboard.

179
00:07:17.410 --> 00:07:18.110
Okay,

180
00:07:18.110 --> 00:07:19.450
so let's try that.

181
00:07:19.450 --> 00:07:20.890
I'm just gonna try here,

182
00:07:20.890 --> 00:07:22.020
closing the workbook.

183
00:07:22.020 --> 00:07:22.330
OK,

184
00:07:22.330 --> 00:07:27.280
so let's say I have been working on this workbook and I opened all the tabs because they

185
00:07:27.280 --> 00:07:29.320
needed to do some maintenance on this dashboard.

186
00:07:29.320 --> 00:07:33.140
Maybe add more data or do some amendments or whatever.

187
00:07:33.140 --> 00:07:33.580
Okay.

188
00:07:33.580 --> 00:07:35.010
And I'm just gonna close.

189
00:07:35.010 --> 00:07:39.550
My workbook here says he can see air before closing.

190
00:07:39.550 --> 00:07:44.890
All the worksheets have been hidden except for the dashboard worksheet.

191
00:07:44.890 --> 00:07:45.230
Okay,

192
00:07:45.230 --> 00:07:46.920
so I'm gonna save it here.

193
00:07:46.920 --> 00:07:47.370
And I say,

194
00:07:47.370 --> 00:07:51.010
I'm going to say that now I've reopened again.

195
00:07:51.010 --> 00:07:52.140
As you can see here,

196
00:07:52.140 --> 00:07:54.640
all the the other worksheets,

197
00:07:54.640 --> 00:07:57.610
except for the dashboard worksheet,

198
00:07:57.610 --> 00:07:59.940
are actually hidden right now.

199
00:07:59.940 --> 00:08:00.220
Okay,

200
00:08:00.220 --> 00:08:02.240
so if I need to start working again,

201
00:08:02.240 --> 00:08:03.560
I cannon hide them.

202
00:08:03.560 --> 00:08:06.640
I can actually create another procedure as well.

203
00:08:06.640 --> 00:08:12.080
Just a normal procedure without an event that I would run that would actually Ian hide

204
00:08:12.080 --> 00:08:17.040
Omani worksheets if I want to start working in doing maintenance so I can create another

205
00:08:17.040 --> 00:08:21.100
procedure that would actually on Haida only worksheets,

206
00:08:21.100 --> 00:08:21.670
right?

207
00:08:21.670 --> 00:08:23.130
So you can do that.

208
00:08:23.130 --> 00:08:24.000
I believe you can do that.

209
00:08:24.000 --> 00:08:26.400
I want you to attempt to do that on your own,

210
00:08:26.400 --> 00:08:26.660
Okay?

211
00:08:26.660 --> 00:08:29.600
It's just going to be a simple for each loop,

212
00:08:29.600 --> 00:08:33.550
looping through all the worksheets and unhygienic them.

213
00:08:33.550 --> 00:08:35.700
And even if the worksheet is unhindered,

214
00:08:35.700 --> 00:08:37.550
nothing is gonna happen.

215
00:08:37.550 --> 00:08:40.300
Is just going to stay on hidden or visible.

216
00:08:40.300 --> 00:08:41.020
Okay,

217
00:08:41.020 --> 00:08:42.790
so I want you to attempt to do that.

218
00:08:42.790 --> 00:08:44.100
So Ah,

219
00:08:44.100 --> 00:08:46.630
that was the before close event.

220
00:08:46.630 --> 00:08:47.370
Thank you very much,

221
00:08:47.370 --> 00:08:47.610
guys,

222
00:08:47.610 --> 00:08:50.290
for watching this video I'll see on the next one.

