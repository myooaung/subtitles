WEBVTT
ï»¿1
00:00:00.000 --> 00:00:00.300
Hey,

2
00:00:00.300 --> 00:00:00.610
guys,

3
00:00:00.610 --> 00:00:02.030
Welcome best in this video.

4
00:00:02.030 --> 00:00:05.270
We're going to speak about workbook level events.

5
00:00:05.270 --> 00:00:10.430
So workbook level events happen whenever something happens on a workbook level.

6
00:00:10.430 --> 00:00:14.720
Such is opening a workbook or closing a workbook or saving a workbook.

7
00:00:14.720 --> 00:00:15.350
Andi,

8
00:00:15.350 --> 00:00:16.980
that's amongst other things,

9
00:00:16.980 --> 00:00:17.510
actually.

10
00:00:17.510 --> 00:00:18.160
Okay,

11
00:00:18.160 --> 00:00:21.390
so how do we go to work book events?

12
00:00:21.390 --> 00:00:25.150
So you congee just goto the developer Thomond Urban.

13
00:00:25.150 --> 00:00:26.490
Click on visual basic,

14
00:00:26.490 --> 00:00:29.150
or you can hit Alton F 11 on your keyboard.

15
00:00:29.150 --> 00:00:32.420
And then you can just double click on this workbook here.

16
00:00:32.420 --> 00:00:33.140
Okay,

17
00:00:33.140 --> 00:00:38.090
so this workbook actually is where you can write workbook events on.

18
00:00:38.090 --> 00:00:42.730
Then you can select from this menu Khiry select workbook.

19
00:00:42.730 --> 00:00:43.340
And then actually,

20
00:00:43.340 --> 00:00:48.930
the default event that gets started for you is actually the workbook open events.

21
00:00:48.930 --> 00:00:50.460
So on this event,

22
00:00:50.460 --> 00:00:57.020
what happens is that whatever code you put here gets executed when your workbook gets open

23
00:00:57.020 --> 00:00:57.020
.

24
00:00:57.020 --> 00:00:57.700
And actually,

25
00:00:57.700 --> 00:01:02.790
here is a full list of the events that you can use on a workbook level.

26
00:01:02.790 --> 00:01:03.460
Okay,

27
00:01:03.460 --> 00:01:04.110
Okay.

28
00:01:04.110 --> 00:01:06.050
So let's try to do something with that.

29
00:01:06.050 --> 00:01:08.300
So maybe message box.

30
00:01:08.300 --> 00:01:10.950
Welcome to the workbook.

31
00:01:10.950 --> 00:01:12.360
Okay.

32
00:01:12.360 --> 00:01:15.000
So now whenever we open this workbook,

33
00:01:15.000 --> 00:01:17.420
we're gonna have a message box that pops up.

34
00:01:17.420 --> 00:01:19.350
So I'm just gonna close here.

35
00:01:19.350 --> 00:01:22.850
Visual basic on and I'm gonna see the workbook.

36
00:01:22.850 --> 00:01:24.940
I'm gonna close the workbook.

37
00:01:24.940 --> 00:01:25.630
OK?

38
00:01:25.630 --> 00:01:28.320
Now have reopened my workbook.

39
00:01:28.320 --> 00:01:28.940
OK?

40
00:01:28.940 --> 00:01:30.250
And as you can see here,

41
00:01:30.250 --> 00:01:34.950
I've got my message box pumping up here.

42
00:01:34.950 --> 00:01:36.420
Welcome to the workbook.

43
00:01:36.420 --> 00:01:37.030
OK,

44
00:01:37.030 --> 00:01:42.670
so this enables you to execute any code that you would like whenever you work.

45
00:01:42.670 --> 00:01:42.920
Book?

46
00:01:42.920 --> 00:01:43.750
That's open.

47
00:01:43.750 --> 00:01:44.620
Okay,

48
00:01:44.620 --> 00:01:44.860
guys.

49
00:01:44.860 --> 00:01:48.970
So maybe I want to do something else whenever I open the workbook.

50
00:01:48.970 --> 00:01:53.300
Maybe I want to log the Dayton time on when it has been opened.

51
00:01:53.300 --> 00:01:53.880
Okay?

52
00:01:53.880 --> 00:01:59.250
And we will do that on sheet to and the workbooks of created two columns your date and time

53
00:01:59.250 --> 00:01:59.250
,

54
00:01:59.250 --> 00:02:03.960
And I wanna just logged the date and time whenever it gets open.

55
00:02:03.960 --> 00:02:04.470
Okay,

56
00:02:04.470 --> 00:02:06.550
so that would have a log here.

57
00:02:06.550 --> 00:02:09.220
So now I'm gonna go to Developer Tab,

58
00:02:09.220 --> 00:02:10.690
click on visual basic,

59
00:02:10.690 --> 00:02:13.660
and then click on this workbook and make sure I'm in the workbook.

60
00:02:13.660 --> 00:02:15.960
Open event direct workbook from here,

61
00:02:15.960 --> 00:02:17.160
and select Open.

62
00:02:17.160 --> 00:02:21.670
And now I'm going to write some code to do that and parts part of that.

63
00:02:21.670 --> 00:02:24.750
I need to actually know what the lost TRO is.

64
00:02:24.750 --> 00:02:25.450
First of all,

65
00:02:25.450 --> 00:02:26.630
I'm gonna dim sheet,

66
00:02:26.630 --> 00:02:27.150
too,

67
00:02:27.150 --> 00:02:28.650
as worksheet.

68
00:02:28.650 --> 00:02:29.410
Okay,

69
00:02:29.410 --> 00:02:36.850
So that I can give it a nickname and weaken work with that nickname and then set she to

70
00:02:36.850 --> 00:02:43.050
equals this workbook dot worksheets she to,

71
00:02:43.050 --> 00:02:46.860
And then we actually need to get what the last row is.

72
00:02:46.860 --> 00:02:55.710
The last row equals she two cells rose dot count comma one n dex elop dot ro.

73
00:02:55.710 --> 00:02:58.900
And then we need to put the date and time in the row.

74
00:02:58.900 --> 00:03:03.660
After the last row does she to dot cells,

75
00:03:03.660 --> 00:03:09.100
I'll are plus one and one equal states.

76
00:03:09.100 --> 00:03:16.410
And she two cells all are plus one and two equals time.

77
00:03:16.410 --> 00:03:16.670
Actually,

78
00:03:16.670 --> 00:03:23.350
there is a system function that school time that is gonna put the current time into a cell

79
00:03:23.350 --> 00:03:23.350
.

80
00:03:23.350 --> 00:03:27.250
So I'm just gonna close your the workbook when I close it.

81
00:03:27.250 --> 00:03:27.750
Here,

82
00:03:27.750 --> 00:03:28.490
save it.

83
00:03:28.490 --> 00:03:29.730
I'm gonna reopen it.

84
00:03:29.730 --> 00:03:30.100
Okay,

85
00:03:30.100 --> 00:03:31.940
so now I have reopened the workbook,

86
00:03:31.940 --> 00:03:33.350
and as you can see here,

87
00:03:33.350 --> 00:03:38.660
the date and time that the workbook has been reopened on has been logged.

88
00:03:38.660 --> 00:03:41.980
If we close it again and then we reopen it,

89
00:03:41.980 --> 00:03:46.350
you can see here that the date and time are going to be logged again as well.

90
00:03:46.350 --> 00:03:48.730
Even if we hide the worksheet,

91
00:03:48.730 --> 00:03:50.600
this is still gonna happen.

92
00:03:50.600 --> 00:03:54.190
So I'm gonna close it here and have re opened it again.

93
00:03:54.190 --> 00:03:59.590
And as you can see here by on high cheat to the date and time has still been log.

94
00:03:59.590 --> 00:04:05.020
And you can actually put pretty much any kind of code that you would like to happen in the

95
00:04:05.020 --> 00:04:06.410
workbook open event.

96
00:04:06.410 --> 00:04:06.790
OK,

97
00:04:06.790 --> 00:04:11.390
so whatever you want to put you can put there I've actually had a case where I needed

98
00:04:11.390 --> 00:04:13.840
actually to put the day off.

99
00:04:13.840 --> 00:04:15.230
Yesterday's dates.

100
00:04:15.230 --> 00:04:18.870
I used the day function and I used the date function.

101
00:04:18.870 --> 00:04:20.350
So I put in the cell.

102
00:04:20.350 --> 00:04:24.140
I said the value of that cell equals day of date minus one.

103
00:04:24.140 --> 00:04:24.660
And then,

104
00:04:24.660 --> 00:04:24.970
you know,

105
00:04:24.970 --> 00:04:31.040
there was another macro that was pulling up the day of yesterday's date and doing stuff

106
00:04:31.040 --> 00:04:31.390
with it.

107
00:04:31.390 --> 00:04:32.990
So that was actually ah,

108
00:04:32.990 --> 00:04:33.650
Riel,

109
00:04:33.650 --> 00:04:35.420
case scenario,

110
00:04:35.420 --> 00:04:40.010
riel life scenario that all used the workbook open event in.

111
00:04:40.010 --> 00:04:40.790
Okay,

112
00:04:40.790 --> 00:04:42.660
so that's it for the workbook.

113
00:04:42.660 --> 00:04:43.300
Open event.

114
00:04:43.300 --> 00:04:45.260
Thank you very much for watching this video.

115
00:04:45.260 --> 00:04:46.690
I'll see on the next one.

