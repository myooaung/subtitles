WEBVTT
X-TIMESTAMP-MAP=LOCAL:00:00:00.000,MPEGTS:0

00:00:00.000 --> 00:00:07.370
Hello and welcome back to one of the lesson in hashtag landing courses.

00:00:07.370 --> 00:00:08.670
In the previous lesson,

00:00:08.670 --> 00:00:13.070
we have discussed what theme multiple environments problem is,

00:00:13.070 --> 00:00:17.640
and the way to solve it is using the telephone works basis.

00:00:17.640 --> 00:00:18.240
Now,

00:00:18.240 --> 00:00:18.830
in this lesson,

00:00:18.830 --> 00:00:24.800
we're going to go ahead and check out how do create these workspaces in our projects and

00:00:24.800 --> 00:00:31.880
also apply these multiple workspaces toe create multiple resources in different

00:00:31.880 --> 00:00:35.060
environments using the same uniform scripts.

00:00:35.060 --> 00:00:37.050
So let's go ahead and get started.

00:00:37.050 --> 00:00:40.760
So the first thing that I want to tell you is basically,

00:00:40.760 --> 00:00:46.060
we're going to use the same existing easy to project that we have created in the models

00:00:46.060 --> 00:00:46.460
part.

00:00:46.460 --> 00:00:51.350
And we're going to create new workspaces for that specific project.

00:00:51.350 --> 00:00:53.700
And we are going to modify ah,

00:00:53.700 --> 00:00:58.010
bits and pieces off that project to accommodate the workspaces there.

00:00:58.010 --> 00:01:00.240
So let's go ahead and get started.

00:01:00.240 --> 00:01:02.180
So the first thing that I want to do is,

00:01:02.180 --> 00:01:03.150
um,

00:01:03.150 --> 00:01:06.710
create a copy off that existing models project.

00:01:06.710 --> 00:01:11.960
So the existing models project is this easy to models project part two.

00:01:11.960 --> 00:01:15.250
I'm just gonna copy and create a new part,

00:01:15.250 --> 00:01:30.110
and I'm gonna rename it as basically is he toe workspace workspaces project and let's go

00:01:30.110 --> 00:01:32.060
ahead and do some clean up in here.

00:01:32.060 --> 00:01:35.280
So I want to delete the state files.

00:01:35.280 --> 00:01:38.550
I don't want this particular file here.

00:01:38.550 --> 00:01:40.110
Okay,

00:01:40.110 --> 00:01:42.400
so now this is in a clean state.

00:01:42.400 --> 00:01:48.440
Now let's open the power so prompt and inside Partial prompt.

00:01:48.440 --> 00:01:54.890
Let's goto this CD easy to workspace project.

00:01:54.890 --> 00:01:55.450
OK,

00:01:55.450 --> 00:02:03.380
now we are here in the next thing that I want to do is open up my project in the sublime

00:02:03.380 --> 00:02:12.760
text and inside this you can see that you have you have this easy to workspaces project

00:02:12.760 --> 00:02:13.570
that we have created.

00:02:13.570 --> 00:02:19.680
So now let's go into the main and clear out this model because I just want to create one

00:02:19.680 --> 00:02:26.870
easy to instance like So now we have the product structure ready and we are now ready to

00:02:26.870 --> 00:02:28.130
create the works basis.

00:02:28.130 --> 00:02:29.530
Now,

00:02:29.530 --> 00:02:33.540
usually when you're creating a ah big infrastructure project,

00:02:33.540 --> 00:02:38.680
I would suggest to you toe create the workspace first and then slowly bill your environment

00:02:38.680 --> 00:02:38.680
.

00:02:38.680 --> 00:02:40.190
But for in this example,

00:02:40.190 --> 00:02:45.240
we're going the opposite way because we already have the project and we are creating

00:02:45.240 --> 00:02:48.970
multiple environments on and then we'll accommodate the court accordingly,

00:02:48.970 --> 00:02:50.040
so OK,

00:02:50.040 --> 00:02:53.300
so let's go ahead and create our workspace.

00:02:53.300 --> 00:02:54.680
So to create a workspace,

00:02:54.680 --> 00:02:56.690
you need to be in that particular project,

00:02:56.690 --> 00:02:57.030
Fuller,

00:02:57.030 --> 00:03:02.320
where you're executing the terra form and you need to execute this particular common,

00:03:02.320 --> 00:03:05.890
which is called terra form workspace.

00:03:05.890 --> 00:03:12.110
New because you're creating a new workspace and you have to give it a name.

00:03:12.110 --> 00:03:13.780
So I'm gonna call my,

00:03:13.780 --> 00:03:14.570
um,

00:03:14.570 --> 00:03:17.020
environment staging,

00:03:17.020 --> 00:03:22.170
and you can see that you have now created environment called staging.

00:03:22.170 --> 00:03:23.090
And,

00:03:23.090 --> 00:03:23.750
um,

00:03:23.750 --> 00:03:27.180
your workspace is now selected as staging.

00:03:27.180 --> 00:03:28.220
Now,

00:03:28.220 --> 00:03:32.300
I also want to create other workspace call production.

00:03:32.300 --> 00:03:32.700
Right.

00:03:32.700 --> 00:03:35.390
So I'm going to do terra form workspace,

00:03:35.390 --> 00:03:37.050
um,

00:03:37.050 --> 00:03:39.550
new production.

00:03:39.550 --> 00:03:42.030
Right.

00:03:42.030 --> 00:03:43.470
So you have no staging,

00:03:43.470 --> 00:03:44.860
and now you have production.

00:03:44.860 --> 00:03:46.890
So firstly,

00:03:46.890 --> 00:03:51.880
I want to show you the list off all the environments that are created here.

00:03:51.880 --> 00:03:52.730
So to do that,

00:03:52.730 --> 00:03:56.490
you can do terra form workspace list.

00:03:56.490 --> 00:03:57.350
Now,

00:03:57.350 --> 00:03:58.300
when you do this list,

00:03:58.300 --> 00:04:01.460
you can see all the environments that are available here.

00:04:01.460 --> 00:04:03.030
You have the default environment.

00:04:03.030 --> 00:04:06.780
That's the default when you create any terra form file and,

00:04:06.780 --> 00:04:07.480
um,

00:04:07.480 --> 00:04:12.160
you have created a specific environment called production and you have created a specific

00:04:12.160 --> 00:04:17.000
workspace called staging and you can see that there is a small ass trick here which tells

00:04:17.000 --> 00:04:19.330
us that it iss Ah,

00:04:19.330 --> 00:04:19.870
I just this,

00:04:19.870 --> 00:04:21.930
um workspace,

00:04:21.930 --> 00:04:23.730
which is currently selected.

00:04:23.730 --> 00:04:26.830
And it is being used now to switch between workspaces.

00:04:26.830 --> 00:04:30.650
All you have to do is run this commander of homework space,

00:04:30.650 --> 00:04:34.350
Select staging.

00:04:34.350 --> 00:04:37.500
Now you should see that it switched to the workspace stating,

00:04:37.500 --> 00:04:37.950
Right?

00:04:37.950 --> 00:04:41.270
So let's go ahead and work in this particular environment first,

00:04:41.270 --> 00:04:46.520
and then create a resource and then switch the environment and create other resource.

00:04:46.520 --> 00:04:52.850
And we'll see that how you can create multiple resources in different environments with the

00:04:52.850 --> 00:04:54.050
same terra form file.

00:04:54.050 --> 00:04:56.560
So let's go ahead and switch our,

00:04:56.560 --> 00:04:57.190
um,

00:04:57.190 --> 00:04:58.400
clear This,

00:04:58.400 --> 00:04:59.470
um,

00:04:59.470 --> 00:05:01.650
partial here.

00:05:01.650 --> 00:05:06.490
And let's go ahead and write some court,

00:05:06.490 --> 00:05:13.550
which gives us the capability toe detect which workspace that we're working on right now.

00:05:13.550 --> 00:05:17.170
So here I'm going to show you a concept off local variables.

00:05:17.170 --> 00:05:19.420
The locals variable is nothing,

00:05:19.420 --> 00:05:25.470
but you can have some special variables that are Onley toe this only related to the

00:05:25.470 --> 00:05:27.810
specific module or specific file.

00:05:27.810 --> 00:05:32.450
So to declare locals variable you can all do is locals,

00:05:32.450 --> 00:05:38.430
and you have to open close here and inside that you just declare some variable.

00:05:38.430 --> 00:05:39.150
So in this case,

00:05:39.150 --> 00:05:42.400
I'm just going to do ah ah environment.

00:05:42.400 --> 00:05:47.570
And this will called the value off.

00:05:47.570 --> 00:05:54.080
What workspace We're currently active on Soto Get which workspace we are currently active

00:05:54.080 --> 00:05:54.340
on.

00:05:54.340 --> 00:05:58.150
All we have to do is terra form dot workspace.

00:05:58.150 --> 00:06:04.770
Now this variable will give back Ah which workspace we're working on and it is being

00:06:04.770 --> 00:06:06.000
assigned to environment.

00:06:06.000 --> 00:06:12.790
Now how can we create multiple in multiple resource is with the same um,

00:06:12.790 --> 00:06:19.530
terra form file is basically you need to configure your project in innovate such that it's

00:06:19.530 --> 00:06:28.220
all controlled by variables and all the properties are chosen based on a specific value

00:06:28.220 --> 00:06:35.350
like this environment and then that particular values being assigned as a property to the

00:06:35.350 --> 00:06:38.010
resources that are being created for that environment.

00:06:38.010 --> 00:06:41.170
So I'll explain that to you by an example.

00:06:41.170 --> 00:06:48.000
So let's say now you're creating these easy to model here and let's go ahead and edit the

00:06:48.000 --> 00:06:49.700
security group model right?

00:06:49.700 --> 00:06:52.630
And inside the security group model,

00:06:52.630 --> 00:06:57.590
what we can do is we can take the name here,

00:06:57.590 --> 00:06:58.400
right,

00:06:58.400 --> 00:07:15.650
and we can say that we want to give variable Oh SG under school name and and here.

00:07:15.650 --> 00:07:18.610
What we can do is instead off this hard cored and name.

00:07:18.610 --> 00:07:19.040
Here,

00:07:19.040 --> 00:07:19.530
Weaken,

00:07:19.530 --> 00:07:21.090
give dollars.

00:07:21.090 --> 00:07:24.440
Bardot SG underscored name.

00:07:24.440 --> 00:07:24.910
Right.

00:07:24.910 --> 00:07:31.030
So now what we have to do is we have to supply this name from from an external source,

00:07:31.030 --> 00:07:34.070
which is where the model is being called.

00:07:34.070 --> 00:07:42.620
So I'm gonna say SG named equal to is G specific.

00:07:42.620 --> 00:07:43.390
Ah,

00:07:43.390 --> 00:07:44.280
security group.

00:07:44.280 --> 00:07:47.840
Easy to we have to given environment.

00:07:47.840 --> 00:07:50.000
So how do we call this local environment?

00:07:50.000 --> 00:07:52.680
All we have to do is we can do dollars,

00:07:52.680 --> 00:08:01.050
and we can reference it by saying locals dot um environment.

00:08:01.050 --> 00:08:04.620
So Ah,

00:08:04.620 --> 00:08:05.740
this is not locals.

00:08:05.740 --> 00:08:06.950
This is actually local,

00:08:06.950 --> 00:08:08.100
that environment.

00:08:08.100 --> 00:08:09.100
And,

00:08:09.100 --> 00:08:09.840
um,

00:08:09.840 --> 00:08:13.580
we're going to do the same thing for the easy to instance as well.

00:08:13.580 --> 00:08:22.660
We're going to say you see toe instance underscore we're gonna call again the local dot

00:08:22.660 --> 00:08:23.600
environment.

00:08:23.600 --> 00:08:24.340
All right,

00:08:24.340 --> 00:08:29.260
so what we're trying to do here is we're creating to re sources,

00:08:29.260 --> 00:08:32.430
which is our security group and are easy to instance,

00:08:32.430 --> 00:08:35.490
and both are are different models,

00:08:35.490 --> 00:08:42.980
and we're saying that we want to create names that are specific to a specific workspace

00:08:42.980 --> 00:08:44.540
that we're working on right now.

00:08:44.540 --> 00:08:49.780
So if we are choosing a staging environment than when we execute.

00:08:49.780 --> 00:08:52.630
This will get the security group a security group,

00:08:52.630 --> 00:08:54.340
easy to ah,

00:08:54.340 --> 00:08:55.080
staging,

00:08:55.080 --> 00:08:58.170
and the two incense would be easy to instance staging.

00:08:58.170 --> 00:08:59.080
Similarly,

00:08:59.080 --> 00:09:00.570
when you execute the production,

00:09:00.570 --> 00:09:04.050
you'll get this values as sGC to production,

00:09:04.050 --> 00:09:05.570
easy to instance,

00:09:05.570 --> 00:09:06.280
production.

00:09:06.280 --> 00:09:11.120
So let's go ahead and run the terra form and see the output and,

00:09:11.120 --> 00:09:11.820
ah,

00:09:11.820 --> 00:09:12.910
let's get started.

00:09:12.910 --> 00:09:17.950
So I've saved this and let me go to the telephone project.

00:09:17.950 --> 00:09:19.590
Currently,

00:09:19.590 --> 00:09:21.580
we are in already in the staging environment,

00:09:21.580 --> 00:09:28.820
the way you can confirm that issued by running the command terra form workspace list,

00:09:28.820 --> 00:09:32.830
and you can see that you're currently active in the staging environment.

00:09:32.830 --> 00:09:35.890
That's clear this and do a terra form in it.

00:09:35.890 --> 00:09:37.680
So now when you do a terror for minute,

00:09:37.680 --> 00:09:41.890
it initialize is and includes All the models are do you have declared,

00:09:41.890 --> 00:09:46.230
and once the plug ins are downloaded and ready,

00:09:46.230 --> 00:09:49.520
you can go ahead and on your telephone plan and apply.

00:09:49.520 --> 00:09:52.450
So let's clear it from here.

00:09:52.450 --> 00:09:54.650
It's still terra form planned.

00:09:54.650 --> 00:09:57.920
You should see that it's creating to resource is,

00:09:57.920 --> 00:10:01.230
and if I'm not wrong,

00:10:01.230 --> 00:10:07.120
you can see that you already got the name sGC to underscore staging Tough.

00:10:07.120 --> 00:10:07.960
Uh,

00:10:07.960 --> 00:10:10.890
you can see that easy to instant staging Now,

00:10:10.890 --> 00:10:13.350
this has been computed in the real time.

00:10:13.350 --> 00:10:14.340
I mean,

00:10:14.340 --> 00:10:18.060
in the run time when you when you selected the specific workspace.

00:10:18.060 --> 00:10:20.150
Now we can do telephone apply.

00:10:20.150 --> 00:10:22.910
And when you're applying,

00:10:22.910 --> 00:10:25.910
it will actually tell you that you are in the staging environment.

00:10:25.910 --> 00:10:27.870
And you you want to apply these changes.

00:10:27.870 --> 00:10:28.540
Yes,

00:10:28.540 --> 00:10:29.130
I want to apply.

00:10:29.130 --> 00:10:29.760
This changes.

00:10:29.760 --> 00:10:31.410
So it typed in?

00:10:31.410 --> 00:10:32.050
Yes.

00:10:32.050 --> 00:10:35.490
And now it's going to create this Easter.

00:10:35.490 --> 00:10:37.560
Two instance not pauses for a second.

00:10:37.560 --> 00:10:38.430
And once it is ready,

00:10:38.430 --> 00:10:42.510
I'm gonna come back and show you how it looks in the console colic.

00:10:42.510 --> 00:10:47.570
So now we how our resource is created.

00:10:47.570 --> 00:10:51.380
Let's go too easy to console and check if there actually created.

00:10:51.380 --> 00:10:55.570
So let me refresh this.

00:10:55.570 --> 00:10:56.550
Ah,

00:10:56.550 --> 00:10:59.010
council here.

00:10:59.010 --> 00:11:02.520
You can see that the EEC to instant staging has been created.

00:11:02.520 --> 00:11:07.610
And when you select that and you can see that the appropriate security group is also now

00:11:07.610 --> 00:11:08.200
created,

00:11:08.200 --> 00:11:10.650
which is easy to ah,

00:11:10.650 --> 00:11:13.000
security grow PC.

00:11:13.000 --> 00:11:14.410
Is he do staging?

00:11:14.410 --> 00:11:15.000
All right,

00:11:15.000 --> 00:11:17.650
so now we have our staging environment set up.

00:11:17.650 --> 00:11:18.060
Now.

00:11:18.060 --> 00:11:20.690
We were sure that everything is,

00:11:20.690 --> 00:11:21.610
um,

00:11:21.610 --> 00:11:23.290
created according to the plan.

00:11:23.290 --> 00:11:25.540
Now let's go ahead and push this to production,

00:11:25.540 --> 00:11:31.710
and the way you will do it is basically going to your Terra Form project folder and you'll

00:11:31.710 --> 00:11:34.150
select their form workspace.

00:11:34.150 --> 00:11:36.350
Select production,

00:11:36.350 --> 00:11:41.560
and you can see that your workspace is now switched to production.

00:11:41.560 --> 00:11:43.220
You'll do the same thing again,

00:11:43.220 --> 00:11:44.250
terra form in it.

00:11:44.250 --> 00:11:47.550
Now it's initializing the models,

00:11:47.550 --> 00:11:51.160
and you can do terra form um,

00:11:51.160 --> 00:11:53.000
plan.

00:11:53.000 --> 00:11:56.100
Now you see,

00:11:56.100 --> 00:12:02.150
it's creating two fresh new resource is because there's the properties are changed and

00:12:02.150 --> 00:12:04.000
you're giving different imports here.

00:12:04.000 --> 00:12:09.280
Now you can see that the names are sGC to production and easy to instance production.

00:12:09.280 --> 00:12:11.920
Now you can go ahead and do telephone apply,

00:12:11.920 --> 00:12:17.770
and then you can apply the change.

00:12:17.770 --> 00:12:20.440
And again,

00:12:20.440 --> 00:12:23.650
I'm gonna pause this and then come back once it is created.

00:12:23.650 --> 00:12:24.560
All right,

00:12:24.560 --> 00:12:28.510
so now these production issue two instances also created.

00:12:28.510 --> 00:12:30.850
Let's go back to the console and very five,

00:12:30.850 --> 00:12:33.400
we got the new instance or not.

00:12:33.400 --> 00:12:44.780
So let me open up the is he doing since console so you can see that easy to instance,

00:12:44.780 --> 00:12:51.070
production is also created and you can see that appropriate security group ste SI to

00:12:51.070 --> 00:12:52.490
production is also created.

00:12:52.490 --> 00:12:55.070
So this is how the workspaces work.

00:12:55.070 --> 00:13:01.630
And you can basically use the same terra form script to create multiple environments tax so

00:13:01.630 --> 00:13:04.140
that you have a consistent environment.

00:13:04.140 --> 00:13:04.950
Ah,

00:13:04.950 --> 00:13:05.550
I mean,

00:13:05.550 --> 00:13:10.250
you have a consistent infrastructure across environments created and it is easy for you to

00:13:10.250 --> 00:13:12.130
maintain and managed them.

00:13:12.130 --> 00:13:15.630
So that's pretty much it about the workspaces.

00:13:15.630 --> 00:13:22.790
Now I'm going toe show you how the Terra form state files are maintained in this works

00:13:22.790 --> 00:13:23.730
basis concept.

00:13:23.730 --> 00:13:25.960
And in this next in the next lesson,

00:13:25.960 --> 00:13:31.460
then we'll see many more tips and tricks that I have learned in my experience,

00:13:31.460 --> 00:13:33.840
which are not available directly documentation.

00:13:33.840 --> 00:13:36.370
So don't miss those parts.

00:13:36.370 --> 00:13:39.870
So let's go back and check how the terra form state files look like.

00:13:39.870 --> 00:13:41.970
Now you can see that,

00:13:41.970 --> 00:13:43.050
Um I mean,

00:13:43.050 --> 00:13:46.750
let me goto this part so you can see that Ah,

00:13:46.750 --> 00:13:51.180
here you have to reform docked DF ST dot de Right.

00:13:51.180 --> 00:13:52.200
In the previous projects,

00:13:52.200 --> 00:13:56.650
you have seen that the Terra form state file is directly under the root folder.

00:13:56.650 --> 00:14:02.420
But here you have the reform dot Kiev ST dot the folder and inside that you can see that

00:14:02.420 --> 00:14:07.210
there are two different folders which are staging and production right,

00:14:07.210 --> 00:14:11.440
and each workspace has its own terra form state file.

00:14:11.440 --> 00:14:17.500
So any resource changes that you create for that specific workspace are tracked in its own

00:14:17.500 --> 00:14:19.240
specific data from state fights.

00:14:19.240 --> 00:14:22.130
So that's pretty much it for this lesson.

00:14:22.130 --> 00:14:26.950
I really hope that you enjoyed this lesson and I'll see you in the next one.

00:14:26.950 --> 00:14:28.250
Thank you so much for watching.

