WEBVTT
1
00:00:00.320 --> 00:00:01.500
Let me close all this.

2
00:00:05.150 --> 00:00:06.360
Let me close the server.

3
00:00:06.380 --> 00:00:10.160
Go back to client and let's go to admin layout here.

4
00:00:10.580 --> 00:00:10.940
Now.

5
00:00:12.150 --> 00:00:14.380
I'm just going to go in discordant.

6
00:00:14.400 --> 00:00:18.720
Instead, we're going to make a request to back in I guess let me input excuse.

7
00:00:25.370 --> 00:00:26.030
And then here.

8
00:00:28.490 --> 00:00:31.970
And let me execute a function here and get.

9
00:00:33.390 --> 00:00:34.410
Current admin.

10
00:00:35.670 --> 00:00:37.230
And then let's write this one of you.

11
00:00:41.510 --> 00:00:45.410
One of the reason is that we can't use async here.

12
00:00:47.480 --> 00:00:48.830
I guess you can do that.

13
00:00:49.040 --> 00:00:50.240
Instead use effect.

14
00:00:51.540 --> 00:00:55.290
You could write a function like this here.

15
00:00:56.100 --> 00:00:57.690
Just execute here like that.

16
00:00:58.560 --> 00:00:59.280
You can do that.

17
00:00:59.610 --> 00:01:01.980
Oh, you can just leave it outside just to make things.

18
00:01:02.190 --> 00:01:03.960
Make your core a little bit cleaner.

19
00:01:04.410 --> 00:01:05.730
So this are what I'm going to do.

20
00:01:07.610 --> 00:01:14.450
So get current admin we use the excuse excuse will give us the response data we do structure data equal

21
00:01:14.460 --> 00:01:19.280
student wait excuse don't make a get request to

22
00:01:22.160 --> 00:01:23.210
current admin.

23
00:01:25.100 --> 00:01:25.460
All right.

24
00:01:25.460 --> 00:01:32.240
And then when we do this, we may get the response or get to prior.

25
00:01:40.400 --> 00:01:47.780
So here's what we're going to do, is we can consult on this with him again, see the data before we

26
00:01:47.780 --> 00:01:48.470
do anything here.

27
00:01:49.790 --> 00:01:55.280
Now, this function executes here in the U.S. if it I see here.

28
00:01:56.120 --> 00:01:59.180
Oh, I, too, have to do one more thing here because.

29
00:02:01.350 --> 00:02:02.100
The table.

30
00:02:02.490 --> 00:02:09.270
So current admin to get the current admin in our back and we need to make sure the health token has

31
00:02:09.270 --> 00:02:13.710
been sent to our back so you can do what you want.

32
00:02:14.130 --> 00:02:14.520
Token

33
00:02:17.580 --> 00:02:21.450
Because it might take a few milliseconds to access this value from the context.

34
00:02:21.450 --> 00:02:26.430
So you want to make sure you have access the token before you make a request.

35
00:02:26.730 --> 00:02:32.490
So you can put this as a dependency here and then come here and give it a try.

36
00:02:32.910 --> 00:02:33.570
Let's open.

37
00:02:39.300 --> 00:02:42.620
Let's try to go to actually, we can just go from.

38
00:02:42.630 --> 00:02:42.780
Yeah.

39
00:02:47.920 --> 00:02:51.870
Local has 3000 subscribers, not final.

40
00:02:51.880 --> 00:02:53.920
So obviously we don't have the software.

41
00:02:53.920 --> 00:02:55.350
Let's log in and add.

42
00:02:57.690 --> 00:02:59.390
And you can see immediately we got that.

43
00:02:59.400 --> 00:02:59.760
Okay.

44
00:03:00.990 --> 00:03:02.570
We still have the loading, but.

45
00:03:02.580 --> 00:03:02.930
Okay.

46
00:03:02.940 --> 00:03:03.290
True.

47
00:03:04.290 --> 00:03:05.040
That's beautiful.

48
00:03:06.750 --> 00:03:09.720
You can see the request has been made to our bank.

49
00:03:10.770 --> 00:03:11.160
Awesome.

50
00:03:11.340 --> 00:03:13.410
So what we can do now is.

51
00:03:14.950 --> 00:03:15.700
The same thing.

52
00:03:15.940 --> 00:03:16.210
Yeah.

53
00:03:17.270 --> 00:03:24.140
Said learning difference if he got the response that removed the cancer lockdown and let's put that

54
00:03:24.140 --> 00:03:26.330
his head lowered into policy if he'd got the data.

55
00:03:28.290 --> 00:03:31.650
If there was an error, we can just redirect the use it to.

56
00:03:32.870 --> 00:03:33.770
Some of the best.

57
00:03:35.450 --> 00:03:35.830
Okay.

58
00:03:35.840 --> 00:03:36.620
So we can do that.

59
00:03:37.920 --> 00:03:40.410
And this old school executing him.

60
00:03:41.130 --> 00:03:42.900
So we don't need this code anymore.

61
00:03:46.060 --> 00:03:50.320
I'm going to actually leave it here just for the reference for you.

62
00:03:51.100 --> 00:03:54.660
So this way you could just use your context to take.

63
00:03:55.180 --> 00:03:56.860
But now we're using.

64
00:03:58.130 --> 00:04:02.870
This API request and the response based on the response we are.

65
00:04:04.590 --> 00:04:09.740
Tending the valley of loading and with the loading it is true we show the current learning spin.

66
00:04:09.750 --> 00:04:11.100
Otherwise we saw the current.

67
00:04:12.850 --> 00:04:13.240
Okay.

68
00:04:13.960 --> 00:04:18.430
So you saw how we changed from this to this nicely.

69
00:04:20.600 --> 00:04:23.180
So now, you know.

70
00:04:23.270 --> 00:04:24.500
Course, let's try.

71
00:04:24.540 --> 00:04:25.970
We can try one more time.

72
00:04:26.660 --> 00:04:28.700
Um, local host, 2000.

73
00:04:32.580 --> 00:04:34.500
If you try to go to admin.

74
00:04:38.640 --> 00:04:40.110
You get redirect.

75
00:04:40.680 --> 00:04:41.090
All right.

76
00:04:41.110 --> 00:04:43.230
If you sign in.

77
00:04:43.830 --> 00:04:46.770
But not as an item, but like someone is.

78
00:04:52.020 --> 00:04:53.610
And if you try to go to any.

79
00:04:56.300 --> 00:04:58.100
Get redirected to home, please.

80
00:04:58.340 --> 00:05:03.080
So we have been able to secure the the admin base.

81
00:05:03.860 --> 00:05:06.590
Based on the response we got from our server.

82
00:05:07.340 --> 00:05:12.580
Now another thing I noticed here is that in our finished application I showed you earlier as well,

83
00:05:12.950 --> 00:05:22.160
if no one is logged in and they're trying to go to some protected places like admin systems, site admin,

84
00:05:22.160 --> 00:05:24.530
we have some kind of a countdown.

85
00:05:24.530 --> 00:05:26.960
So 3 to 1 and then we get redirected to.

86
00:05:28.210 --> 00:05:30.700
I will redirect that to use it to home base.

87
00:05:31.290 --> 00:05:36.300
Now, in this application, we may not have to do that because it's already working fine with this.

88
00:05:36.310 --> 00:05:36.580
Good.

89
00:05:38.340 --> 00:05:39.240
So we have this trick.

90
00:05:39.540 --> 00:05:42.930
We set the learning to true by default and.

91
00:05:45.760 --> 00:05:49.510
When we get the successful restaurants from the back end, we simply set it to false.

92
00:05:49.870 --> 00:05:51.610
When it is false, we show the content.

93
00:05:51.610 --> 00:05:56.470
When it is true, we saw the loading, so everything is working fine and we can give it a try as well.

94
00:05:56.470 --> 00:05:57.850
So if you.

95
00:05:59.430 --> 00:06:07.710
Try localhost if you try to go to admin phase without logging in.

96
00:06:09.890 --> 00:06:15.860
You get immediately redirected to useful learning for a brief millisecond and you get to interact with

97
00:06:15.860 --> 00:06:20.150
the user with several other than admin.

98
00:06:21.290 --> 00:06:26.150
I guess for example, the subscriber, if it tries to if he logs in and try to do the end.

99
00:06:28.110 --> 00:06:30.450
He gets rather exaggerates everything you would find.

100
00:06:30.450 --> 00:06:40.440
However, if there are if there is a need to have more code to redirect the users just like it did here,

101
00:06:40.440 --> 00:06:52.020
then obviously we can use the timer set set timer set interval function to countdown from 2 to 1 and

102
00:06:52.020 --> 00:06:52.830
reader the user.

103
00:06:53.070 --> 00:06:56.190
But looks like we didn't need that additional culture to go.

104
00:06:56.240 --> 00:06:58.410
Looking good, I guess.

105
00:06:58.410 --> 00:07:03.930
And now one more thing we can do here, and that is the log in screen.

106
00:07:04.260 --> 00:07:09.090
So you can see this user is currently logged in now even though it's logged in, if he has some bad

107
00:07:09.090 --> 00:07:16.170
intents and if you want to do something suspicious for whatever reason, if you want to go to sign in

108
00:07:16.170 --> 00:07:23.970
place or sign up is even after logging in by manually entering the year then he still has access to

109
00:07:23.970 --> 00:07:24.290
this one.

110
00:07:24.630 --> 00:07:29.280
And this is it doesn't have a problem, but obviously you don't want this to happen.

111
00:07:29.730 --> 00:07:34.690
So you can do some kind of a redirect by using use effect.

112
00:07:35.280 --> 00:07:36.780
So let's see how we can do that as well.

113
00:07:37.440 --> 00:07:42.810
So if we go to sign in, so here we have access to the US from the contacts.

114
00:07:43.080 --> 00:07:47.580
So based on that author, then you can use user effect and make it tick.

115
00:07:47.580 --> 00:07:52.560
So if we have the authenticate the user, then you want to redirect to some other place.

116
00:07:52.830 --> 00:07:56.910
So let's try to use it.

117
00:07:57.150 --> 00:08:03.150
We can use that hook that runs with the component months use effect.

118
00:08:08.190 --> 00:08:16.890
So here the value let's give off and here we tick if we can use for token as well.

119
00:08:16.890 --> 00:08:23.250
So if we have the token in the context, that means we have the logs news.

120
00:08:23.490 --> 00:08:23.660
All right.

121
00:08:23.670 --> 00:08:29.610
So in that case, he can run this code X wrote a push to home base.

122
00:08:30.690 --> 00:08:37.950
Okay, so with this code, we should be able to really redirect the user if we have the user in the

123
00:08:37.950 --> 00:08:38.490
context.

124
00:08:38.490 --> 00:08:45.390
But he's still trying to access the sign in for whatever reason and he can do the same code in the sign

125
00:08:45.390 --> 00:08:45.900
up as well.

126
00:08:46.290 --> 00:08:47.760
But let's give it a try first.

127
00:08:47.760 --> 00:08:52.530
So we have the logged in user, but for whatever reason if he wants to go to sign in.

128
00:08:56.230 --> 00:08:58.540
He gets redirected back to home base.

129
00:08:58.810 --> 00:09:05.440
You see that for milliseconds, but I don't think that's a problem because like I said, it's it's just

130
00:09:05.440 --> 00:09:06.270
a sign in base.

131
00:09:06.280 --> 00:09:14.150
We just want the logged in user not to go by just manually trying to type in the year, but you know,

132
00:09:14.250 --> 00:09:15.850
that shouldn't be happening anyways.

133
00:09:16.570 --> 00:09:16.930
All right.

134
00:09:16.930 --> 00:09:19.540
So this take should be good enough.

135
00:09:19.540 --> 00:09:22.990
Now, this is something you can put in, same of as well.

136
00:09:23.170 --> 00:09:25.900
So let's put that in here.

137
00:09:27.940 --> 00:09:29.380
It's simple to use effective.

138
00:09:34.760 --> 00:09:39.530
And so we got the huge effect and we have the author as well.

139
00:09:40.550 --> 00:09:42.110
So that looks good.

140
00:09:42.830 --> 00:09:43.970
Let me make sure we have.

141
00:09:43.970 --> 00:09:46.010
There are yeah, we have the.

142
00:09:47.220 --> 00:09:49.440
I told you to look for.

143
00:09:50.100 --> 00:09:51.030
Sign up as soon.

144
00:09:55.090 --> 00:09:55.450
Awesome.

145
00:09:55.810 --> 00:09:58.990
Now, if you log out, then you should still be able to go to sign in.

146
00:10:01.820 --> 00:10:04.940
And sign up, which is no problem.

147
00:10:05.750 --> 00:10:06.170
Beautiful.

148
00:10:12.260 --> 00:10:12.500
Okay.

149
00:10:12.500 --> 00:10:19.070
So we are almost, almost done with all this authentication and security and products and related stuff.

150
00:10:19.470 --> 00:10:26.660
Now, I can't wait to go to categories and finish the rest of the features that is showing the list

151
00:10:26.660 --> 00:10:30.440
of categories and allowing the admin to update and do it right.

152
00:10:30.620 --> 00:10:35.990
So once you're done with the categories, we're going to move on to post and then all this other exciting

153
00:10:35.990 --> 00:10:36.350
stuff.
