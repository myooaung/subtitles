WEBVTT
1

00:00:01.050  -->  00:00:07.020
Well everyone and welcome to the tree methods project solutions lecture part 1 in part 1 of this lecture

2

00:00:07.020  -->  00:00:11.850
video series we're going to go ahead and grab the college data and do some exploratory data analysis

3

00:00:11.850  -->  00:00:12.260
.

4

00:00:12.270  -->  00:00:14.790
Let's go ahead and jump to our studio and get started.

5

00:00:14.790  -->  00:00:22.230
All right so here we are at our studio I'm going to go ahead and call the SLR library and then check

6

00:00:22.230  -->  00:00:28.220
out the head of the college data frame.

7

00:00:28.620  -->  00:00:33.600
Again the college data frame the index here are the names of the actual colleges and then the label

8

00:00:33.600  -->  00:00:38.160
we're going to try to predict is whether or not that was a public college or university or a private

9

00:00:38.160  -->  00:00:39.480
college university.

10

00:00:39.600  -->  00:00:41.200
And then we have a bunch of features.

11

00:00:41.430  -->  00:00:47.310
We have things such as the number of applications received the number of applications accepted whether

12

00:00:47.310  -->  00:00:48.500
the new students.

13

00:00:48.540  -->  00:00:52.020
The percentage of the students that were for the top percent of their high school top 10 percent of

14

00:00:52.020  -->  00:00:57.380
high school class versus top 25 percent of high school class out of state tuition estimating them or

15

00:00:57.380  -->  00:01:02.700
a books number of Ph.D. faculty at that particular campus et cetera.

16

00:01:02.970  -->  00:01:11.680
Let's go ahead and clear this out and we'll begin by just saying DMF is college.

17

00:01:11.700  -->  00:01:17.610
Now what I mean by that is just I'm going to assign the variable data frame to college

18

00:01:20.920  -->  00:01:23.250
that way I don't have to keep writing college every time.

19

00:01:23.260  -->  00:01:25.380
Now go ahead and run this.

20

00:01:25.380  -->  00:01:25.950
OK.

21

00:01:26.100  -->  00:01:30.780
Let's go ahead and start exploring the data through some exploratory data analysis.

22

00:01:30.780  -->  00:01:38.010
Nicole G.G. plot two and the first thing I wanted you to do is create a scatterplot of Gatorade versus

23

00:01:38.010  -->  00:01:39.270
room board.

24

00:01:39.360  -->  00:01:41.460
Colored by the private column.

25

00:01:41.460  -->  00:01:46.420
Again that's basically just the room and board cost versus the graduation rate.

26

00:01:46.680  -->  00:01:52.560
Let's go ahead and call it plot passenger data frame DIA and the Ã¦sthetics.

27

00:01:52.560  -->  00:02:00.150
I'm going to go ahead and put the room board column on the X-axis and then the grad rate column on the

28

00:02:00.150  -->  00:02:04.370
y axis and this is the scatterplot we should do.

29

00:02:04.450  -->  00:02:06.030
GM underscore points

30

00:02:09.400  -->  00:02:16.490
and I want the aesthetic color for the Shawmut tree layer to be by the private column.

31

00:02:16.500  -->  00:02:19.270
Let's go ahead and check this out.

32

00:02:19.350  -->  00:02:23.280
Going to go and move this over so I can see the actual plot.

33

00:02:23.580  -->  00:02:24.810
And there it is.

34

00:02:24.810  -->  00:02:29.080
Go ahead and click zoom use graduation rate versus room and board.

35

00:02:29.100  -->  00:02:35.010
It looks like as there's maybe a slight trend you increase the room and board costs you tend to have

36

00:02:35.010  -->  00:02:36.860
a higher graduation rate.

37

00:02:36.900  -->  00:02:43.050
It also looks like as far as the coloring is concerned as you increase the room and board cost you're

38

00:02:43.230  -->  00:02:45.700
more likely to have a private school.

39

00:02:45.750  -->  00:02:47.380
So there's a lot more blue points here.

40

00:02:47.390  -->  00:02:51.180
Yes some private versus the smaller red points.

41

00:02:51.210  -->  00:02:58.920
We can go ahead and change the size of that point by just saying something like size is equal to four

42

00:02:58.920  -->  00:02:59.320
.

43

00:02:59.460  -->  00:03:04.330
Maybe that makes it a little more clear and we'll go ahead and call alpha 0.5.

44

00:03:04.410  -->  00:03:06.550
Let's see how much better that makes it.

45

00:03:06.780  -->  00:03:11.530
All right now if we click zoom we get kind of a nicer picture as far as visualizing all this.

46

00:03:11.550  -->  00:03:15.770
Now I can really see clearly that there's a lot more red points below 5000.

47

00:03:15.810  -->  00:03:21.410
Room and board price versus There's mainly just private schools above 5000 room and board price.

48

00:03:21.720  -->  00:03:22.280
OK.

49

00:03:22.410  -->  00:03:29.790
Let's go ahead and close that and move on to the next plot for this next exploratory data analysis plot

50

00:03:29.790  -->  00:03:30.110
.

51

00:03:30.180  -->  00:03:36.180
We wanted a histogram of full time undergrad students and we also wanted to color the spry the private

52

00:03:36.180  -->  00:03:43.020
column mycology plot pass and my data in this case is just DMF and the aesthetic.

53

00:03:43.020  -->  00:03:48.110
I wanted to plot out was for x f undergrad.

54

00:03:48.390  -->  00:03:57.630
So full time undergrad students and then I want to say plus GM underscore histogram and I wanted to

55

00:03:57.780  -->  00:04:06.610
put the fill go to the private column and then something I like doing with the sort of histograms setting

56

00:04:06.630  -->  00:04:08.420
the color equal to black.

57

00:04:08.440  -->  00:04:17.160
That way we get a black outline and I will go ahead and set sequel to 50 and we can even set an alpha

58

00:04:17.160  -->  00:04:23.850
value of around 0.5 and then lets go ahead and add a theme to that will do theme b w.

59

00:04:23.890  -->  00:04:26.020
So we get a nice white background.

60

00:04:26.130  -->  00:04:29.410
Go ahead and plot that out and zoom in see what we get.

61

00:04:30.060  -->  00:04:37.180
OK clearly as far as the private set go most of the schools are under 10000 students.

62

00:04:37.200  -->  00:04:43.350
In fact it looks like the vast majority of the schools are under 5000 students and something to note

63

00:04:43.350  -->  00:04:46.990
here is that these smaller schools tend to be private schools.

64

00:04:47.040  -->  00:04:52.860
And as you get larger and larger institutions or universities they tend to not be private and be public

65

00:04:52.860  -->  00:04:54.030
and that makes sense.

66

00:04:54.030  -->  00:04:59.970
Intuitively most larger schools tend to be public and most private universities tend to be smaller.

67

00:05:00.120  -->  00:05:04.380
And this is clearly shown here in the histogram data as far as a number of undergrads.

68

00:05:04.380  -->  00:05:12.460
Each of these universities Let's go ahead and move on and create a histogram of the graduation rate

69

00:05:12.470  -->  00:05:13.910
colored by private.

70

00:05:13.910  -->  00:05:14.730
This should be interesting.

71

00:05:14.750  -->  00:05:15.990
Go ahead and see.

72

00:05:16.040  -->  00:05:27.080
We'll go ahead and call it cheesy plot to frame the ascetic is going to be the rat race and we're going

73

00:05:27.080  -->  00:05:36.620
to do a histogram so-called GM underscore histogram and these Thetic is going to be Phil equals private's

74

00:05:36.860  -->  00:05:38.800
And like I mentioned before.

75

00:05:38.840  -->  00:05:43.970
I like putting in the color like for the outline.

76

00:05:44.090  -->  00:05:51.830
Let's go ahead and say bin's equals 50 again and we'll say Alpha sequel is 3.6 So it's a little lighter

77

00:05:53.210  -->  00:05:58.280
and then I'll also add the theme BW to this.

78

00:05:59.420  -->  00:06:04.520
OK let's go ahead and zoom in on this and see what we can and for it looks like most schools have a

79

00:06:04.520  -->  00:06:11.900
graduation rate above 50 percent and it looks like most schools have around somewhere between 50 and

80

00:06:11.900  -->  00:06:13.040
100 percent.

81

00:06:13.100  -->  00:06:17.870
But what's interesting here is that we actually have a data point that's above 100 percent graduation

82

00:06:17.870  -->  00:06:18.650
rate.

83

00:06:18.680  -->  00:06:23.440
We know that's wrong because you can't have more than a 100 percent of your students graduating.

84

00:06:23.450  -->  00:06:29.230
Let's go ahead and figure out what college has this graduation rate of above 100 percent.

85

00:06:29.290  -->  00:06:38.600
Want to close this and let's go ahead and say subset of the data frame and we'll see where grad rates

86

00:06:39.050  -->  00:06:40.770
greater than 100.

87

00:06:40.790  -->  00:06:45.090
And you can go ahead and use the plier library if you want to do this as well.

88

00:06:45.400  -->  00:06:51.010
If we call subset notice what we get up we get this Cazenovia college as the output.

89

00:06:51.200  -->  00:06:55.640
And this is actually just returning the entire row for that data frame if we go ahead and move this

90

00:06:55.640  -->  00:06:57.620
over to the right and do that line again.

91

00:06:57.710  -->  00:06:59.850
Might be a little more clear.

92

00:06:59.960  -->  00:07:04.860
So we see all the column values for that particular college or we're going to go ahead and do is change

93

00:07:04.880  -->  00:07:10.310
this value to from 118 percent graduation rate to 100 percent graduation rate.

94

00:07:10.340  -->  00:07:12.300
That way it actually makes sense.

95

00:07:12.440  -->  00:07:14.560
We're going to clear the council.

96

00:07:14.980  -->  00:07:16.700
We're going to call DMF

97

00:07:19.310  -->  00:07:23.420
Cazenovia college.

98

00:07:23.750  -->  00:07:25.100
That indicates the ROE.

99

00:07:25.190  -->  00:07:28.940
And I want to change the grad rate column.

100

00:07:29.330  -->  00:07:35.780
I'm passing in the index row and the column and I'm going to go ahead and change the value of that cell

101

00:07:35.900  -->  00:07:37.370
to 100.

102

00:07:37.790  -->  00:07:42.200
And you can go ahead and check out the overview data from operations in case you're a little fuzzy on

103

00:07:42.200  -->  00:07:43.780
how to do this.

104

00:07:43.960  -->  00:07:55.070
And now if we check to make sure that works we can subset E-F Radda rates greater than 100 and notice

105

00:07:55.070  -->  00:07:56.150
we don't get anything back.

106

00:07:56.150  -->  00:07:57.380
We get zero rows.

107

00:07:57.380  -->  00:08:00.570
We get all the column names but nothing actually in the rows.

108

00:08:00.590  -->  00:08:01.100
Perfect.

109

00:08:01.100  -->  00:08:05.430
Looks like we're able to successfully turn that one 18 to 100.

110

00:08:05.690  -->  00:08:10.760
Now that that's fixed let's go ahead and begin the train test on our data.

111

00:08:10.850  -->  00:08:20.630
I'm going to go ahead and go to the script and we'll go train test splits.

112

00:08:21.270  -->  00:08:25.310
We're going to call the CAA tools library.

113

00:08:25.390  -->  00:08:31.120
We're going to set the C to 101.

114

00:08:32.790  -->  00:08:38.850
And when I say sample call sample split Hopefully by now you're very familiar of this.

115

00:08:39.150  -->  00:08:43.730
And as I always say I like to pass in the column that we're going to be trying to predict.

116

00:08:44.510  -->  00:08:54.140
And then let's go ahead and indicate the split ratio to zero point seven 0 and then I would say train

117

00:08:55.520  -->  00:09:05.210
is subset data frame where the sample is equal to true and test is a subset of the data frame where

118

00:09:05.210  -->  00:09:10.490
that sample is equal to false.

119

00:09:10.490  -->  00:09:15.380
All right let's go ahead and run that source.

120

00:09:15.380  -->  00:09:16.980
Looks like it all went well.

121

00:09:17.000  -->  00:09:20.990
Now it's time to build a decision tree and I'm going to go ahead and build this decision tree just straight

122

00:09:20.990  -->  00:09:22.030
in the con..

123

00:09:22.060  -->  00:09:23.920
So it's only a few lines.

124

00:09:24.710  -->  00:09:33.230
I'm going to call the our parts library and then I'm going to go ahead and call a variable a tree.

125

00:09:33.310  -->  00:09:38.030
I'm going to call the our part function from the our part library I pass in my formula.

126

00:09:38.030  -->  00:09:44.890
Remember we're trying to predict whether a school is private or not till all the features pass and methods

127

00:09:44.900  -->  00:09:49.120
classes we're doing classification.

128

00:09:49.700  -->  00:09:53.750
And then my data source in this case is just going to be my training data because later on we're going

129

00:09:53.750  -->  00:09:56.370
to want to do predictions off of this.

130

00:09:56.390  -->  00:09:56.780
All right.

131

00:09:56.780  -->  00:09:58.640
We went ahead and built our decision tree.

132

00:09:58.910  -->  00:10:02.840
If you want you can actually check a summary of the tree if you want some information on it.

133

00:10:03.020  -->  00:10:08.950
But we're going to go ahead and try to get more intuitive information by just asking.

134

00:10:09.020  -->  00:10:15.170
Getting predictions from the model and we can go ahead and do that by using the SO predict we say tree

135

00:10:17.190  -->  00:10:23.270
reds for tree predictions number we call it predict function in our model.

136

00:10:23.270  -->  00:10:24.830
In this case it's tree.

137

00:10:24.830  -->  00:10:27.960
And then we pass in our test set.

138

00:10:28.460  -->  00:10:33.350
Now that we have the predictions let's go ahead and check the head of these predictions just to see

139

00:10:33.350  -->  00:10:35.650
what format this is in.

140

00:10:35.750  -->  00:10:44.420
If I check head of tree creds notice I get back probabilities and basically these numbers represent

141

00:10:44.510  -->  00:10:49.440
the probability that the model is sure that it's us versus no.

142

00:10:49.460  -->  00:10:55.140
In this case it's ninety nine point six six eight seven percent sure that Adrian college.

143

00:10:55.160  -->  00:11:02.150
Yes it's a private school and it's believed that the probability of it being no is point 3 3 percent

144

00:11:02.160  -->  00:11:02.450
.

145

00:11:02.720  -->  00:11:08.480
Well we're going to do in order to actually create a table of a confusion matrix is turned these two

146

00:11:08.480  -->  00:11:14.900
columns into one column to match the original yes or no label for the private column.

147

00:11:14.900  -->  00:11:17.890
Let's go ahead and show you how to do that.

148

00:11:17.960  -->  00:11:21.190
We're going to go ahead and do is create a function to do this.

149

00:11:21.230  -->  00:11:28.620
I'm going to go ahead and paste the model building lines and the predicate lines right here.

150

00:11:28.820  -->  00:11:35.010
We'll call this train model with this console that a little bit.

151

00:11:35.050  -->  00:11:41.030
So after we train the model we're going to go ahead and do is fix this tree spreads so that it matches

152

00:11:41.120  -->  00:11:46.670
what the private column looked like instead of two columns were going to change to one column.

153

00:11:46.670  -->  00:11:51.740
There's lots of ways to do this but I'm going to go ahead and do just a simple apply function method

154

00:11:53.220  -->  00:11:55.000
and then I say tree spreads.

155

00:11:55.040  -->  00:12:01.730
Make sure it's a data frame so say as thought a frame and pasand tree spreads that way I can work with

156

00:12:01.730  -->  00:12:03.100
it.

157

00:12:04.880  -->  00:12:10.230
And then I'm going to create a function call a joiner and what joiner's going to do is it's just going

158

00:12:10.340  -->  00:12:20.330
to join those two columns the no and yes columns is going to take in an x value and it's going to say

159

00:12:20.420  -->  00:12:24.080
if x is greater than or equal to or 0.5

160

00:12:26.700  -->  00:12:36.810
return Yes else we're going to say return no.

161

00:12:37.070  -->  00:12:42.500
And basically what this means is we are going to apply this to the yes column of the tree predict that

162

00:12:42.500  -->  00:12:44.320
function.

163

00:12:45.530  -->  00:12:48.420
Let's go ahead and see if this works.

164

00:12:48.560  -->  00:12:59.720
And when I say tree threads create a new column called private's and I'm going to apply it to the tree

165

00:12:59.750  -->  00:13:08.960
that spreads yes column and then passing the join or function and then we're going to go ahead and make

166

00:13:08.960  -->  00:13:14.070
sure that's all worked by printing the head of tree spreads.

167

00:13:14.120  -->  00:13:16.850
Let's run this and hope that it all works.

168

00:13:17.720  -->  00:13:18.510
OK.

169

00:13:18.530  -->  00:13:20.030
Bye push up the console a bit.

170

00:13:20.210  -->  00:13:22.880
Look we have here we have the original.

171

00:13:22.910  -->  00:13:29.900
No one yes probability columns but by applying joiner we can convert these two columns to a single column

172

00:13:29.940  -->  00:13:30.370
.

173

00:13:30.390  -->  00:13:32.020
Private yes or no.

174

00:13:32.360  -->  00:13:37.670
And I did that by creating this joiner column and this joiner column is only going to be applied to

175

00:13:37.730  -->  00:13:42.950
the yes column and that's how it's working which is why I was able to just check for greater than or

176

00:13:42.950  -->  00:13:46.050
equal to 0.5 for this one column.

177

00:13:46.370  -->  00:13:50.840
If this column is not 0.5 or greater we went ahead and just said it's going to be.

178

00:13:50.840  -->  00:13:54.130
No it's not a private college or university.

179

00:13:54.230  -->  00:14:00.350
Now that we have that let's go ahead and use table we can do this in the council to actually create

180

00:14:00.350  -->  00:14:08.130
the confusion matrix we'll call a tree that Pretz say it's private and then I'm going to say test a

181

00:14:08.130  -->  00:14:10.280
private.

182

00:14:11.390  -->  00:14:12.640
Go ahead and run it.

183

00:14:12.870  -->  00:14:14.650
And it looks like we did it too bad.

184

00:14:14.650  -->  00:14:22.100
Here again it depends on if you're measuring the high costs of recall or precision accuracy and what's

185

00:14:22.100  -->  00:14:24.710
the best way to evaluate your model.

186

00:14:24.710  -->  00:14:28.280
A lot of times people just look at the accuracy of this sort of classification models but it's always

187

00:14:28.280  -->  00:14:35.510
important to check out your rates of false positives false negatives etc. to really adjust and adapt

188

00:14:35.510  -->  00:14:38.140
to what your model is trying to predict.

189

00:14:38.150  -->  00:14:44.360
Let's go ahead and try to plot out the decision tree just so we can interpret it intuitively I'm going

190

00:14:44.360  -->  00:14:49.560
to go ahead and clear the console going to call the library.

191

00:14:49.580  -->  00:14:53.050
The our heart our parts the plot library.

192

00:14:53.480  -->  00:14:57.480
And that way I can just call the pure P function on my tree.

193

00:14:57.980  -->  00:15:01.430
And this makes it really easy to see that tree when you go and zoom in.

194

00:15:01.730  -->  00:15:08.060
And if we take a look at what the tree ended up doing it set the root node as the undergraduate student

195

00:15:08.060  -->  00:15:08.670
amount.

196

00:15:08.690  -->  00:15:14.360
So the full time undergrads is a good predictor of whether or not you're in a private or public college

197

00:15:14.360  -->  00:15:14.380
.

198

00:15:14.390  -->  00:15:19.550
And it set the cutoff at 3000 if you remember back to we were looking at the histogram that kind of

199

00:15:19.550  -->  00:15:24.710
makes sense because a lot of those smaller colleges were most likely to be private then it split on

200

00:15:24.710  -->  00:15:31.310
the out of state tuition which makes a lot of sense because public colleges will have much higher out-of-state

201

00:15:31.310  -->  00:15:36.800
tuition versus in-state tuitions versus private colleges are probably going to have really similar out-of-state

202

00:15:36.800  -->  00:15:38.160
or in-state tuition.

203

00:15:38.210  -->  00:15:39.720
So that also makes sense.

204

00:15:39.800  -->  00:15:44.890
And then you can keep on seeing what other branches and leaves the decision tree had.

205

00:15:44.900  -->  00:15:49.130
Again this is just really cool because you can just call pure on the tree and you get this nice visualization

206

00:15:49.130  -->  00:15:53.600
out of it and it's a lot more intuitive to interpret this decision tree.

207

00:15:53.670  -->  00:15:55.730
Grath OK.

208

00:15:55.850  -->  00:15:57.980
That's it for one of the solutions.

209

00:15:57.980  -->  00:16:01.460
In part two we'll go ahead and check out how to do the same analysis.

210

00:16:01.470  -->  00:16:08.330
But if a random force model just does a quick review of what we did we went ahead and set the college

211

00:16:08.330  -->  00:16:12.670
state of frame or data set from the iso library to death.

212

00:16:12.770  -->  00:16:17.520
We did a train test split after playing around G-G plot two and exploring the data.

213

00:16:17.540  -->  00:16:24.560
We also had to make sure that we when we were trained the model we checked out the predictions by using

214

00:16:24.560  -->  00:16:31.310
this joiner function in order to actually match up the prediction column to the prediction column and

215

00:16:31.310  -->  00:16:32.760
the test data.

216

00:16:33.320  -->  00:16:37.640
All right but those are useful to you and I hope you had fun while you were attempting on your own to

217

00:16:37.640  -->  00:16:39.610
do the project exercise.

218

00:16:39.620  -->  00:16:41.320
I will see you at the next lecture
