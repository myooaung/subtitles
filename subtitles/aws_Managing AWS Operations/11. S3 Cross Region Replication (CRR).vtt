WEBVTT
1
00:00:00.920 --> 00:00:01.890
[Autogenerated] Okay, Welcome back.

2
00:00:01.890 --> 00:00:05.760
Now, we just got done discussing s three lifecycle rules,

3
00:00:05.760 --> 00:00:09.660
and in this clip, we're going to start diving into cross region replication.

4
00:00:09.660 --> 00:00:09.870
Now,

5
00:00:09.870 --> 00:00:14.540
cross region replication is a built in S three service that allows us

6
00:00:14.540 --> 00:00:18.310
to replicate objects between different AWS regions.

7
00:00:18.310 --> 00:00:20.630
So this could help us meet compliance requirements

8
00:00:20.630 --> 00:00:22.640
or even just back up standards.

9
00:00:22.640 --> 00:00:24.290
So let's go ahead and get started.

10
00:00:24.290 --> 00:00:28.110
We have our demo one bucket here and I'm gonna create a new buckets.

11
00:00:28.110 --> 00:00:31.020
Let me click on Create Bucket and I'm gonna enter a name.

12
00:00:31.020 --> 00:00:34.600
So it's gonna be the same all the way up to the last piece of it as to

13
00:00:34.600 --> 00:00:38.140
where I say dash CR are for cross region replication.

14
00:00:38.140 --> 00:00:42.240
Now the other buckets are in the US west to region, which is Oregon.

15
00:00:42.240 --> 00:00:45.730
So let's make this one in Ohio, and I'm gonna click on next,

16
00:00:45.730 --> 00:00:48.730
and what I'm going to do is I'm going to leave all of the defaults,

17
00:00:48.730 --> 00:00:52.260
so I'm gonna click on next through here all the way until create bucket.

18
00:00:52.260 --> 00:00:54.580
So let me create this new bucket and there we go.

19
00:00:54.580 --> 00:00:58.860
We now have our US West to Bucket Demo Dash one and then we

20
00:00:58.860 --> 00:01:02.840
have our US East to bucket demo dash cr r.

21
00:01:02.840 --> 00:01:04.160
So let's go and set this up.

22
00:01:04.160 --> 00:01:08.540
I'm gonna open up my demo One bucket and under the management pain here,

23
00:01:08.540 --> 00:01:11.040
there's a replication tab so you can see we don't

24
00:01:11.040 --> 00:01:12.670
have any rules for this bucket.

25
00:01:12.670 --> 00:01:13.910
So let's go ahead and add one.

26
00:01:13.910 --> 00:01:17.190
I'm gonna add a rule and you can see we set our source.

27
00:01:17.190 --> 00:01:19.300
Now we can either select the entire bucket.

28
00:01:19.300 --> 00:01:23.150
So all objects within the bucket or a new updated feature is we

29
00:01:23.150 --> 00:01:26.780
can specify either a prefix or a tag filter.

30
00:01:26.780 --> 00:01:29.510
So if we only want to back up certain objects that have a

31
00:01:29.510 --> 00:01:34.420
certain prefix or maybe a specific tag, we can do that for this demo.

32
00:01:34.420 --> 00:01:36.850
Let's go into the entire bucket and then you can see

33
00:01:36.850 --> 00:01:39.070
that we can set replication criteria.

34
00:01:39.070 --> 00:01:43.310
So do we want to replicate objects encrypted with a W S K.

35
00:01:43.310 --> 00:01:44.120
M s.

36
00:01:44.120 --> 00:01:45.620
So I'm gonna go and select Yes,

37
00:01:45.620 --> 00:01:48.510
because we have default encryption set up on that bucket.

38
00:01:48.510 --> 00:01:51.720
If you recall and you can see we have four keys selected.

39
00:01:51.720 --> 00:01:55.120
So it's selecting all of the keys that we have within

40
00:01:55.120 --> 00:01:56.660
our region here in this account.

41
00:01:56.660 --> 00:01:58.840
So we have four that are used.

42
00:01:58.840 --> 00:02:00.360
So I'm gonna leave that enabled.

43
00:02:00.360 --> 00:02:02.150
And then I'm gonna click on next,

44
00:02:02.150 --> 00:02:04.730
and you can see we now set our destination bucket.

45
00:02:04.730 --> 00:02:08.480
So let me open this up and I'm gonna go and filter out based on plural.

46
00:02:08.480 --> 00:02:09.320
OK, there we go.

47
00:02:09.320 --> 00:02:11.790
We see our demo dash cr our bucket.

48
00:02:11.790 --> 00:02:13.160
Now, if you recall,

49
00:02:13.160 --> 00:02:17.840
we also had a demo bucket in the same region as our demo one bucket.

50
00:02:17.840 --> 00:02:20.260
But because that's not in a different region,

51
00:02:20.260 --> 00:02:24.040
it's not going to show up in this cross region replication set up.

52
00:02:24.040 --> 00:02:26.370
So it's a semi smart filter,

53
00:02:26.370 --> 00:02:29.600
so it may select this cross region replication bucket and

54
00:02:29.600 --> 00:02:31.720
you can see we actually get an error.

55
00:02:31.720 --> 00:02:35.740
And this is because our target bucket does not have version ing enabled,

56
00:02:35.740 --> 00:02:39.890
and cross region replication requires that version ing has turned on.

57
00:02:39.890 --> 00:02:42.520
Now understand this means for both buckets,

58
00:02:42.520 --> 00:02:46.940
so the source and the destination are required to have version ing enabled.

59
00:02:46.940 --> 00:02:49.080
So I'm gonna go and let s three enable it on this

60
00:02:49.080 --> 00:02:51.270
bucket here and let's continue on.

61
00:02:51.270 --> 00:02:54.580
The next thing we can do is set the destination encryption settings.

62
00:02:54.580 --> 00:02:59.260
So I'm gonna go in select the standard A W s s three kms key.

63
00:02:59.260 --> 00:03:02.940
And that means that all destination objects are going to be encrypted with

64
00:03:02.940 --> 00:03:06.210
this key I d and then at the bottom here we have options.

65
00:03:06.210 --> 00:03:10.730
So if we wanted to, we could change the storage class for the replicated objects,

66
00:03:10.730 --> 00:03:13.970
which means we can take it from a standard storage which they are to.

67
00:03:13.970 --> 00:03:18.510
Maybe we want to make it standard, infrequently accessed or just any other type.

68
00:03:18.510 --> 00:03:22.170
Maybe we want to make it a glacier archive storage class.

69
00:03:22.170 --> 00:03:24.160
Now for this demo, we're not going to select this,

70
00:03:24.160 --> 00:03:25.850
but it's good to know that you can do it.

71
00:03:25.850 --> 00:03:28.570
And the next thing we see is change object ownership

72
00:03:28.570 --> 00:03:30.640
to the destination bucket owner.

73
00:03:30.640 --> 00:03:34.150
And what this means is that if we were going to enable

74
00:03:34.150 --> 00:03:38.240
cross account cross region replication, which is possible,

75
00:03:38.240 --> 00:03:42.550
we would change all objects automatically using s three to be

76
00:03:42.550 --> 00:03:45.410
owned by the destination bucket account.

77
00:03:45.410 --> 00:03:48.740
So even though we owned the objects in our account as soon as they're

78
00:03:48.740 --> 00:03:52.510
replicated to the other region and other AWS account,

79
00:03:52.510 --> 00:03:56.260
that destination account is now going to own those objects,

80
00:03:56.260 --> 00:03:58.030
so that's a pretty cool little feature.

81
00:03:58.030 --> 00:04:00.400
I'm gonna un select this because it's obviously our own

82
00:04:00.400 --> 00:04:02.430
bucket and I'm gonna click on next.

83
00:04:02.430 --> 00:04:05.310
And now you can see we select our I am role.

84
00:04:05.310 --> 00:04:10.630
So this role will need the proper permissions to perform s three related tasks.

85
00:04:10.630 --> 00:04:10.890
Now,

86
00:04:10.890 --> 00:04:16.150
I made one called Allow Underscore CRR and this one essentially as Amazon s

87
00:04:16.150 --> 00:04:19.510
three full access so I could do anything that it needs.

88
00:04:19.510 --> 00:04:23.080
The next thing in line is we give our ruling name and this can not be empty.

89
00:04:23.080 --> 00:04:27.170
So let me go and give this a name of CRR Dash demo and then you can see

90
00:04:27.170 --> 00:04:31.210
underneath that we can either enable or disable this upon creation.

91
00:04:31.210 --> 00:04:32.490
We'll leave it enabled.

92
00:04:32.490 --> 00:04:35.110
I'll click on next and then we get a review.

93
00:04:35.110 --> 00:04:38.230
We see our source bucket here, which includes the bucket name,

94
00:04:38.230 --> 00:04:39.830
the scope in the region.

95
00:04:39.830 --> 00:04:42.300
We see our destination configuration here,

96
00:04:42.300 --> 00:04:43.330
which is saying, Hey,

97
00:04:43.330 --> 00:04:47.080
you're replicating to this destination bucket in this region using

98
00:04:47.080 --> 00:04:51.420
the same storage class as well as replicating objects that were

99
00:04:51.420 --> 00:04:53.330
already encrypted and then at the bottom.

100
00:04:53.330 --> 00:04:54.480
We have our options.

101
00:04:54.480 --> 00:04:59.440
So the role that we selected the name, our priority and then our status.

102
00:04:59.440 --> 00:05:01.330
So let me go and click on Save here,

103
00:05:01.330 --> 00:05:04.070
and that's gonna create our replication rule.

104
00:05:04.070 --> 00:05:04.890
And there we go.

105
00:05:04.890 --> 00:05:08.600
So let me scroll up a little bit and we can see everything now on one page.

106
00:05:08.600 --> 00:05:11.010
So we see our global settings here that we can add it,

107
00:05:11.010 --> 00:05:14.020
which have our source destination and permissions.

108
00:05:14.020 --> 00:05:15.110
And then we see a list.

109
00:05:15.110 --> 00:05:18.630
With our one rule in place, we see the name scope,

110
00:05:18.630 --> 00:05:20.040
the object owner,

111
00:05:20.040 --> 00:05:24.270
all the different settings that go along with configuring this replication rule.

112
00:05:24.270 --> 00:05:28.780
Now, a little tidbit to keep in mind is you can actually prioritize your rules.

113
00:05:28.780 --> 00:05:32.670
So this means if you have one rule that you for sure want to get done first,

114
00:05:32.670 --> 00:05:37.140
you can set the priority to one, and it's gonna get executed before any others.

115
00:05:37.140 --> 00:05:40.270
So now that we have this rule in place, let's go and test it out.

116
00:05:40.270 --> 00:05:44.240
I'm gonna go back to s three here and let me upload an object to our bucket.

117
00:05:44.240 --> 00:05:52.740
So let me click on upload, and I'm going to select a few files.

118
00:05:52.740 --> 00:05:54.530
Okay, so I've uploaded a few files.

119
00:05:54.530 --> 00:05:57.080
You can see we have to yamma files here,

120
00:05:57.080 --> 00:06:00.480
and let's actually go check out our destination bucket and look at that.

121
00:06:00.480 --> 00:06:04.330
They're already replicated to that cross region replication bucket,

122
00:06:04.330 --> 00:06:06.440
so that only took a couple of seconds.

123
00:06:06.440 --> 00:06:11.850
Now Amazon does specify that it can take up to 15 minutes and in rare cases,

124
00:06:11.850 --> 00:06:13.540
even a couple of hours.

125
00:06:13.540 --> 00:06:17.280
And they say this is going to be dependent upon the size and the

126
00:06:17.280 --> 00:06:19.810
number of objects that are being replicated.

127
00:06:19.810 --> 00:06:22.350
So do not panic if it does not immediately get

128
00:06:22.350 --> 00:06:24.740
replicated to your destination bucket.

129
00:06:24.740 --> 00:06:28.070
Now that's going to do it for this clip on cross region replication.

130
00:06:28.070 --> 00:06:35.000
We're going to go and wrap it up and I'll see you in the next one. We're going to start diving into storage metrics.

