1
00:00:00,740 --> 00:00:02,020
[Autogenerated] Okay, welcome back.

2
00:00:02,020 --> 00:00:05,350
So let's talk about hybrid activations.

3
00:00:05,350 --> 00:00:11,910
So what this capability does is that it allows us to set up

4
00:00:11,910 --> 00:00:15,040
servers and V EMS in a hybrid environment,

5
00:00:15,040 --> 00:00:18,440
which is very common in enterprise environments.

6
00:00:18,440 --> 00:00:22,710
And we can actually set up our instances or should say,

7
00:00:22,710 --> 00:00:23,210
RV,

8
00:00:23,210 --> 00:00:32,020
EMS and servers that we have on premise as managed instances reachable from AWS.

9
00:00:32,020 --> 00:00:35,840
So what we would do here is we can create an activation.

10
00:00:35,840 --> 00:00:38,040
We can give it a description.

11
00:00:38,040 --> 00:00:41,490
The total number of servers that we want to register.

12
00:00:41,490 --> 00:00:46,120
You can see the max is 1000 but that's changeable if

13
00:00:46,120 --> 00:00:49,440
we go ahead and change are setting, but this will incur some costs.

14
00:00:49,440 --> 00:00:51,040
So keep that in mind.

15
00:00:51,040 --> 00:00:54,960
The next thing we do is we specify a role that allows us

16
00:00:54,960 --> 00:01:02,550
to create those managed instances, and we can set an activation expiry date.

17
00:01:02,550 --> 00:01:06,090
So if we wanted to expire activations at a certain time,

18
00:01:06,090 --> 00:01:08,950
we could do that to verify that no one else will

19
00:01:08,950 --> 00:01:12,010
activate after that point in time.

20
00:01:12,010 --> 00:01:17,140
And then finally, we can also specify a default instance name.

21
00:01:17,140 --> 00:01:18,320
So if required,

22
00:01:18,320 --> 00:01:21,930
weaken set that I'll leave it blank since it's optional and

23
00:01:21,930 --> 00:01:25,220
then what I would do is I click create activation and this

24
00:01:25,220 --> 00:01:27,560
gives us an activation I d.

25
00:01:27,560 --> 00:01:32,780
So if you look at the top AWS provides a temporary output,

26
00:01:32,780 --> 00:01:37,020
it gives us an activation code, and then it gives us an activation.

27
00:01:37,020 --> 00:01:42,950
I d Now how we would use these is we would install the s s M agent

28
00:01:42,950 --> 00:01:46,640
on our virtual machines or on premise servers.

29
00:01:46,640 --> 00:01:52,240
And then we would run through the install command, which will look at here.

30
00:01:52,240 --> 00:01:57,530
And we provide that information as we're configuring r s

31
00:01:57,530 --> 00:02:01,680
s m agent on our hybrid instances.

32
00:02:01,680 --> 00:02:05,700
So if I go here and I go to manually install this is where we can

33
00:02:05,700 --> 00:02:10,000
actually go through and you can see we install the rpm,

34
00:02:10,000 --> 00:02:11,980
we start it, etcetera.

35
00:02:11,980 --> 00:02:13,880
So this is easy, because this is E.

36
00:02:13,880 --> 00:02:14,100
C.

37
00:02:14,100 --> 00:02:14,940
Two.

38
00:02:14,940 --> 00:02:17,360
But how it differs is that E.

39
00:02:17,360 --> 00:02:22,480
C two uses roles for permission in our on premise hybrid would

40
00:02:22,480 --> 00:02:26,860
use these activation code and I ds in order to essentially

41
00:02:26,860 --> 00:02:30,030
authenticate with systems manager and say,

42
00:02:30,030 --> 00:02:32,460
Hey, I know the secret password.

43
00:02:32,460 --> 00:02:36,340
So go ahead and add me to your managed instance groups,

44
00:02:36,340 --> 00:02:40,190
and then you can start running, run commands and automation is on me.

45
00:02:40,190 --> 00:02:42,540
So if I view the details here,

46
00:02:42,540 --> 00:02:45,560
you can see if we had registered instances with that,

47
00:02:45,560 --> 00:02:46,270
I d.

48
00:02:46,270 --> 00:02:48,220
They would show the number here.

49
00:02:48,220 --> 00:02:48,380
Now,

50
00:02:48,380 --> 00:02:50,570
I'm not going to do that because that's a little bit more

51
00:02:50,570 --> 00:02:52,740
in depth in this course will cover.

52
00:02:52,740 --> 00:02:57,740
But the documents provided do a great job of walking you through installing

53
00:02:57,740 --> 00:03:01,770
this agent and setting it up for hybrid environments.

54
00:03:01,770 --> 00:03:02,520
You can see they have,

55
00:03:02,520 --> 00:03:06,320
ah hybrid environment section here with all of the steps

56
00:03:06,320 --> 00:03:09,140
that are required for setting that up.

57
00:03:09,140 --> 00:03:11,950
So if this is something you need for your environment,

58
00:03:11,950 --> 00:03:15,540
be sure to check this out and walk through these steps.

59
00:03:15,540 --> 00:03:17,360
So let me go and close that.

60
00:03:17,360 --> 00:03:21,110
And the next thing I want to talk about is session manager.

61
00:03:21,110 --> 00:03:24,140
So this is an awesome capability.

62
00:03:24,140 --> 00:03:24,650
Honestly,

63
00:03:24,650 --> 00:03:29,400
One of the top capabilities offered by Systems manager session

64
00:03:29,400 --> 00:03:34,900
manager allows us to connect to our Windows and Linux instances

65
00:03:34,900 --> 00:03:39,530
via an agent as opposed to RTP or ssh.

66
00:03:39,530 --> 00:03:44,310
So it eliminates the need for a jump server or a bastion host.

67
00:03:44,310 --> 00:03:50,060
So this is really cool, and it's a very big positive for security posture,

68
00:03:50,060 --> 00:03:51,600
improvement in.

69
00:03:51,600 --> 00:03:54,840
A lot of security teams love using this.

70
00:03:54,840 --> 00:03:58,920
So for a quick start guide, I would click on start session.

71
00:03:58,920 --> 00:04:03,890
You would select the instance that you want to connect to I would start it.

72
00:04:03,890 --> 00:04:09,140
And what this is doing is it's loading a connection via the agent in my consul.

73
00:04:09,140 --> 00:04:09,730
There you go.

74
00:04:09,730 --> 00:04:12,180
You can see my session idea at the top.

75
00:04:12,180 --> 00:04:15,950
The instance were connected to and then I get a prompt.

76
00:04:15,950 --> 00:04:20,560
So now I'm in that instance within, Easy to.

77
00:04:20,560 --> 00:04:22,370
And I connected via an agent.

78
00:04:22,370 --> 00:04:24,700
I didn't have to ssh in.

79
00:04:24,700 --> 00:04:25,790
So let's go ahead.

80
00:04:25,790 --> 00:04:31,210
And I want to curl that metadata your l That's local on instances

81
00:04:31,210 --> 00:04:34,140
and you'll see that we get the instance I d.

82
00:04:34,140 --> 00:04:35,420
Right here.

83
00:04:35,420 --> 00:04:38,880
That matches the instance I d in the consul.

84
00:04:38,880 --> 00:04:42,850
So we verify they were connected to that instance and

85
00:04:42,850 --> 00:04:46,100
we did it using the s s M agent.

86
00:04:46,100 --> 00:04:49,680
So now if I go in here, I go into a bar log.

87
00:04:49,680 --> 00:04:52,810
If I list Amazon here, there's an s s M directory.

88
00:04:52,810 --> 00:05:01,640
So if I go into S S m, we can actually view our agent log within this directory.

89
00:05:01,640 --> 00:05:06,460
So let me go ahead and actually tail this log and you can see

90
00:05:06,460 --> 00:05:11,340
right there s SM session worker and it shows our session I d right

91
00:05:11,340 --> 00:05:15,630
there and then how it's connected in all of the errors that come

92
00:05:15,630 --> 00:05:17,710
from some of the connections.

93
00:05:17,710 --> 00:05:21,030
Now, also, to build on this as a Sino,

94
00:05:21,030 --> 00:05:25,840
you can see that we also had an association come through,

95
00:05:25,840 --> 00:05:29,890
and it's saying that the next one will occur at this particular time.

96
00:05:29,890 --> 00:05:35,340
So this relates to that inventory association that we looked at previously.

97
00:05:35,340 --> 00:05:37,270
So let's go ahead and wrap up this.

98
00:05:37,270 --> 00:05:40,480
I'll terminate our session on click.

99
00:05:40,480 --> 00:05:40,800
Yep.

100
00:05:40,800 --> 00:05:45,000
Terminate And then let's just look at our session history.

101
00:05:45,000 --> 00:05:46,140
There you go.

102
00:05:46,140 --> 00:05:48,540
We see our unique session I d.

103
00:05:48,540 --> 00:05:53,480
Whoever did it So my role that I assumed what instance it was when it

104
00:05:53,480 --> 00:05:57,940
started when it ended and what status it's in now,

105
00:05:57,940 --> 00:06:01,040
Quickly, let's just look at preferences.

106
00:06:01,040 --> 00:06:04,290
And this is where we can edit our preferences for default

107
00:06:04,290 --> 00:06:09,360
sessions so we can use the default and use the credentials of

108
00:06:09,360 --> 00:06:14,280
the s S M user on the instance, which is what we saw in that log.

109
00:06:14,280 --> 00:06:20,180
Or we can enable run as support and specify a user or role to use

110
00:06:20,180 --> 00:06:24,040
with a user name within our operating system.

111
00:06:24,040 --> 00:06:28,280
We can also enable kms encryption for our session data.

112
00:06:28,280 --> 00:06:33,230
So any data transmitted between us and the instance would be encrypted.

113
00:06:33,230 --> 00:06:41,060
With a kms key, we can write our session output toe s three.

114
00:06:41,060 --> 00:06:45,740
Now, this is why I hadn't aired because I didn't have a bucket set up for this.

115
00:06:45,740 --> 00:06:49,920
But we could output log files to say, Hey, who was doing what?

116
00:06:49,920 --> 00:06:51,820
And what time were they doing it?

117
00:06:51,820 --> 00:06:56,540
And they could be stored in a centralized security bucket for auditing Later on,

118
00:06:56,540 --> 00:07:02,250
we could encrypt it as well, and we can give it a prefix specific to our needs.

119
00:07:02,250 --> 00:07:05,890
Now, the last tidbit here I want to touch on is the cloudwatch logs.

120
00:07:05,890 --> 00:07:11,580
And this allows us to push log data to cloudwatch in order to

121
00:07:11,580 --> 00:07:15,340
collect logs as if they were normal application logs.

122
00:07:15,340 --> 00:07:19,240
Which makes sense because it's a connection like ssh.

123
00:07:19,240 --> 00:07:24,120
And we can log that data in either set metric filters on them or just

124
00:07:24,120 --> 00:07:27,870
export them for auditing and collection Later on,

125
00:07:27,870 --> 00:07:31,440
Let me go ahead and cancel, and that will wrap it up for session.

126
00:07:31,440 --> 00:07:33,820
Manager and let's move on to run.

127
00:07:33,820 --> 00:07:39,600
Come in Now run command allows us to perform remote commands on

128
00:07:39,600 --> 00:07:44,490
servers with a click of a button from Systems Manager.

129
00:07:44,490 --> 00:07:46,330
So let's just demo this out.

130
00:07:46,330 --> 00:07:50,570
I click on Run a command and we get a list of command documents now.

131
00:07:50,570 --> 00:07:53,010
We'll talk about documents later on.

132
00:07:53,010 --> 00:07:56,330
These are very important to understand how they work,

133
00:07:56,330 --> 00:07:58,040
but I already know what I want to do.

134
00:07:58,040 --> 00:08:04,750
So let me find this run Shell script document will use the default version,

135
00:08:04,750 --> 00:08:08,650
and then what this is doing is it's running a shell script

136
00:08:08,650 --> 00:08:11,580
or command on our targeted instance.

137
00:08:11,580 --> 00:08:12,880
So let's test this out.

138
00:08:12,880 --> 00:08:16,780
If I go ahead and I specify a shell script here,

139
00:08:16,780 --> 00:08:21,530
let me go ahead and echo a value into a temporary file,

140
00:08:21,530 --> 00:08:23,520
and then we'll verify that worked.

141
00:08:23,520 --> 00:08:26,760
All right, so I'm just simply echoing, Hello, plural site.

142
00:08:26,760 --> 00:08:31,240
Peeps toe a temporary file in temp, and it's called success.

143
00:08:31,240 --> 00:08:31,460
Now.

144
00:08:31,460 --> 00:08:34,680
If we wanted to, I could specify a working directory.

145
00:08:34,680 --> 00:08:37,440
So where do we want to start working from?

146
00:08:37,440 --> 00:08:41,330
We specify a time out, so a one hour to fall,

147
00:08:41,330 --> 00:08:44,940
but you can go all the way up to 48 hours.

148
00:08:44,940 --> 00:08:49,340
And then we specify our targets so we can go buy tags

149
00:08:49,340 --> 00:08:52,570
we can do manually or once again.

150
00:08:52,570 --> 00:08:54,950
Hopefully you're starting to see the pattern here.

151
00:08:54,950 --> 00:09:00,470
We can choose a resource group so I could perform this command on our prod

152
00:09:00,470 --> 00:09:05,900
Resource group and specify what kind of resource it ISS.

153
00:09:05,900 --> 00:09:08,020
Now, I'm gonna go ahead and do manually,

154
00:09:08,020 --> 00:09:10,130
just so this doesn't mess up because I haven't gone

155
00:09:10,130 --> 00:09:12,590
back and cleaned up some of my mess.

156
00:09:12,590 --> 00:09:17,350
But normally you would want to do resource groups or tags based on your needs.

157
00:09:17,350 --> 00:09:22,400
So you might do development based servers than test based servers and then,

158
00:09:22,400 --> 00:09:24,040
finally, production.

159
00:09:24,040 --> 00:09:25,840
That's a general work flow.

160
00:09:25,840 --> 00:09:31,610
So I select my instance, I can give a comment and a time out for the command.

161
00:09:31,610 --> 00:09:37,400
I can set a rate control so I can specify either a static target or a

162
00:09:37,400 --> 00:09:42,400
percentage for both concurrency and air thresholds.

163
00:09:42,400 --> 00:09:46,500
And then we configure our output actions so we can write thes

164
00:09:46,500 --> 00:09:50,640
toe S three for logging and tracking purposes.

165
00:09:50,640 --> 00:09:52,420
So that way we can view it later.

166
00:09:52,420 --> 00:09:54,540
Now, I'm gonna skip this step,

167
00:09:54,540 --> 00:09:58,140
but it's important to know that you can actually do this.

168
00:09:58,140 --> 00:10:00,690
We can also send it to cloudwatch logs,

169
00:10:00,690 --> 00:10:03,010
which is similar to what we just looked at.

170
00:10:03,010 --> 00:10:06,120
So I could specify a log group toe output.

171
00:10:06,120 --> 00:10:07,980
These log files, too.

172
00:10:07,980 --> 00:10:12,740
I can configure our SMS notifications to give me status is on what's

173
00:10:12,740 --> 00:10:17,090
going on and then here at the bottom that give you a seal I shortcut

174
00:10:17,090 --> 00:10:19,390
that you can copy and paste once again.

175
00:10:19,390 --> 00:10:22,840
This is a often overlooked thing, and it's pretty cool.

176
00:10:22,840 --> 00:10:26,110
So I'll click on Run and I actually left this enabled.

177
00:10:26,110 --> 00:10:28,940
Sorry, let me go ahead and de Select that.

178
00:10:28,940 --> 00:10:31,260
I'll click on Run and there we go.

179
00:10:31,260 --> 00:10:36,720
So now it's in progress and what I'll do is I'll were fresh and there we go.

180
00:10:36,720 --> 00:10:38,200
That was pretty quick.

181
00:10:38,200 --> 00:10:40,710
So you can see we targeted our instance.

182
00:10:40,710 --> 00:10:42,540
It was successful.

183
00:10:42,540 --> 00:10:45,340
We see our description and parameters.

184
00:10:45,340 --> 00:10:51,020
And if I click on my instance here, it brings us to a details for that I d.

185
00:10:51,020 --> 00:10:52,860
Of that execution now.

186
00:10:52,860 --> 00:10:55,920
There was no output because we didn't specify any,

187
00:10:55,920 --> 00:10:58,320
but if there were, we could see it here.

188
00:10:58,320 --> 00:10:59,910
Somebody go back,

189
00:10:59,910 --> 00:11:04,110
and one last thing I want to show is which is a new and helpful feature is

190
00:11:04,110 --> 00:11:09,240
we can rerun this command or we can copy it to a new one.

191
00:11:09,240 --> 00:11:12,280
So these are really quick shortcuts to allow us to

192
00:11:12,280 --> 00:11:15,380
rerun these commands on demand.

193
00:11:15,380 --> 00:11:19,880
It used to be where you have to go back in and start a new run command and go

194
00:11:19,880 --> 00:11:23,510
through the entire process each time you wanted to run it.

195
00:11:23,510 --> 00:11:25,530
Now, let's just verify that worked.

196
00:11:25,530 --> 00:11:28,900
I'm gonna go back to session manager and let's start a

197
00:11:28,900 --> 00:11:33,380
session on that instance and let's verify that it actually

198
00:11:33,380 --> 00:11:36,340
worked and created that temporary file.

199
00:11:36,340 --> 00:11:39,000
So I'm logged in once again with my session.

200
00:11:39,000 --> 00:11:43,270
And if I go to temp and I list there it is success.

201
00:11:43,270 --> 00:11:47,580
So if I cat success Hello, plural site, peeps.

202
00:11:47,580 --> 00:11:48,200
There you go.

203
00:11:48,200 --> 00:11:52,640
It created that file that we worked with using that run

204
00:11:52,640 --> 00:11:56,460
command from within systems manager itself.

205
00:11:56,460 --> 00:12:01,610
We did not even have to interact with the operating system at all.

206
00:12:01,610 --> 00:12:08,510
We just utilized the Amazon s s M agent that was installed on this instance.

207
00:12:08,510 --> 00:12:10,750
So that's another good stopping point.

208
00:12:10,750 --> 00:12:13,820
We've covered hybrid activations at a high level.

209
00:12:13,820 --> 00:12:17,430
We talked about session manager and it's uses and

210
00:12:17,430 --> 00:12:19,450
we just looked at run commands,

211
00:12:19,450 --> 00:12:25,380
which allow us to execute commands on instances utilizing the agent

212
00:12:25,380 --> 00:12:29,620
as opposed to a having to connect via ssh or RTP.

213
00:12:29,620 --> 00:12:32,180
So let's go ahead and wrap this clip up.

214
00:12:32,180 --> 00:12:41,000
And in the final clip of this capability section will look at ST Manager, Patch manager and distributor.

