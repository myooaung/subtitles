WEBVTT
ï»¿1
00:00:00.000 --> 00:00:14.260
in this video,

2
00:00:14.260 --> 00:00:18.130
we'll look at edit in code generated by the macro recorder.

3
00:00:18.130 --> 00:00:19.750
When you record a macron,

4
00:00:19.750 --> 00:00:23.230
this code often includes many lines,

5
00:00:23.230 --> 00:00:25.560
which a completely relevant for your purposes.

6
00:00:25.560 --> 00:00:33.250
Let's go into the Exercises folder and at the bottom.

7
00:00:33.250 --> 00:00:38.180
Let's open up The adding in which we saved are recorded macro,

8
00:00:38.180 --> 00:00:41.350
so we just need to right click and choose open.

9
00:00:41.350 --> 00:00:49.220
Then let's go across to the developer tab and click on Visual Basic to launch the visual

10
00:00:49.220 --> 00:00:54.050
basic editor in the model folder.

11
00:00:54.050 --> 00:00:59.120
We opened the first module section 01 getting started.

12
00:00:59.120 --> 00:01:02.450
So here's the macro we recorded.

13
00:01:02.450 --> 00:01:06.850
Let's try and relate it to the operations that we actually perform.

14
00:01:06.850 --> 00:01:10.350
I'll just move this over to the right,

15
00:01:10.350 --> 00:01:16.340
move back to a word and then bring up the replace dialog.

16
00:01:16.340 --> 00:01:21.450
Let's make that over here.

17
00:01:21.450 --> 00:01:30.910
You can also just close the Project Explorer to bring it back.

18
00:01:30.910 --> 00:01:33.600
You just go to view into his project Explorer,

19
00:01:33.600 --> 00:01:34.150
by the way.

20
00:01:34.150 --> 00:01:40.480
So we start at the top here we have selection,

21
00:01:40.480 --> 00:01:44.450
not find not clear formatting and then selection,

22
00:01:44.450 --> 00:01:47.050
not find a replacement clear formatted.

23
00:01:47.050 --> 00:01:56.840
If we try and relate this to the dialogue box clearly what we're dealing with here is this

24
00:01:56.840 --> 00:02:00.750
option the ability to tell work that when we search,

25
00:02:00.750 --> 00:02:07.130
we only want to find certain things if they're in a given bond paragraph style,

26
00:02:07.130 --> 00:02:07.750
etcetera.

27
00:02:07.750 --> 00:02:09.550
So clearly,

28
00:02:09.550 --> 00:02:13.450
if any of that format in is in place on the user's machine,

29
00:02:13.450 --> 00:02:17.450
then that could have an impact on the results of our search.

30
00:02:17.450 --> 00:02:21.520
So these two lines are key to make.

31
00:02:21.520 --> 00:02:27.950
Ensure that any existing format in commands don't interfere with our search results.

32
00:02:27.950 --> 00:02:29.730
Then,

33
00:02:29.730 --> 00:02:30.170
of course,

34
00:02:30.170 --> 00:02:33.950
we've got the texts that were certain for which goes in that box,

35
00:02:33.950 --> 00:02:41.620
the text that we're replacing it with which goes in that box we that have some options

36
00:02:41.620 --> 00:02:43.950
which relate more to find in.

37
00:02:43.950 --> 00:02:46.250
They're doing a global replace.

38
00:02:46.250 --> 00:02:50.610
So forward and wrap really way you're doing Ah,

39
00:02:50.610 --> 00:02:51.660
replace all.

40
00:02:51.660 --> 00:02:53.650
Don't make any difference to the outcome,

41
00:02:53.650 --> 00:02:56.450
so these two can be deleted,

42
00:02:56.450 --> 00:03:01.440
have been cleared,

43
00:03:01.440 --> 00:03:02.320
the format in.

44
00:03:02.320 --> 00:03:07.210
We don't need this case.

45
00:03:07.210 --> 00:03:08.050
Whole words,

46
00:03:08.050 --> 00:03:09.770
wild cards,

47
00:03:09.770 --> 00:03:10.550
etcetera.

48
00:03:10.550 --> 00:03:13.900
None of these are really relevant to what we want to do,

49
00:03:13.900 --> 00:03:16.550
so we can in back delete all of them.

50
00:03:16.550 --> 00:03:20.850
So the only three commands which are relevant Ah,

51
00:03:20.850 --> 00:03:24.950
what's the text be searching for What are we replacing it with?

52
00:03:24.950 --> 00:03:26.670
And this line,

53
00:03:26.670 --> 00:03:28.650
which actually does the operation,

54
00:03:28.650 --> 00:03:33.450
which is equivalent to actually clicking on the replaceable button.

55
00:03:33.450 --> 00:03:38.100
Let's just close that down on.

56
00:03:38.100 --> 00:03:39.470
We could bring back the project,

57
00:03:39.470 --> 00:03:46.470
explore in case we need it so we can go through on weaken,

58
00:03:46.470 --> 00:03:55.050
delete everything from this point forward each of the operations that we recorded.

59
00:03:55.050 --> 00:04:13.050
So that's made our code considerably shorter.

60
00:04:13.050 --> 00:04:18.120
Another feature of this code is a very conspicuous form of repetition.

61
00:04:18.120 --> 00:04:20.170
We have the line with selection,

62
00:04:20.170 --> 00:04:24.650
not find and end with repeated for each section.

63
00:04:24.650 --> 00:04:29.350
So instead of having a separate block reach of al commands,

64
00:04:29.350 --> 00:04:33.250
we could actually have everything in one block,

65
00:04:33.250 --> 00:04:36.150
which perhaps will end here.

66
00:04:36.150 --> 00:04:42.620
Another thing you may notice is that selection,

67
00:04:42.620 --> 00:04:43.330
not find,

68
00:04:43.330 --> 00:04:44.550
is repeated here.

69
00:04:44.550 --> 00:04:48.650
And what that means is that if we take these two words out,

70
00:04:48.650 --> 00:04:54.250
this line can also be part of the with end with structure.

71
00:04:54.250 --> 00:04:55.460
Okay,

72
00:04:55.460 --> 00:05:02.930
so what we need to do is to lose all of the end with and then to lose selection,

73
00:05:02.930 --> 00:05:06.550
not find on this line,

74
00:05:06.550 --> 00:05:09.750
and I'll just tap across to line it up with the others.

75
00:05:09.750 --> 00:05:14.200
So let's just leave a blank line between each section,

76
00:05:14.200 --> 00:05:17.650
so that was our first find and replace operation.

77
00:05:17.650 --> 00:05:22.050
So here I'm just going to dilate this.

78
00:05:22.050 --> 00:05:22.860
That leaves the plane.

79
00:05:22.860 --> 00:05:23.350
Klein.

80
00:05:23.350 --> 00:05:28.770
And then this is the line that actually does the replacement.

81
00:05:28.770 --> 00:05:31.450
That's the equivalent of clicking on the replace all button.

82
00:05:31.450 --> 00:05:35.250
So if I delete all of that and just have it across,

83
00:05:35.250 --> 00:05:37.740
I accidentally deleted the full stop.

84
00:05:37.740 --> 00:05:38.750
So put that back in.

85
00:05:38.750 --> 00:05:41.950
So that's the second operation.

86
00:05:41.950 --> 00:05:57.650
Here's the third there's the next.

87
00:05:57.650 --> 00:06:11.350
So each time which is deleted this tab across leave it blank line and the next one,

88
00:06:11.350 --> 00:06:17.450
This is where we if you remember,

89
00:06:17.450 --> 00:06:19.950
we paused the recording.

90
00:06:19.950 --> 00:06:21.120
And then obviously,

91
00:06:21.120 --> 00:06:22.250
when we went back in,

92
00:06:22.250 --> 00:06:23.110
ah,

93
00:06:23.110 --> 00:06:24.430
we recorded.

94
00:06:24.430 --> 00:06:25.280
Or rather,

95
00:06:25.280 --> 00:06:28.440
the macro recorder generated this line,

96
00:06:28.440 --> 00:06:29.870
which it did up here.

97
00:06:29.870 --> 00:06:34.810
So clearly it's just a repetition of that first clear format in command.

98
00:06:34.810 --> 00:06:42.750
So these two lines can go unwanted with statement is our final end with,

99
00:06:42.750 --> 00:06:46.950
and obviously we can't delete this last one.

100
00:06:46.950 --> 00:06:50.150
What we can do is to select it.

101
00:06:50.150 --> 00:06:55.250
The tips for selecting the whole line is very similar to a word itself.

102
00:06:55.250 --> 00:07:01.550
Move the cursor over to the left hand side but not too far so that it's pointing that way

103
00:07:01.550 --> 00:07:04.150
and then just click to select the whole line,

104
00:07:04.150 --> 00:07:07.420
and then we can move into the selection.

105
00:07:07.420 --> 00:07:08.620
Just drag it down.

106
00:07:08.620 --> 00:07:15.950
Then here we delete those two unwanted words and just have it across.

107
00:07:15.950 --> 00:07:28.080
So all of this now is within one with end with structure on the final thing.

108
00:07:28.080 --> 00:07:29.140
What did you say?

109
00:07:29.140 --> 00:07:32.450
You is commenting your code.

110
00:07:32.450 --> 00:07:35.130
So this is what a comment looks like.

111
00:07:35.130 --> 00:07:37.450
Any line that starts with an apostrophe.

112
00:07:37.450 --> 00:07:43.650
So the macro recorder has put some rather unnecessary comments in this all this delete

113
00:07:43.650 --> 00:07:46.470
those on.

114
00:07:46.470 --> 00:07:49.050
Let's just comment each of our sections.

115
00:07:49.050 --> 00:07:51.850
So what are we doing here?

116
00:07:51.850 --> 00:08:05.050
We're removing a blank line between paragraphs and then from here,

117
00:08:05.050 --> 00:08:07.200
we,

118
00:08:07.200 --> 00:08:07.650
ah,

119
00:08:07.650 --> 00:08:19.160
remove in extra space above the sentence and that,

120
00:08:19.160 --> 00:08:19.550
uh,

121
00:08:19.550 --> 00:08:21.950
relates to all of those.

122
00:08:21.950 --> 00:08:24.150
Then the final thing we're doing,

123
00:08:24.150 --> 00:08:25.650
it's down here,

124
00:08:25.650 --> 00:08:33.170
replaced in two hyphens with,

125
00:08:33.170 --> 00:08:42.950
and so these comments will just remind us exactly what our code is doing.

126
00:08:42.950 --> 00:08:44.550
Obviously,

127
00:08:44.550 --> 00:08:49.650
in the upcoming tutorials will be covering all of this code in detail,

128
00:08:49.650 --> 00:08:56.050
but hopefully that's just giving you a quick flavor of how we can go into a recorded macro

129
00:08:56.050 --> 00:08:58.050
on make changes to it,

130
00:08:58.050 --> 00:09:00.240
which just make it easier to work with.

131
00:09:00.240 --> 00:09:12.920
So let's just save our changes and to test it on,

132
00:09:12.920 --> 00:09:15.950
let's go into the getting started older,

133
00:09:15.950 --> 00:09:29.850
open up recording a macro and then activates the Adan options at INS Word.

134
00:09:29.850 --> 00:09:31.850
Andi activate.

135
00:09:31.850 --> 00:09:34.730
And if you still got this button,

136
00:09:34.730 --> 00:09:36.590
you can just click on it to run the macro,

137
00:09:36.590 --> 00:09:39.220
just in case you haven't still got it,

138
00:09:39.220 --> 00:09:40.580
I'll remind you of the other way.

139
00:09:40.580 --> 00:09:43.310
We go to Developer Micro's.

140
00:09:43.310 --> 00:09:45.710
We could pick it up from there and run,

141
00:09:45.710 --> 00:09:49.890
and you'll see it's still in good shape,

142
00:09:49.890 --> 00:09:51.130
so it still works.

143
00:09:51.130 --> 00:09:51.550
Fine.

144
00:09:51.550 --> 00:10:04.260
Recorded macros can be shortened by deleting lines of code,

145
00:10:04.260 --> 00:10:12.160
which were relevant to the operation you actually want to perform at In comments to clarify

146
00:10:12.160 --> 00:10:17.680
the purpose of different sections of code is useful both for your own reference and to

147
00:10:17.680 --> 00:10:20.160
assist others in understanding the purpose of your Mac.

148
00:10:20.160 --> 00:10:20.570
Rose

