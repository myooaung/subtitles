WEBVTT
1
00:00:01.947 --> 00:00:03.041
In this demonstration,

2
00:00:03.041 --> 00:00:06.384
we'll investigate Windows Update on an individual Windows 10 computer.

3
00:00:06.384 --> 00:00:09.997
I'm going to open up Start, and we'll open the Settings application,

4
00:00:09.997 --> 00:00:13.409
come down to the very bottom category, Update and Security.

5
00:00:13.409 --> 00:00:17.829
Now the Check for updates button will obviously perform an ad

6
00:00:17.829 --> 00:00:20.880
hoc check of your Windows Update settings,

7
00:00:20.880 --> 00:00:22.854
but you know that in the middle of the night,

8
00:00:22.854 --> 00:00:26.002
or whenever you have your Windows Automatic Maintenance plan running,

9
00:00:26.002 --> 00:00:29.783
it will also perform a Windows Update operation there.

10
00:00:29.783 --> 00:00:33.419
Now there's update-related settings that we can look at,

11
00:00:33.419 --> 00:00:34.914
View installed update history.

12
00:00:34.914 --> 00:00:36.167
This is interesting,

13
00:00:36.167 --> 00:00:41.092
and I say that guardedly because it shows you what's been installed.

14
00:00:41.092 --> 00:00:44.929
Notice that they're categorized just like we looked at earlier.

15
00:00:44.929 --> 00:00:46.798
We have one Feature Update.

16
00:00:46.798 --> 00:00:51.430
This was my 1709, fall 2017 creator's update.

17
00:00:51.430 --> 00:00:54.588
And then we have Quality Updates, and then Other Updates.

18
00:00:54.588 --> 00:00:56.141
I don't have an awful lot.

19
00:00:56.141 --> 00:00:57.435
When you click these links,

20
00:00:57.435 --> 00:01:00.343
it takes you out to the web in your default browser where

21
00:01:00.343 --> 00:01:02.202
you can read about that particular issue,

22
00:01:02.202 --> 00:01:04.227
which is all well and good,

23
00:01:04.227 --> 00:01:08.915
but sometimes you'll find that you'll need to uninstall and reinstall a

24
00:01:08.915 --> 00:01:12.113
particular quality update in order to get something working,

25
00:01:12.113 --> 00:01:15.543
or in a worse-case scenario you've identified that a

26
00:01:15.543 --> 00:01:18.288
particular update is breaking functionality on your

27
00:01:18.288 --> 00:01:20.278
system and you need to uninstall it.

28
00:01:20.278 --> 00:01:22.842
We do have a link up here, it's easy to miss,

29
00:01:22.842 --> 00:01:25.694
and that will click out to the traditional Control Panel.

30
00:01:25.694 --> 00:01:29.453
So that's a really important spot for you to know about.

31
00:01:29.453 --> 00:01:31.190
Another is the control command.

32
00:01:31.190 --> 00:01:33.335
I'm about to blow your mind I think.

33
00:01:33.335 --> 00:01:36.276
You've probably noticed that it's really difficult to get to

34
00:01:36.276 --> 00:01:38.541
the classic Control Panel in Windows 10,

35
00:01:38.541 --> 00:01:42.114
at least as of this recording in January 2018.

36
00:01:42.114 --> 00:01:46.479
You can go through the Settings application and be lucky enough to find a

37
00:01:46.479 --> 00:01:49.607
link that will click out into classic Control Panel.

38
00:01:49.607 --> 00:01:53.402
It used to be that you could do Windows key+X or right-click+Start

39
00:01:53.402 --> 00:01:56.478
and there was a classic Control Panel item here,

40
00:01:56.478 --> 00:01:58.203
but there no longer is.

41
00:01:58.203 --> 00:02:01.973
When you think System, I normally think of System in the old Control Panel,

42
00:02:01.973 --> 00:02:03.261
it takes you into Settings.

43
00:02:03.261 --> 00:02:06.567
So what I'm trying to get around to say is that you

44
00:02:06.567 --> 00:02:09.274
can always open up a Run prompt, type control,

45
00:02:09.274 --> 00:02:12.685
and that will open up the All Control Panel Items folder.

46
00:02:12.685 --> 00:02:13.561
Isn't that great?

47
00:02:13.561 --> 00:02:17.614
And in there, you have a classic Control Panel called Programs and Features,

48
00:02:17.614 --> 00:02:20.917
and then from there, you have View installed updates,

49
00:02:20.917 --> 00:02:23.354
and then let me maximize this.

50
00:02:23.354 --> 00:02:27.692
I'll normally make sure that the view is doing a reverse sort

51
00:02:27.692 --> 00:02:29.831
on Installed On to see the most recent,

52
00:02:29.831 --> 00:02:32.876
and then you can search for a particular KB number.

53
00:02:32.876 --> 00:02:35.836
KB used to stand for knowledge base.

54
00:02:35.836 --> 00:02:39.051
It's how Microsoft documented all of their updates.

55
00:02:39.051 --> 00:02:40.779
Maybe it still does in 2018.

56
00:02:40.779 --> 00:02:43.367
But anyway, if you select one of these guys,

57
00:02:43.367 --> 00:02:45.356
you'll know that you can uninstall it.

58
00:02:45.356 --> 00:02:47.737
Be careful doing that and making sure you're doing

59
00:02:47.737 --> 00:02:50.256
that under good guidance by the way, seriously.

60
00:02:50.256 --> 00:02:53.016
So let's come back to our previous page.

61
00:02:53.016 --> 00:02:56.527
Some other Update settings you can do are change the active hours,

62
00:02:56.527 --> 00:03:00.221
this is where you tell Windows please don't do an automatic restart.

63
00:03:00.221 --> 00:03:01.484
That's a controversial point,

64
00:03:01.484 --> 00:03:04.446
the fact that by default if Windows Updates applies

65
00:03:04.446 --> 00:03:08.586
an update that requires a restart, it'll just do it automatically.

66
00:03:08.586 --> 00:03:11.226
If you want some guidance on how to turn that off,

67
00:03:11.226 --> 00:03:13.413
it's become increasingly difficult to do by the way,

68
00:03:13.413 --> 00:03:17.312
you'll want to check the exercise files because I give you a link there.

69
00:03:17.312 --> 00:03:20.901
So you'll set this according to your active hours and Windows

70
00:03:20.901 --> 00:03:23.671
will be guaranteed online during that time.

71
00:03:23.671 --> 00:03:26.395
Restart options, you can schedule a restart,

72
00:03:26.395 --> 00:03:29.729
like if you know that some updates have been applied and

73
00:03:29.729 --> 00:03:32.055
Windows tells you that it needs to restart.

74
00:03:32.055 --> 00:03:34.948
You can have it happen at a specific day and time.

75
00:03:34.948 --> 00:03:39.368
You can optionally make some more notifications happen.

76
00:03:39.368 --> 00:03:42.524
These are what are called toast notifications that pop

77
00:03:42.524 --> 00:03:44.277
up above your notification area.

78
00:03:44.277 --> 00:03:45.561
Let's come back here.

79
00:03:45.561 --> 00:03:46.524
Under Advanced options,

80
00:03:46.524 --> 00:03:50.057
this allows you to go beyond just the Windows code

81
00:03:50.057 --> 00:03:52.371
base and give you related updates.

82
00:03:52.371 --> 00:03:55.310
This is a useful tool because you can get driver updates,

83
00:03:55.310 --> 00:03:57.957
you can also get updates for Microsoft Office

84
00:03:57.957 --> 00:04:00.172
applications if you have them installed,

85
00:04:00.172 --> 00:04:03.506
you can pause updates to a limited degree here.

86
00:04:03.506 --> 00:04:08.635
All of this stuff is centrally controllable through Group Policy by the way.

87
00:04:08.635 --> 00:04:11.171
You can customize how often updates happen,

88
00:04:11.171 --> 00:04:15.281
what happens when updates happen, all of that is through Group Policy,

89
00:04:15.281 --> 00:04:18.248
and included in those group policies, like I said earlier,

90
00:04:18.248 --> 00:04:22.310
is the ability to point your Windows 10 clients to a Windows

91
00:04:22.310 --> 00:04:25.543
Server Update Services box instead of the internet.

92
00:04:25.543 --> 00:04:27.209
Now Delivery Optimization, again,

93
00:04:27.209 --> 00:04:30.886
is a somewhat controversial feature in Windows Update.

94
00:04:30.886 --> 00:04:35.140
It's call WUDO, W-U-D-O, Windows Update Delivery Optimization.

95
00:04:35.140 --> 00:04:39.018
It's a way to make the delivery of updates faster because you can do,

96
00:04:39.018 --> 00:04:43.660
in a peer-to-peer fashion, uploads and downloads of those updates.

97
00:04:43.660 --> 00:04:45.868
Now if you trust the machines inside your network,

98
00:04:45.868 --> 00:04:47.140
which I presume you do,

99
00:04:47.140 --> 00:04:50.334
you're going to get a performance boost and you'll have less

100
00:04:50.334 --> 00:04:55.636
network traffic flowing if one PC posts the updates from the

101
00:04:55.636 --> 00:05:00.437
internet or from your WSUS server, and as long as WUDO is installed,

102
00:05:00.437 --> 00:05:03.628
those other PCs can fetch updates peer to peer.

103
00:05:03.628 --> 00:05:04.366
Isn't that neat?

104
00:05:04.366 --> 00:05:07.780
You can, and this is where the controversial piece comes in,

105
00:05:07.780 --> 00:05:10.183
incorporate internet-based hosts too.

106
00:05:10.183 --> 00:05:13.542
Now understand that all of those updates are digitally signed,

107
00:05:13.542 --> 00:05:19.469
and WUDO will not transfer a file that's been modified by even one bit.

108
00:05:19.469 --> 00:05:23.283
Modifying a single bit in code will break a

109
00:05:23.283 --> 00:05:24.554
previously-created digital signature.

110
00:05:24.554 --> 00:05:26.023
So that's the assurance with that.

111
00:05:26.023 --> 00:05:29.854
I'm going to step back a couple steps, and I think that's it.

112
00:05:29.854 --> 00:05:33.030
Those are the major touch points for Windows Update.

113
00:05:33.030 --> 00:05:37.064
Showed you how to roll back updates by accessing the classic Control Panel,

114
00:05:37.064 --> 00:05:40.912
let me bring up an elevated PowerShell prompt because there

115
00:05:40.912 --> 00:05:42.789
is a command called Get-WindowsUpdateLog,

116
00:05:42.789 --> 00:05:47.041
and what this is going to do, it'll actually echo it out,

117
00:05:47.041 --> 00:05:52.656
it'll go into the event log system, find however many files that it finds,

118
00:05:52.656 --> 00:05:56.267
concatenate them together, and then give you a comma-separated value file,

119
00:05:56.267 --> 00:05:59.040
and it tells us the dump file name right here.

120
00:05:59.040 --> 00:06:04.220
So once we get our prompt back, or if I just want to bring up a Run prompt.

121
00:06:04.220 --> 00:06:11.540
I can navigate out to c:\users\tim\AppData\local\temp\WindowsUpdateLog.

122
00:06:11.540 --> 00:06:13.850
I'll do a quick sort by Date modified,

123
00:06:13.850 --> 00:06:17.001
and it looks like it's creating several CSV files.

124
00:06:17.001 --> 00:06:20.311
I think it's still generating the files.

125
00:06:20.311 --> 00:06:21.507
Nope, there it goes.

126
00:06:21.507 --> 00:06:22.106
The WindowsUpdate.

127
00:06:22.106 --> 00:06:26.638
log is written to, oh I guess it wrote the final log to the Desktop.

128
00:06:26.638 --> 00:06:27.670
Well that makes sense.

129
00:06:27.670 --> 00:06:31.534
We shouldn't necessarily have to browse around a temp folder to find that file.

130
00:06:31.534 --> 00:06:36.455
Just out of curiosity, I wonder how big this file is, 775 KB.

131
00:06:36.455 --> 00:06:39.796
That's pretty big for a text file.

132
00:06:39.796 --> 00:06:43.421
Now these delimited files are nice because you can pop them into a table,

133
00:06:43.421 --> 00:06:44.651
a database table,

134
00:06:44.651 --> 00:06:48.751
or put them in Excel and generate reports and do

135
00:06:48.751 --> 00:06:51.207
filters and all that good stuff,

136
00:06:51.207 --> 00:06:54.363
but the Get-WindowsUpdateLog and the resulting delimited output

137
00:06:54.363 --> 00:06:58.069
here can be awfully useful when you're helping customers and

138
00:06:58.069 --> 00:07:00.659
clients because instead of asking them, hey,

139
00:07:00.659 --> 00:07:05.179
did you download kb157231, you know what I mean?

140
00:07:05.179 --> 00:07:06.518
That's never going to work.

141
00:07:06.518 --> 00:07:09.733
If you can get a Windows Update log from that person,

142
00:07:09.733 --> 00:07:18.000
you'll have everything you need to make a diagnosis based on what they've got going on with their Windows updates.

