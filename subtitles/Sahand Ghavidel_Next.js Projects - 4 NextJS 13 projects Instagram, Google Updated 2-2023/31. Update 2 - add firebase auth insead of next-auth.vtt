WEBVTT
1
00:00:07.560 --> 00:00:08.000
All right.

2
00:00:08.010 --> 00:00:12.720
Welcome back to another update for Instagram Clone Project.

3
00:00:13.640 --> 00:00:20.690
In this update, I'm going to introduce you to more advanced topics like Firebase Authentication.

4
00:00:21.410 --> 00:00:28.310
We're going to remove the next off package and instead we're going to use Firebase.

5
00:00:29.780 --> 00:00:39.710
If you look at the our firebase and we choose to our project inside the authentication as you can see,

6
00:00:39.710 --> 00:00:43.250
there is no one here to be authenticated.

7
00:00:44.630 --> 00:00:45.740
The reason is.

8
00:00:46.700 --> 00:00:55.760
The next off package use browser to temporarily make session for us and doesn't save the people inside

9
00:00:55.760 --> 00:01:03.440
the authentication of we don't need to save it inside the Firebase authentication but in order to change

10
00:01:03.440 --> 00:01:05.270
the rules inside the.

11
00:01:06.400 --> 00:01:08.020
For example, storage.

12
00:01:09.260 --> 00:01:12.800
As you can see now, the inside, the rules.

13
00:01:12.800 --> 00:01:17.000
Everybody can read and write our.

14
00:01:20.180 --> 00:01:21.220
It's storage.

15
00:01:21.400 --> 00:01:24.760
As you can see, reading and writing is allowed.

16
00:01:25.120 --> 00:01:25.900
But.

17
00:01:28.410 --> 00:01:29.670
If a person.

18
00:01:32.590 --> 00:01:34.360
Is not authenticated.

19
00:01:34.360 --> 00:01:39.470
For example someone comes to the browser can and find the data.

20
00:01:39.490 --> 00:01:43.390
Our data, our API keys.

21
00:01:44.050 --> 00:01:51.610
They can easily use our storage to use for their own projects.

22
00:01:52.390 --> 00:01:59.110
So in order to change the rules inside the storage and also inside the database.

23
00:02:01.430 --> 00:02:06.500
We need to add the people in the authentication part as well.

24
00:02:07.500 --> 00:02:13.740
So as you can see here as well, everybody can read and write our project.

25
00:02:16.230 --> 00:02:24.600
And uh, and also inside the Firebase database, we only have the post collection.

26
00:02:24.600 --> 00:02:33.810
We want to have another collection called Users and whoever sign up in our website, we want to add

27
00:02:33.810 --> 00:02:35.640
it inside this collection.

28
00:02:35.640 --> 00:02:46.980
And later we can use this data to create a specific page, for example, for a user that is posted in

29
00:02:46.980 --> 00:02:49.110
our website.

30
00:02:50.810 --> 00:02:51.130
Okay.

31
00:02:51.140 --> 00:02:53.000
Let's start with that.

32
00:02:53.390 --> 00:03:00.410
If you search for fire, face off.

33
00:03:02.220 --> 00:03:10.710
And in the search result we click on firebase dot google.com for free slash docs for slash of.

34
00:03:13.380 --> 00:03:16.680
And if you go here on the left side.

35
00:03:18.140 --> 00:03:23.480
If we choose Web and inside web, we choose Google.

36
00:03:28.460 --> 00:03:33.520
Now we can see if we can authenticate the person using Google.

37
00:03:33.530 --> 00:03:41.630
We need to import Google off provider from Firebase Authentication and we create a new provider by using

38
00:03:41.630 --> 00:03:45.290
new Google provider then.

39
00:03:47.240 --> 00:03:47.800
How?

40
00:03:48.830 --> 00:03:56.600
We can get the information of the person who is authenticated here by using get off method from five

41
00:03:56.600 --> 00:03:57.770
based off.

42
00:03:58.740 --> 00:04:00.210
And finally.

43
00:04:01.300 --> 00:04:05.530
We can use sign in with pop up method.

44
00:04:07.040 --> 00:04:13.050
To sign into person using the OFT and provider information OC.

45
00:04:14.120 --> 00:04:21.020
And also later we get the result, for example, the user data and if the an error happens, we can

46
00:04:21.020 --> 00:04:23.390
catch it as well.

47
00:04:25.740 --> 00:04:26.990
It's not too complicated.

48
00:04:27.000 --> 00:04:35.040
I'm going to explain it a step by step inside the our waistcoat code and the browser.

49
00:04:36.140 --> 00:04:36.590
Okay.

50
00:04:36.740 --> 00:04:41.000
Let's close this and we go back to Visual Studio code.

51
00:04:43.450 --> 00:04:44.420
And, uh.

52
00:04:45.330 --> 00:04:48.180
We need to go to oath signing.

53
00:04:51.030 --> 00:04:52.800
So inside the pages.

54
00:04:52.890 --> 00:04:53.850
Let me close this.

55
00:04:53.850 --> 00:04:55.430
Inside the pages.

56
00:04:55.440 --> 00:04:57.810
Inside the folder called off.

57
00:04:57.900 --> 00:05:00.080
We go to sign touches.

58
00:05:00.720 --> 00:05:07.800
Now, as you can see, we're using next off to signing the person and also to get the providers.

59
00:05:08.610 --> 00:05:15.510
So we want to get rid of this and we want to use Firebase instead.

60
00:05:17.240 --> 00:05:25.820
So we delete this and also we don't get this provider, so we delete this and this sign should be capitalized.

61
00:05:28.160 --> 00:05:33.110
Capitalized because this is a react functional component.

62
00:05:33.110 --> 00:05:40.400
So the convention is this and otherwise we get an error when we are deploying the website and also we

63
00:05:40.400 --> 00:05:49.550
don't need to use get server side props to get the providers as we are using Firebase authentication

64
00:05:49.550 --> 00:05:50.360
directly.

65
00:05:52.130 --> 00:05:56.990
And also so we don't have any providers, so we cannot look through it.

66
00:05:56.990 --> 00:06:02.000
So we delete this as well and we can delete the key.

67
00:06:05.480 --> 00:06:06.170
And.

68
00:06:08.240 --> 00:06:15.260
Here we have a click on the button which is saying, which is calling the sign in from next off.

69
00:06:15.260 --> 00:06:18.950
But we're going to create our own function.

70
00:06:19.460 --> 00:06:20.870
We call it on.

71
00:06:22.120 --> 00:06:23.170
Google.

72
00:06:24.390 --> 00:06:25.140
Click.

73
00:06:27.320 --> 00:06:35.510
And also here for signing with a provider that name that we don't have the provider, we just make it

74
00:06:35.510 --> 00:06:39.530
Google as we have only one provider.

75
00:06:40.680 --> 00:06:40.950
Okay.

76
00:06:40.950 --> 00:06:43.290
Let's create this function at the top.

77
00:06:44.930 --> 00:06:49.370
Here we create a function and we call it on.

78
00:06:51.340 --> 00:06:52.720
Google click.

79
00:06:57.050 --> 00:06:58.460
Let's go back to.

80
00:06:59.820 --> 00:07:03.930
Our website and go to of.

81
00:07:04.880 --> 00:07:06.650
For slash sign.

82
00:07:07.770 --> 00:07:08.340
In.

83
00:07:12.170 --> 00:07:13.010
No.

84
00:07:13.040 --> 00:07:14.380
We have the same page.

85
00:07:14.390 --> 00:07:16.100
It's working, no errors.

86
00:07:16.100 --> 00:07:21.950
But when we click on sign in Google, nothing happens because the function is empty.

87
00:07:24.890 --> 00:07:27.800
As we want to get the errors as well.

88
00:07:27.830 --> 00:07:41.540
When we are calling the get off and signing with pop up, we can use the try and catch method which

89
00:07:41.750 --> 00:07:51.350
we are getting the suggestion, try catch statement and inside the try we get everything like off provider

90
00:07:51.350 --> 00:07:53.360
and sign up with pop up.

91
00:07:55.020 --> 00:07:59.820
So here firstly we create a constant and we call it off.

92
00:07:59.940 --> 00:08:03.210
And this is going to use to get.

93
00:08:04.940 --> 00:08:10.520
Off method from Firebase for Slash.

94
00:08:13.130 --> 00:08:13.790
Auth.

95
00:08:13.790 --> 00:08:16.010
So if we need to import it here at the top.

96
00:08:18.240 --> 00:08:22.110
So it's just import kit of.

97
00:08:24.170 --> 00:08:28.340
From Firebase for slash of.

98
00:08:32.780 --> 00:08:35.150
So we have the authentication data.

99
00:08:35.180 --> 00:08:38.600
Let me console.log this and you can see the.

100
00:08:39.750 --> 00:08:42.060
What we have inside of.

101
00:08:43.820 --> 00:08:47.360
So let's go back to our browser.

102
00:08:50.930 --> 00:08:55.070
And we open the console using f 12.

103
00:08:55.640 --> 00:08:57.400
I have the console on the right side.

104
00:08:57.410 --> 00:08:59.150
You can change the position.

105
00:09:00.080 --> 00:09:01.100
I think here.

106
00:09:02.670 --> 00:09:05.580
And this is a down this is on the right side.

107
00:09:06.210 --> 00:09:11.250
So when we click on sign in with Google, we should get the.

108
00:09:13.520 --> 00:09:14.270
Off.

109
00:09:19.560 --> 00:09:21.300
Let me see.

110
00:09:23.520 --> 00:09:24.750
Let me refresh again.

111
00:09:28.090 --> 00:09:30.430
Click on signing with Google.

112
00:09:32.560 --> 00:09:42.190
The reason we're not getting off, we didn't import the DPI because they need to have our information

113
00:09:42.190 --> 00:09:43.180
from our

114
00:09:45.670 --> 00:09:50.470
firebase so they know which which DPI they have to check.

115
00:09:51.870 --> 00:09:55.170
So DB is coming from.

116
00:09:56.590 --> 00:09:57.300
We are here.

117
00:09:57.310 --> 00:10:03.220
We should go back one, four, two folders, and here we have the firebase.

118
00:10:03.220 --> 00:10:08.980
That is so two times we come back and then we choose the firebase.

119
00:10:11.870 --> 00:10:15.320
I feel this is going to solve the problem.

120
00:10:15.320 --> 00:10:16.550
Let's try.

121
00:10:18.560 --> 00:10:20.300
You know, we are getting the off.

122
00:10:21.540 --> 00:10:22.230
Okay.

123
00:10:23.430 --> 00:10:31.170
Now, if we open this one, as you can see, the current user is null because we haven't authenticated

124
00:10:31.170 --> 00:10:32.400
person yet.

125
00:10:35.420 --> 00:10:37.820
So let's authenticate the person.

126
00:10:37.880 --> 00:10:40.540
First, we need to bring the provider.

127
00:10:40.550 --> 00:10:41.600
So we need to.

128
00:10:42.630 --> 00:10:44.190
Get the provider.

129
00:10:45.810 --> 00:10:47.740
And this is coming from.

130
00:10:48.120 --> 00:10:56.350
We just need to create a new Google of provider which is coming from Firebase for slash off.

131
00:10:56.580 --> 00:11:02.370
So this we get the auto import as well.

132
00:11:03.670 --> 00:11:05.020
Now we have the provider.

133
00:11:05.020 --> 00:11:06.220
We have the off.

134
00:11:06.970 --> 00:11:11.620
So now we can sign up the person with pop up methods.

135
00:11:11.620 --> 00:11:21.850
So we just need to wait and use sign in with pop up, which is coming from Firebase for Slash off as

136
00:11:21.850 --> 00:11:22.450
well.

137
00:11:23.200 --> 00:11:26.050
And this is going to take two things.

138
00:11:26.290 --> 00:11:31.210
First is off and the next one is provide.

139
00:11:37.180 --> 00:11:38.830
Okay, let's try this.

140
00:11:38.830 --> 00:11:45.640
But before trying it, because we are using a weight, we need to change this function to a synchronous.

141
00:11:48.040 --> 00:11:48.400
Okay.

142
00:11:49.340 --> 00:11:50.660
Let's try it now.

143
00:11:52.380 --> 00:11:57.540
So when we click on signing with Google, the window should pop up.

144
00:11:58.510 --> 00:12:00.280
So as you can see here.

145
00:12:03.220 --> 00:12:07.990
We need to sign it with one of our Gmail accounts or choose, for example, this one.

146
00:12:12.690 --> 00:12:13.700
No.

147
00:12:13.710 --> 00:12:16.860
If you check the off the console log.

148
00:12:17.820 --> 00:12:19.530
Inside the current user.

149
00:12:19.530 --> 00:12:21.000
We have a user now.

150
00:12:23.260 --> 00:12:27.820
If you open it and we go to provider data.

151
00:12:29.380 --> 00:12:31.570
We open the first array.

152
00:12:32.230 --> 00:12:34.570
We get all the information we need.

153
00:12:34.810 --> 00:12:42.340
For example, display name, email, photo URL, and also the unique ID.

154
00:12:44.890 --> 00:12:47.170
And also if you go back to.

155
00:12:48.050 --> 00:12:58.340
If Firebase and we go to authentication, we see the person inside this, the email, the provider name,

156
00:12:58.340 --> 00:13:06.860
which is Google, the created time, the signing time, and also the unique ID that is specifically

157
00:13:06.860 --> 00:13:08.720
created for authentication.

158
00:13:09.020 --> 00:13:10.520
Just be careful.

159
00:13:10.520 --> 00:13:14.870
This unique ID is different from the Google unique ID.

160
00:13:15.260 --> 00:13:19.970
So this one is just a v and.

161
00:13:20.890 --> 00:13:21.610
Here.

162
00:13:22.660 --> 00:13:23.770
Just a number.

163
00:13:24.160 --> 00:13:28.540
We're going to use this one to create the user because this is completely unique.

164
00:13:28.540 --> 00:13:29.260
But.

165
00:13:30.270 --> 00:13:31.740
If you delete this one.

166
00:13:32.570 --> 00:13:39.740
Here and signing the person again, you get a different unique ID, so you have to pay attention for

167
00:13:39.740 --> 00:13:45.350
this one and never create a user inside the database with this unique I.D..

168
00:13:49.230 --> 00:13:54.600
Now it's time to save the user inside the database.

169
00:13:55.320 --> 00:13:58.770
So let's go back to Visual Studio code.

170
00:13:59.220 --> 00:14:07.980
So after the pop up is finished and the person chooses the Gmail account and the person is added to

171
00:14:07.980 --> 00:14:09.210
authentication.

172
00:14:10.290 --> 00:14:20.250
So the off has the current user data so we can save the data inside a constant called user.

173
00:14:20.730 --> 00:14:24.420
And this is going to be off dot.

174
00:14:25.890 --> 00:14:27.270
Current user.

175
00:14:28.780 --> 00:14:29.280
That.

176
00:14:30.640 --> 00:14:39.730
Provider data and inside the first array here.

177
00:14:42.330 --> 00:14:44.190
Now we have the user.

178
00:14:45.330 --> 00:14:50.520
We can create a reference using the the user that uid.

179
00:14:51.990 --> 00:14:53.790
Because we want to create the.

180
00:14:55.100 --> 00:14:56.930
Person inside.

181
00:14:58.150 --> 00:15:05.620
The data added here in this collection, which is called users, this is going to be users.

182
00:15:05.860 --> 00:15:12.440
And instead of getting the random ID, you're going to use the google uid.

183
00:15:14.770 --> 00:15:19.000
So first we need to create an address or reference.

184
00:15:19.630 --> 00:15:21.760
So we call it the doc ref.

185
00:15:22.630 --> 00:15:24.580
And this is going to be.

186
00:15:25.560 --> 00:15:30.090
Doc, which is the Firebase Faster method.

187
00:15:30.990 --> 00:15:34.680
And this is going to take our DPI.

188
00:15:36.340 --> 00:15:38.260
The address for our database.

189
00:15:39.310 --> 00:15:50.470
And then we have the users collection and we want to create the users with the idea of user dot I.

190
00:15:52.270 --> 00:15:58.390
First, we want to check that if the person is existed or not because we don't want to, we want to

191
00:15:58.390 --> 00:16:03.490
prevent the duplication in our database.

192
00:16:04.920 --> 00:16:07.620
So we can get a snapshot.

193
00:16:07.620 --> 00:16:10.200
But just seeing Doc Snap.

194
00:16:12.330 --> 00:16:14.640
And we need to await.

195
00:16:18.260 --> 00:16:20.080
And used to get dark.

196
00:16:20.090 --> 00:16:24.890
So which search for the document and.

197
00:16:25.640 --> 00:16:28.880
With the address of Doc Reef, which we have.

198
00:16:29.660 --> 00:16:30.800
Created here.

199
00:16:33.030 --> 00:16:33.900
No.

200
00:16:36.250 --> 00:16:38.740
We want to check if there is no.

201
00:16:40.300 --> 00:16:45.120
The user with this UUID so we can check it like this.

202
00:16:45.130 --> 00:16:47.770
We can just say docker snap.

203
00:16:49.300 --> 00:16:51.850
We can use exist method.

204
00:16:54.240 --> 00:16:58.080
This is going to give us the true and false so.

205
00:16:58.990 --> 00:17:01.960
If this one is true, the person is existed.

206
00:17:02.940 --> 00:17:05.040
We don't want this if works.

207
00:17:06.440 --> 00:17:08.630
So if it's not existed.

208
00:17:09.410 --> 00:17:11.530
We want to wait and create the user.

209
00:17:11.540 --> 00:17:15.360
We just want to create the user using set dock.

210
00:17:16.460 --> 00:17:19.610
Which is coming from Firebase Five Store.

211
00:17:22.400 --> 00:17:23.180
This is.

212
00:17:24.260 --> 00:17:26.450
I have the address, doc ref.

213
00:17:29.500 --> 00:17:37.180
We have to just create the user with this address and also add these objects.

214
00:17:38.530 --> 00:17:40.090
First, we want to add the name.

215
00:17:41.270 --> 00:17:44.540
So this is coming from user display name.

216
00:17:48.660 --> 00:17:50.180
Then email.

217
00:17:51.250 --> 00:17:52.780
Which is the user.

218
00:17:55.230 --> 00:17:56.850
Dot email.

219
00:18:00.000 --> 00:18:03.310
Then we have the user image.

220
00:18:07.230 --> 00:18:08.010
Which is.

221
00:18:08.130 --> 00:18:11.790
User dot photo URL.

222
00:18:14.340 --> 00:18:17.160
And uid we can save it.

223
00:18:17.400 --> 00:18:19.890
We can use it later as well.

224
00:18:20.060 --> 00:18:21.630
Just say user dot.

225
00:18:22.520 --> 00:18:22.880
You.

226
00:18:22.880 --> 00:18:23.660
I'd.

227
00:18:26.880 --> 00:18:33.570
And the time that the person is authenticated is.

228
00:18:34.680 --> 00:18:39.660
We can just say time is equal and we can use the time stamp.

229
00:18:41.130 --> 00:18:41.880
Several times.

230
00:18:41.880 --> 00:18:42.600
Staff.

231
00:18:43.780 --> 00:18:46.240
So let's call this one time stamp too.

232
00:18:46.270 --> 00:18:47.410
So, tribe.

233
00:18:48.510 --> 00:18:49.560
The stamp.

234
00:18:50.820 --> 00:18:57.990
Which is equal to user or just a server type of step.

235
00:19:00.650 --> 00:19:09.140
And if you remember we save the username as well, but we just use the display name to create it.

236
00:19:10.130 --> 00:19:16.130
So just a user name and this is going to be equal to user display name.

237
00:19:16.160 --> 00:19:17.240
We copy this.

238
00:19:17.630 --> 00:19:19.430
We split this one.

239
00:19:21.420 --> 00:19:25.980
Buy this space and join it.

240
00:19:27.960 --> 00:19:28.740
Again.

241
00:19:29.070 --> 00:19:40.260
So we join it, we dot space and finally we want to change it to lower lower case by using to local

242
00:19:40.410 --> 00:19:41.610
lowercase.

243
00:19:48.830 --> 00:19:49.770
That's okay.

244
00:19:49.790 --> 00:19:50.270
Let's.

245
00:19:50.720 --> 00:19:52.040
Let's test this.

246
00:19:54.430 --> 00:19:56.860
So now we don't have any users here.

247
00:19:58.550 --> 00:20:00.740
Let's try to sign up.

248
00:20:02.510 --> 00:20:05.600
Let's try sign up with another Gmail account.

249
00:20:10.800 --> 00:20:11.310
Okay.

250
00:20:11.340 --> 00:20:12.750
Let's test that first.

251
00:20:12.750 --> 00:20:16.170
Inside authentication, we have the new person.

252
00:20:17.860 --> 00:20:24.430
And inside the Firebase database now we have a new collection called Users.

253
00:20:25.580 --> 00:20:31.940
Which is created by the user ID or unique ID of Google.

254
00:20:33.140 --> 00:20:36.800
And we have the data like Gmail.

255
00:20:37.690 --> 00:20:41.930
Name the username timestamp.

256
00:20:41.950 --> 00:20:44.890
Use a unique ID which is similar to this.

257
00:20:45.840 --> 00:20:48.120
And user image.

258
00:20:48.390 --> 00:20:50.220
So everything we need.

259
00:20:51.430 --> 00:20:55.870
It's at it lets signing with the other account.

260
00:20:58.640 --> 00:20:59.600
But this one.

261
00:21:01.120 --> 00:21:04.480
So a new person should be added.

262
00:21:06.140 --> 00:21:11.790
Now we have the two two Gmail accounts here.

263
00:21:11.810 --> 00:21:13.040
All the information.

264
00:21:14.850 --> 00:21:19.380
So after this one happens, I want to redirect the person to the home page.

265
00:21:21.370 --> 00:21:28.900
In order to do that, we can just use the user router method from next.

266
00:21:30.260 --> 00:21:31.160
Router.

267
00:21:32.200 --> 00:21:34.600
So we need to import.

268
00:21:35.970 --> 00:21:36.840
Use.

269
00:21:37.950 --> 00:21:38.910
Router.

270
00:21:40.350 --> 00:21:42.480
From next router.

271
00:21:43.360 --> 00:21:45.820
And we need to initialize it here.

272
00:21:46.780 --> 00:21:51.520
We just say router is equal to use router.

273
00:21:53.510 --> 00:21:56.960
Then after everything's happened.

274
00:21:58.370 --> 00:22:00.440
Let's get rid of this console.log.

275
00:22:00.440 --> 00:22:08.960
And here we just use router dot push and we just choose the home page.

276
00:22:10.220 --> 00:22:10.860
That's right.

277
00:22:10.880 --> 00:22:11.480
Now.

278
00:22:13.430 --> 00:22:15.860
So we sign in the person.

279
00:22:19.180 --> 00:22:20.710
For example, this guy.

280
00:22:23.400 --> 00:22:26.780
And we are redirected to the homepage.

281
00:22:30.860 --> 00:22:34.640
So now the person is authenticated.

282
00:22:34.640 --> 00:22:44.690
But still you can see that we are not signed in because all every component is using next of a package

283
00:22:44.690 --> 00:22:45.470
instead.

284
00:22:45.740 --> 00:22:49.370
So we need to change all of them and get the.

285
00:22:50.330 --> 00:22:56.480
Data from the Firebase authentication, but we don't want to do it many times.

286
00:22:56.480 --> 00:23:06.500
We just want to do it in a one component and we save the user inside a global state using recoil as

287
00:23:06.500 --> 00:23:07.910
the header.

288
00:23:09.240 --> 00:23:12.810
Is always there and is.

289
00:23:12.930 --> 00:23:16.220
If we add more page, we always have the header.

290
00:23:16.230 --> 00:23:24.420
We can get the information inside the header, we check the user and inside that we can save it to the

291
00:23:26.010 --> 00:23:26.880
global state.

292
00:23:26.880 --> 00:23:36.960
And also in other components like the stories post and the here, the mini profile, we can just get

293
00:23:36.960 --> 00:23:40.410
the user from the global state.

294
00:23:40.410 --> 00:23:44.100
So we don't need to use use effect all the time.

295
00:23:49.020 --> 00:23:53.640
The only thing left is just the we catch the arrows.

296
00:23:54.270 --> 00:24:03.660
So we later we're going to use a package called testify and we can toast it like a notification in our

297
00:24:03.660 --> 00:24:04.200
website.

298
00:24:04.200 --> 00:24:10.710
So if any error happens, but just for now, we can still log the error.

299
00:24:13.490 --> 00:24:15.710
Now we need to go to the.

300
00:24:19.470 --> 00:24:28.170
The components and we go to header and inside here we're going to get the authentication information

301
00:24:28.170 --> 00:24:31.440
and add it to our global state.

302
00:24:33.040 --> 00:24:34.900
All right, so let's get off.

303
00:24:34.930 --> 00:24:37.840
Get rid of the next off here.

304
00:24:38.560 --> 00:24:41.580
So we don't want to use use session, sign in and sign out.

305
00:24:41.590 --> 00:24:44.950
We're going to use fire days instead.

306
00:24:45.310 --> 00:24:46.660
So we delete this.

307
00:24:46.660 --> 00:24:48.370
We delete this session.

308
00:24:50.530 --> 00:24:51.160
Then.

309
00:24:53.510 --> 00:24:57.920
We need to create a user state.

310
00:24:58.810 --> 00:25:05.650
So to use effect to get the on off state change.

311
00:25:06.460 --> 00:25:08.240
So I'll show you in a second.

312
00:25:08.260 --> 00:25:11.770
So here we just create a use.

313
00:25:13.230 --> 00:25:14.190
Affect.

314
00:25:16.070 --> 00:25:17.800
Just coming from React.

315
00:25:22.120 --> 00:25:25.120
Uh, we don't need to import react actually.

316
00:25:25.120 --> 00:25:28.780
So use effects from React and.

317
00:25:29.890 --> 00:25:34.750
We need to have a function here and.

318
00:25:35.900 --> 00:25:37.790
We need to add a dependency.

319
00:25:39.410 --> 00:25:45.050
So this dependency means one time bronze when the page refresh.

320
00:25:45.440 --> 00:25:47.000
So that's what we need.

321
00:25:47.000 --> 00:25:51.710
We need each time check that if it a person is still authenticated or not.

322
00:25:53.320 --> 00:25:54.240
And, uh.

323
00:25:56.360 --> 00:25:58.370
We need to get off.

324
00:25:59.840 --> 00:26:02.000
Which is coming from get off.

325
00:26:03.320 --> 00:26:05.450
From five based off.

326
00:26:07.040 --> 00:26:07.700
Then.

327
00:26:09.000 --> 00:26:13.080
We are going to use a method called on of state change.

328
00:26:14.330 --> 00:26:16.100
From fire.

329
00:26:16.860 --> 00:26:18.210
Base auth.

330
00:26:20.030 --> 00:26:28.220
This one is going to give us firstly gets the off so we know which one to check and this is the give.

331
00:26:28.640 --> 00:26:30.560
This is going to give us the user.

332
00:26:35.270 --> 00:26:37.520
And if the user exists.

333
00:26:39.450 --> 00:26:40.260
We want to

334
00:26:43.140 --> 00:26:46.200
we want to fetch the user from the database.

335
00:26:49.620 --> 00:26:52.800
So we need to create a function.

336
00:26:54.140 --> 00:26:59.990
To fetch the user, but because the function is a synchronous.

337
00:27:01.890 --> 00:27:04.680
We need to use a weight for the function.

338
00:27:06.020 --> 00:27:09.950
For example for that snapshot or using get doc.

339
00:27:10.580 --> 00:27:17.450
So because we cannot change the use effect to a synchronous, we need to create a function here.

340
00:27:18.500 --> 00:27:21.500
A synchronous function, for example, we call it fetch.

341
00:27:23.640 --> 00:27:24.450
User.

342
00:27:26.550 --> 00:27:30.180
And this is going to be a synchronous.

343
00:27:34.600 --> 00:27:36.790
But you're going to call it here.

344
00:27:37.830 --> 00:27:38.850
Call this.

345
00:27:40.030 --> 00:27:40.780
Function.

346
00:27:41.170 --> 00:27:41.590
Okay?

347
00:27:41.800 --> 00:27:44.410
And in this case, we can use a weight.

348
00:27:46.760 --> 00:27:50.360
First we need to get a reference, as we did before.

349
00:27:51.810 --> 00:27:55.640
So we just say dock for the address and the address.

350
00:27:55.650 --> 00:28:07.230
If you remember, we're using dock from Firebase Forest Store, which gets a DPI and a user collection

351
00:28:07.380 --> 00:28:11.040
and we need to add the user ID.

352
00:28:13.860 --> 00:28:15.120
Uh, if you're.

353
00:28:15.210 --> 00:28:17.250
We can get the user.

354
00:28:18.680 --> 00:28:23.180
From this off we can get the user so we just say cons.

355
00:28:25.300 --> 00:28:26.110
Off.

356
00:28:26.470 --> 00:28:26.830
Sorry.

357
00:28:26.860 --> 00:28:29.850
User is a user.

358
00:28:29.860 --> 00:28:33.550
Or you can get the uid directly.

359
00:28:35.110 --> 00:28:40.690
We just say off the current user dot provider data.

360
00:28:41.980 --> 00:28:44.140
And the first array.

361
00:28:47.760 --> 00:28:51.960
And inside this week I want to get the user ID.

362
00:28:54.140 --> 00:28:56.210
So we can use this one here.

363
00:28:58.400 --> 00:28:58.770
Okay.

364
00:28:59.540 --> 00:29:00.970
Now we have the dock ref.

365
00:29:01.010 --> 00:29:02.240
We can now.

366
00:29:04.380 --> 00:29:06.570
Get the snapshot.

367
00:29:06.930 --> 00:29:08.970
I get the document.

368
00:29:11.640 --> 00:29:24.930
So just the cons doc snap which is going to be a weight because the git doc needs a weight and it's

369
00:29:24.930 --> 00:29:25.170
good.

370
00:29:25.170 --> 00:29:27.300
Dark is coming from firebase.

371
00:29:28.910 --> 00:29:29.960
File store.

372
00:29:31.740 --> 00:29:34.530
Which gets to this reference.

373
00:29:37.110 --> 00:29:37.260
Okay.

374
00:29:37.410 --> 00:29:40.950
Now we can check if the person is existed.

375
00:29:42.240 --> 00:29:43.110
Again.

376
00:29:43.110 --> 00:29:47.180
We just said, Doc, snap dot.

377
00:29:47.880 --> 00:29:52.110
This is just a double check because we have already know that the user is existed.

378
00:29:53.230 --> 00:29:57.520
So just say if the person exists.

379
00:29:59.280 --> 00:30:04.650
Then we want to save this information, the user data.

380
00:30:06.470 --> 00:30:09.410
To a global state.

381
00:30:09.410 --> 00:30:11.780
So let's create a global state here.

382
00:30:14.890 --> 00:30:18.820
So it's going to be this, we call it.

383
00:30:19.970 --> 00:30:22.160
Current user.

384
00:30:25.270 --> 00:30:29.230
And they use the set current user to change it.

385
00:30:32.160 --> 00:30:36.150
And this is going to be equal use recoil estate.

386
00:30:36.720 --> 00:30:39.320
But the initial value is the.

387
00:30:40.680 --> 00:30:42.860
We have to define it inside the atom.

388
00:30:42.870 --> 00:30:54.240
So initial value here, we need to create another file called user atom JS and this is going to be similar

389
00:30:54.240 --> 00:30:56.100
to the model atom.

390
00:30:56.100 --> 00:30:57.570
So we copy this.

391
00:30:59.270 --> 00:30:59.400
Okay.

392
00:30:59.990 --> 00:31:02.060
So we have imported atom.

393
00:31:03.660 --> 00:31:04.860
From Recoil.

394
00:31:05.310 --> 00:31:08.040
The name is User State.

395
00:31:09.840 --> 00:31:17.250
The key is user state and the default value is null, which means no user.

396
00:31:18.240 --> 00:31:19.320
Now we can.

397
00:31:20.180 --> 00:31:21.490
Important here.

398
00:31:21.500 --> 00:31:26.150
So we just say user state which is coming from atom user at.

399
00:31:28.860 --> 00:31:30.210
They have imported here.

400
00:31:31.050 --> 00:31:32.670
Now we can.

401
00:31:33.390 --> 00:31:35.340
This is now null.

402
00:31:35.940 --> 00:31:38.250
We can use set current user.

403
00:31:39.460 --> 00:31:46.240
Here to set it to the current user that we got from the document.

404
00:31:47.260 --> 00:31:50.260
We can do it by just say doc, snap.

405
00:31:51.450 --> 00:31:52.440
That data.

406
00:31:55.850 --> 00:31:56.310
Okay.

407
00:31:57.690 --> 00:32:00.750
Now we have the current user in the global state.

408
00:32:04.290 --> 00:32:07.440
So let me console.log and you see the results.

409
00:32:08.160 --> 00:32:10.680
So if you console.log current.

410
00:32:12.550 --> 00:32:13.420
User.

411
00:32:17.640 --> 00:32:24.150
I was still getting an error because we use this session so let's change them.

412
00:32:25.770 --> 00:32:32.910
Lets me search for session and anywhere we have session we should change it to current user because

413
00:32:32.910 --> 00:32:35.990
session was from next off package.

414
00:32:36.000 --> 00:32:39.060
Now we are getting this global estate.

415
00:32:40.720 --> 00:32:48.490
So here in this image source, we should choose current user, we can protect it and instead of image

416
00:32:48.490 --> 00:32:49.480
we save it.

417
00:32:49.600 --> 00:32:52.180
I think user img.

418
00:32:54.530 --> 00:32:58.700
And we don't have any session anymore.

419
00:32:58.700 --> 00:32:59.210
But.

420
00:33:00.060 --> 00:33:01.620
Sign out on signing.

421
00:33:01.620 --> 00:33:09.870
We should create a use firebase instead because sign out and signing this sign or signing was from next

422
00:33:09.870 --> 00:33:11.070
off package.

423
00:33:12.410 --> 00:33:18.200
So for the sign out, we create a function called on sign out.

424
00:33:19.410 --> 00:33:25.120
And for the site end, we just we can just redirect the person to the sign in page.

425
00:33:25.750 --> 00:33:30.100
So we can just use the router.

426
00:33:30.710 --> 00:33:33.380
So we just say rather dot push.

427
00:33:39.610 --> 00:33:43.480
And this is going to off sign.

428
00:33:46.230 --> 00:33:47.040
Sign it.

429
00:33:48.510 --> 00:33:51.690
Let me just see that we have router here or not.

430
00:33:52.760 --> 00:33:59.750
We already have routers so we can use it and let's create the sign out function as well.

431
00:34:00.560 --> 00:34:06.020
So we create a function and we call it on sign out.

432
00:34:09.270 --> 00:34:21.450
This is going to use the sign out method from Firebase or slash off which coins which is which it gets

433
00:34:21.450 --> 00:34:22.140
off.

434
00:34:27.540 --> 00:34:28.740
And.

435
00:34:37.180 --> 00:34:37.740
Okay.

436
00:34:38.810 --> 00:34:44.000
And after that, we need to set the current user to know when after sign out.

437
00:34:44.420 --> 00:34:45.800
Let's try this.

438
00:34:47.320 --> 00:34:48.640
So deep is not defined.

439
00:34:48.640 --> 00:34:50.980
So we need to import DP as well.

440
00:34:52.920 --> 00:34:56.340
We chose to import DP.

441
00:34:57.530 --> 00:34:59.300
From Firebase.

442
00:35:02.810 --> 00:35:04.000
It's already signing.

443
00:35:04.280 --> 00:35:08.260
It's working so we can click on the person and sign out.

444
00:35:09.990 --> 00:35:15.210
As you can see, the set up is not the font that I was a little bit suspicious about this.

445
00:35:15.210 --> 00:35:22.740
So I was thinking a little bit we need because it's this one is inside use effect we need to bring this

446
00:35:22.740 --> 00:35:23.880
outside.

447
00:35:26.510 --> 00:35:27.770
And.

448
00:35:28.960 --> 00:35:29.800
I can't find.

449
00:35:31.690 --> 00:35:34.520
Let's click again now via sign out.

450
00:35:34.540 --> 00:35:36.010
Let's sign in again.

451
00:35:38.350 --> 00:35:39.250
The.

452
00:35:41.950 --> 00:35:42.610
Okay.

453
00:35:45.050 --> 00:35:47.360
Because the is no person.

454
00:35:47.360 --> 00:35:49.760
So the current user is not accessed.

455
00:35:49.760 --> 00:35:51.560
So we need to protect this.

456
00:35:53.640 --> 00:35:54.060
Okay.

457
00:35:56.680 --> 00:35:58.350
Now we are in the signing page.

458
00:35:58.360 --> 00:35:59.650
Let's sign in.

459
00:36:02.590 --> 00:36:04.540
Request action is invalid.

460
00:36:06.240 --> 00:36:07.440
Let's try again.

461
00:36:10.650 --> 00:36:12.280
Let me see.

462
00:36:12.300 --> 00:36:13.260
I think.

463
00:36:19.280 --> 00:36:22.040
Let's try refresh the page.

464
00:36:25.470 --> 00:36:26.310
Now it's working.

465
00:36:26.310 --> 00:36:27.960
I think we need to refresh the page.

466
00:36:28.230 --> 00:36:33.210
So now we go to my Gmail account, for example, this one.

467
00:36:34.600 --> 00:36:36.200
We should see it quick.

468
00:36:38.820 --> 00:36:39.370
Yeah.

469
00:36:39.390 --> 00:36:40.650
What's this error?

470
00:36:41.850 --> 00:36:43.710
Can I see the property of.

471
00:36:54.780 --> 00:36:59.700
So let's go to header 23.

472
00:37:04.350 --> 00:37:08.490
That's because the user ID is sometimes is not defined.

473
00:37:08.820 --> 00:37:10.320
So we get an error.

474
00:37:16.180 --> 00:37:19.360
Now let's console.log a user here.

475
00:37:21.020 --> 00:37:22.350
I want to see what's inside.

476
00:37:22.370 --> 00:37:24.890
User Maybe we don't need even to.

477
00:37:28.560 --> 00:37:31.740
Use to get it us.

478
00:37:31.770 --> 00:37:33.840
So just cancel console.log user.

479
00:37:35.530 --> 00:37:37.510
And we call it user.

480
00:37:44.690 --> 00:37:45.350
Okay.

481
00:37:45.650 --> 00:37:47.330
Let's try this.

482
00:37:49.180 --> 00:37:50.500
The user.

483
00:37:53.260 --> 00:37:57.640
As it has, actually.

484
00:38:00.280 --> 00:38:00.960
Let's see.

485
00:38:01.840 --> 00:38:04.030
It has the offline side, actually.

486
00:38:08.390 --> 00:38:12.440
Let's sign out the person and then we see the new one.

487
00:38:12.560 --> 00:38:13.400
That's enough.

488
00:38:14.030 --> 00:38:14.480
Okay.

489
00:38:22.840 --> 00:38:33.730
So instead of getting the user ID from here, we can get rid of this and we just say user dot off.

490
00:38:34.790 --> 00:38:38.210
Dot's current user dot.

491
00:38:40.670 --> 00:38:41.630
Provider.

492
00:38:41.630 --> 00:38:42.920
Provider.

493
00:38:45.340 --> 00:38:46.660
Let me check again.

494
00:38:47.740 --> 00:38:48.760
It's signing.

495
00:39:11.170 --> 00:39:12.160
Now that's.

496
00:39:13.630 --> 00:39:14.830
Same error.

497
00:39:21.150 --> 00:39:22.830
I want to see the user.

498
00:39:26.060 --> 00:39:27.010
This is the user.

499
00:39:27.020 --> 00:39:28.370
So we have the.

500
00:39:30.070 --> 00:39:31.840
Off and off.

501
00:39:31.840 --> 00:39:33.430
We have current users.

502
00:39:33.460 --> 00:39:36.070
Then we have provider data.

503
00:39:37.570 --> 00:39:40.180
And the first array we have the user ID.

504
00:39:40.180 --> 00:39:40.930
So.

505
00:39:42.190 --> 00:39:43.600
Provider date.

506
00:39:44.050 --> 00:39:48.690
So provider data, the first one.

507
00:39:50.850 --> 00:39:51.330
Okay.

508
00:39:52.560 --> 00:39:54.210
Let's try again now.

509
00:39:58.090 --> 00:39:59.470
So sign out.

510
00:39:59.590 --> 00:40:00.910
The user is null.

511
00:40:01.720 --> 00:40:03.040
Sign in.

512
00:40:14.370 --> 00:40:14.960
Okay.

513
00:40:14.970 --> 00:40:16.230
Signed in.

514
00:40:18.170 --> 00:40:19.850
Let's see the user.

515
00:40:26.110 --> 00:40:26.410
Okay.

516
00:40:28.040 --> 00:40:28.870
Now.

517
00:40:31.190 --> 00:40:34.280
They have the user and there's no error.

518
00:40:34.280 --> 00:40:36.950
Actually, it's just a fish the page.

519
00:41:00.270 --> 00:41:02.280
Provide data.

520
00:41:08.740 --> 00:41:14.410
You have imported stock, imported, uh, everything.

521
00:41:34.540 --> 00:41:37.270
Uh, should be okay.

522
00:42:17.570 --> 00:42:18.830
It's signed in.

523
00:42:31.960 --> 00:42:33.670
Still doesn't work.

524
00:42:35.180 --> 00:42:35.820
Let me see.

525
00:42:35.840 --> 00:42:37.400
What's the problem?

526
00:42:37.910 --> 00:42:39.860
So we got the DP.

527
00:42:41.900 --> 00:42:46.820
And then we have the users and this is a user ID.

528
00:43:08.670 --> 00:43:09.120
Oh.

529
00:43:09.390 --> 00:43:12.360
Actually, we should add the user ID at the end.

530
00:43:13.600 --> 00:43:14.350
Okay.

531
00:43:14.620 --> 00:43:15.790
So that was the problem.

532
00:43:16.600 --> 00:43:18.150
So let's try again.

533
00:43:18.160 --> 00:43:22.990
Now we see the person now signing again.

534
00:43:28.450 --> 00:43:29.440
It should work.

535
00:43:32.380 --> 00:43:34.110
You're getting the same thing.

536
00:43:35.930 --> 00:43:38.090
But are getting the person at the top.

537
00:44:05.310 --> 00:44:06.130
Let's see.

538
00:44:06.150 --> 00:44:09.060
We have access to the user here.

539
00:44:12.760 --> 00:44:14.470
It's just console.log.

540
00:44:15.730 --> 00:44:20.230
Let's delete the console log here and.

541
00:44:22.370 --> 00:44:25.340
That's costs a lot the user.

542
00:44:35.110 --> 00:44:35.520
Okay.

543
00:44:37.810 --> 00:44:39.310
Let's try this.

544
00:44:40.100 --> 00:44:41.110
Start fresh.

545
00:44:44.440 --> 00:44:45.100
No, no, no.

546
00:44:45.210 --> 00:44:45.880
We didn't.

547
00:44:45.920 --> 00:44:46.730
We didn't get any.

548
00:44:49.580 --> 00:44:52.310
Just check the console.

549
00:45:02.970 --> 00:45:04.980
A child should have a key.

550
00:45:08.690 --> 00:45:09.710
That's not important.

551
00:45:09.710 --> 00:45:10.430
So.

552
00:45:14.360 --> 00:45:14.690
Okay.

553
00:45:14.690 --> 00:45:16.490
We are getting a user here.

554
00:45:19.850 --> 00:45:21.800
If a site out.

555
00:45:37.460 --> 00:45:38.650
If you don't have access.

556
00:45:38.650 --> 00:45:41.050
So we don't have to use a sign and.

557
00:45:54.180 --> 00:45:55.610
No, we're not getting an error.

558
00:45:55.620 --> 00:45:57.660
I don't know what happened.

559
00:45:58.730 --> 00:46:00.290
We have the user data.

560
00:46:03.170 --> 00:46:03.360
Okay.

561
00:46:03.380 --> 00:46:04.090
Let's continue.

562
00:46:04.100 --> 00:46:06.440
If we get the same error, are going to check it.

563
00:46:06.440 --> 00:46:07.250
But, uh.

564
00:46:07.670 --> 00:46:08.510
I don't know.

565
00:46:09.210 --> 00:46:10.460
Let's refresh.

566
00:46:12.320 --> 00:46:13.120
That's okay.

567
00:46:13.140 --> 00:46:13.650
Now.

568
00:46:16.770 --> 00:46:25.050
Now after the header we can change the, for example, post component, a storage component and also

569
00:46:25.050 --> 00:46:27.120
the menu profile on the right side.

570
00:46:27.660 --> 00:46:33.840
But this time we don't need to use a user effect to fetch the data.

571
00:46:33.870 --> 00:46:44.010
We can just use the global estate you current user to get the current user and show it inside the post

572
00:46:44.010 --> 00:46:44.910
and etc..

573
00:46:45.390 --> 00:46:52.340
So let's go back to Visual Studio code and inside post Dutch as.

574
00:46:55.260 --> 00:47:06.240
At first we just get rid of the use session and the session from next of package and here.

575
00:47:07.320 --> 00:47:12.210
Instead we just get the current user.

576
00:47:18.310 --> 00:47:19.480
Which is coming.

577
00:47:19.630 --> 00:47:21.520
We can get it from use.

578
00:47:22.630 --> 00:47:24.490
Recoil state.

579
00:47:29.230 --> 00:47:30.910
Which is from recoil.

580
00:47:32.020 --> 00:47:41.020
And also we need to import user status for which is user atom, which is coming from user at.

581
00:47:41.290 --> 00:47:41.650
Okay.

582
00:47:41.770 --> 00:47:43.630
Now we have the current user.

583
00:47:43.840 --> 00:47:47.140
We just need to replace current user.

584
00:47:48.050 --> 00:47:50.870
Uh, it's just, uh, replace a session anywhere.

585
00:47:50.870 --> 00:47:52.070
We have session.

586
00:47:52.310 --> 00:47:54.290
We change it to current user.

587
00:47:54.650 --> 00:47:59.540
So this is going to be current user B protected user ID.

588
00:48:00.480 --> 00:48:01.610
Here as well.

589
00:48:01.620 --> 00:48:02.430
We have.

590
00:48:04.660 --> 00:48:11.500
But this this one at this one is to use a name.

591
00:48:13.060 --> 00:48:14.380
Let's check.

592
00:48:15.740 --> 00:48:16.520
They have.

593
00:48:18.130 --> 00:48:18.710
Yeah.

594
00:48:19.330 --> 00:48:22.240
So we don't need to next off package anymore.

595
00:48:23.110 --> 00:48:25.630
And the image is the user image.

596
00:48:29.440 --> 00:48:30.100
Okay.

597
00:48:30.850 --> 00:48:34.930
Let's check the next one here, which is, say, current user.

598
00:48:36.880 --> 00:48:38.320
And.

599
00:48:40.660 --> 00:48:43.120
They have here current user.

600
00:48:46.540 --> 00:48:48.640
So we don't have any session.

601
00:48:50.620 --> 00:48:51.940
Let's see if.

602
00:48:52.480 --> 00:48:53.920
Let's go to.

603
00:48:55.300 --> 00:48:55.930
Now.

604
00:48:55.930 --> 00:48:58.210
Now, actually, now we can like.

605
00:48:59.150 --> 00:49:02.750
And leave a comment like somebody just said.

606
00:49:02.750 --> 00:49:03.690
Tax.

607
00:49:04.280 --> 00:49:07.520
Och, amazing.

608
00:49:11.460 --> 00:49:13.950
That does it for the post.

609
00:49:14.970 --> 00:49:15.960
Section.

610
00:49:17.370 --> 00:49:22.500
Let's do the menu profile and the feed section.

611
00:49:23.520 --> 00:49:27.300
So we just need to go to feed the cheese.

612
00:49:27.880 --> 00:49:33.390
Here we get rid of the next off and the session.

613
00:49:34.830 --> 00:49:37.410
And here we just need to.

614
00:49:38.390 --> 00:49:39.580
Get the.

615
00:49:41.010 --> 00:49:47.520
Current user, you just say current user, which is equal to use.

616
00:49:48.580 --> 00:49:49.900
Recoil.

617
00:49:52.370 --> 00:50:01.090
The state, which is coming from recoil and we need to get the initial value from the atom, user,

618
00:50:01.090 --> 00:50:04.030
atom and everywhere.

619
00:50:04.030 --> 00:50:06.790
We should just replace this session.

620
00:50:06.790 --> 00:50:08.110
So here is session.

621
00:50:08.110 --> 00:50:09.080
Just replace it.

622
00:50:09.160 --> 00:50:10.270
Current user.

623
00:50:11.440 --> 00:50:13.040
Next place.

624
00:50:13.060 --> 00:50:15.200
Oh, we don't have anything else.

625
00:50:15.220 --> 00:50:16.120
That's fine.

626
00:50:21.000 --> 00:50:22.080
Let's see.

627
00:50:22.080 --> 00:50:23.910
Now we have this part.

628
00:50:25.570 --> 00:50:28.780
Now let's go to menu for file.

629
00:50:34.080 --> 00:50:37.380
So let's first get rid of this session.

630
00:50:38.780 --> 00:50:40.040
And next off.

631
00:50:42.370 --> 00:50:44.770
And let's bring the.

632
00:50:46.770 --> 00:50:48.180
Current user.

633
00:50:49.980 --> 00:50:51.330
Using use.

634
00:50:52.320 --> 00:50:54.660
Recoil states.

635
00:50:55.560 --> 00:51:02.610
Just coming from recoil and the initial value is user state which is come from user atom.

636
00:51:04.530 --> 00:51:06.090
So let's.

637
00:51:08.440 --> 00:51:11.320
Let's change the situation here.

638
00:51:12.170 --> 00:51:16.730
So at this quantity user and this image is user img.

639
00:51:19.450 --> 00:51:21.310
Then we have the username.

640
00:51:25.120 --> 00:51:26.350
Okay, that's finished.

641
00:51:26.350 --> 00:51:30.840
But the sign out, we need to use the firebase instead.

642
00:51:30.850 --> 00:51:35.830
So just change this one to on sign out and we create the function at the top.

643
00:51:36.670 --> 00:51:47.020
So here we create a function, we call it on sign out and this is going to call the sign out method

644
00:51:47.020 --> 00:51:54.850
from Firebase Off, which is going to get off and we need to create the off here as well.

645
00:51:54.850 --> 00:52:06.640
So we just say off equals to get off from Firebase Off now we need to call it.

646
00:52:07.480 --> 00:52:11.470
And after that we need to set the current user.

647
00:52:11.470 --> 00:52:12.940
We need to bring it here.

648
00:52:12.940 --> 00:52:13.690
Set.

649
00:52:14.900 --> 00:52:21.590
Current user, we set the current user to NULL.

650
00:52:23.630 --> 00:52:23.870
Okay.

651
00:52:23.900 --> 00:52:24.980
Let's try.

652
00:52:25.940 --> 00:52:27.680
So looks okay.

653
00:52:27.740 --> 00:52:28.880
Let's sign out.

654
00:52:29.690 --> 00:52:30.080
Okay.

655
00:52:30.110 --> 00:52:31.040
It's working.

656
00:52:31.760 --> 00:52:32.990
Sign in again.

657
00:52:39.800 --> 00:52:40.160
Okay.

658
00:52:40.300 --> 00:52:42.440
Let's try this account.

659
00:52:45.510 --> 00:52:45.990
Okay.

660
00:52:46.820 --> 00:52:55.970
It's showing correctly and also in the post Mr. can like this like that's fine.

661
00:52:58.800 --> 00:53:01.770
The next part is this story section.

662
00:53:02.940 --> 00:53:07.860
So let's go to a story that is.

663
00:53:11.090 --> 00:53:16.070
I think here we don't need to any change to stories that are here.

664
00:53:17.450 --> 00:53:20.330
That's the same same procedure.

665
00:53:20.330 --> 00:53:25.190
We just get out of the next off and we just bring the.

666
00:53:27.510 --> 00:53:33.390
Current user from use recoil state.

667
00:53:36.230 --> 00:53:37.790
Which is coming from recoil.

668
00:53:37.790 --> 00:53:43.520
And the initial value is the user state, which is coming from user atom.

669
00:53:45.140 --> 00:53:49.520
And anywhere we have sessions, we change it to content user.

670
00:53:50.790 --> 00:53:57.750
So this is current user protection and user image.

671
00:54:00.110 --> 00:54:04.590
This fund is used.

672
00:54:08.520 --> 00:54:09.960
Everything else is okay.

673
00:54:12.760 --> 00:54:13.850
Let's see.

674
00:54:13.880 --> 00:54:15.850
Yeah, they have the image here.

675
00:54:16.570 --> 00:54:16.890
Yeah.

676
00:54:20.610 --> 00:54:24.900
Uh, the only place is left is this model.

677
00:54:25.380 --> 00:54:26.280
Now.

678
00:54:28.120 --> 00:54:32.050
The model is using the next off.

679
00:54:32.440 --> 00:54:34.900
So let's go to model.

680
00:54:38.050 --> 00:54:42.160
I think it's called a upload model, that is.

681
00:54:44.180 --> 00:54:45.170
And here.

682
00:54:46.920 --> 00:54:47.970
Same as before.

683
00:54:47.970 --> 00:54:53.850
We'd get rid of use session and session and we import.

684
00:54:57.030 --> 00:54:57.210
No.

685
00:54:57.210 --> 00:54:58.740
Sorry, not import.

686
00:54:58.740 --> 00:55:03.690
We just get the current user.

687
00:55:05.680 --> 00:55:10.240
Using use recoil a state which is common.

688
00:55:11.730 --> 00:55:13.260
We already imported.

689
00:55:14.430 --> 00:55:21.870
Yeah, it's quite a state and we need to import a user state for the initial value.

690
00:55:24.890 --> 00:55:25.940
And.

691
00:55:26.730 --> 00:55:29.010
Let's see where we have session here.

692
00:55:29.010 --> 00:55:30.210
We have session.

693
00:55:33.590 --> 00:55:37.940
This font and this is going to be user image.

694
00:55:41.140 --> 00:55:42.370
No, that's finished.

695
00:55:43.920 --> 00:55:45.120
So let's try.

696
00:55:46.450 --> 00:55:48.970
Let me upload something.

697
00:55:50.830 --> 00:55:54.790
For example, I chose this image.

698
00:55:57.580 --> 00:55:59.650
Well, let me try another one.

699
00:56:00.190 --> 00:56:08.110
For example, this one it just say next JS project.

700
00:56:10.200 --> 00:56:11.670
Upload the post.

701
00:56:17.250 --> 00:56:18.960
So now.

702
00:56:19.230 --> 00:56:20.610
Yeah, it's working.

703
00:56:22.010 --> 00:56:23.420
Kind of like it became.

704
00:56:25.370 --> 00:56:27.790
The comment, for example, test.

705
00:56:29.340 --> 00:56:29.820
Okay.

706
00:56:34.990 --> 00:56:39.040
So the only thing that is bothering me is this typo Instagram.

707
00:56:39.370 --> 00:56:42.520
This is inside the index.

708
00:56:42.520 --> 00:56:44.020
That is.

709
00:56:45.170 --> 00:56:46.760
Here in the title.

710
00:56:50.680 --> 00:56:51.910
That was it for this part.

711
00:56:51.920 --> 00:57:00.040
Let's add this one to get her up and deployed again to our final.

712
00:57:02.230 --> 00:57:10.510
Final version, which is instead of version four is the version 400.

713
00:57:11.620 --> 00:57:13.600
Projects.

714
00:57:13.600 --> 00:57:15.580
Dot dot com.

715
00:57:16.180 --> 00:57:18.040
The 100 jazz projects.

716
00:57:22.110 --> 00:57:26.460
So in our final version, we're still using next of.

717
00:57:29.170 --> 00:57:33.790
And still they have the typo and everything.

718
00:57:33.790 --> 00:57:43.720
So firstly we stop the server, we get, we add everything to GitHub, we add a message.

719
00:57:45.150 --> 00:57:47.520
By using git commit.

720
00:57:48.690 --> 00:57:52.800
And the message would be, for example.

721
00:57:54.540 --> 00:57:56.330
It's the.

722
00:57:57.510 --> 00:57:59.190
Update number two.

723
00:57:59.190 --> 00:58:02.070
And the message is.

724
00:58:04.790 --> 00:58:05.600
At.

725
00:58:07.900 --> 00:58:11.110
Fire face off.

726
00:58:14.020 --> 00:58:16.720
Is Ted off?

727
00:58:18.270 --> 00:58:19.530
Next of.

728
00:58:23.450 --> 00:58:23.960
Okay.

729
00:58:23.960 --> 00:58:26.050
And we push it to get her.

730
00:58:29.240 --> 00:58:31.640
Let's go to Verso.

731
00:58:35.090 --> 00:58:42.830
So the search for Pursell records the virtual dot com let me sign in with my GitHub.

732
00:58:48.390 --> 00:58:57.090
So now for instance for a see that just now added a new commit and I think automatically deployment

733
00:58:57.090 --> 00:58:57.930
starts.

734
00:58:58.260 --> 00:59:05.370
So in the deployment tab we are building the website and 22nd test.

735
00:59:05.940 --> 00:59:08.190
So let's click on this.

736
00:59:10.460 --> 00:59:13.010
As soon as it's finished, it gives us the.

737
00:59:16.780 --> 00:59:17.830
Final version.

738
00:59:17.830 --> 00:59:20.500
And also we need to change something here.

739
00:59:21.860 --> 00:59:23.390
So the building finished.

740
00:59:24.980 --> 00:59:26.120
And.

741
00:59:26.990 --> 00:59:31.470
And this is going to be applied to insta version four.

742
00:59:31.490 --> 00:59:33.890
So let's refresh the page here.

743
00:59:34.790 --> 00:59:35.120
Yeah.

744
00:59:35.120 --> 00:59:38.000
It's you can see now we have the new version.

745
00:59:38.420 --> 00:59:39.980
Let's sign in now.

746
00:59:41.410 --> 00:59:43.770
We click our sign in which Google.

747
00:59:47.570 --> 00:59:54.920
As you can see, the error, the reason we didn't get the pop up because we need to add this domain.

748
59:57.150 --> 1:00:01.830
We just copy this dummy and we go to.

749
1:00:03.680 --> 1:00:08.420
Often authentication tap into firebase and in signing method.

750
1:00:08.420 --> 1:00:10.280
We should add it here before.

751
1:00:10.280 --> 1:00:17.060
If you remember we went to the console, but because we are using Google Firebase Authentication, we

752
1:00:17.060 --> 1:00:19.940
need to add it here in authorized domains.

753
1:00:20.630 --> 1:00:28.010
As you can see, the authorized domains is just a local host in subversion for Firebase app and also

754
1:00:28.040 --> 1:00:28.730
this one.

755
1:00:28.910 --> 1:00:32.510
So we add another one install version for.

756
1:00:37.390 --> 1:00:38.140
Had it.

757
1:00:40.190 --> 1:00:40.670
Now.

758
1:00:40.670 --> 1:00:42.800
Let's try it again.

759
1:00:44.120 --> 1:00:45.530
Let's refresh the page.

760
1:00:48.410 --> 1:00:49.460
This signing.

761
1:00:50.780 --> 1:00:51.620
It's working.

762
1:00:51.680 --> 1:00:54.860
So now we can put up a sign with this account.

763
1:00:57.670 --> 1:01:00.070
And it's working as before.

764
1:01:00.410 --> 1:01:00.980
Okay.

765
1:01:03.020 --> 1:01:03.200
Yeah.

766
1:01:03.230 --> 1:01:06.040
That was it for the Firebase Authentication.

767
1:01:06.050 --> 1:01:07.940
I hope you enjoy it and learn.

768
1:01:09.950 --> 1:01:10.580
Many things.

769
1:01:10.580 --> 1:01:18.890
If you have any problem of because we have changed many things, you can just go to the page for the

770
1:01:18.890 --> 1:01:19.820
GitHub.

771
1:01:21.260 --> 1:01:28.100
GitHub dot com my name and I think it's in insta.

772
1:01:29.450 --> 1:01:30.980
Version four.

773
1:01:32.760 --> 1:01:34.410
So let's try it.

774
1:01:35.100 --> 1:01:35.610
Yeah.

775
1:01:35.850 --> 1:01:42.900
You can go to the comet and the, the last one which is update to.

776
1:01:45.340 --> 1:01:49.860
And you can see all the changes I have done.

777
1:01:49.870 --> 1:01:58.570
For example, I have created the user at home in the FT that for example, as I deleted the use session

778
1:01:58.570 --> 1:02:06.910
and session and added to use Recoil and I got the current user so you can see the changes.

779
1:02:07.870 --> 1:02:09.520
So if you have.

780
1:02:11.010 --> 1:02:13.470
Any problem of the codes.

781
1:02:13.470 --> 1:02:15.600
You can check this comment.

782
1:02:16.550 --> 1:02:17.150
On it.

783
1:02:18.020 --> 1:02:19.250
And also you can.

784
1:02:20.330 --> 1:02:24.740
Contact me through the Q&amp;A or the comment section.

785
1:02:27.640 --> 1:02:28.000
Okay.

786
1:02:28.360 --> 1:02:31.120
That was the for this update.

787
1:02:31.120 --> 1:02:37.300
In the next update, I'm going to add the rules and also I'm going to create some specific page for

788
1:02:37.300 --> 1:02:42.520
the users and add more functionality to this project.

789
1:02:43.000 --> 1:02:48.310
So see you next time for the next update.
