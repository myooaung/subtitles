WEBVTT
1
00:00:01.040 --> 00:00:03.500
[Autogenerated] the containers need a little extra help in

2
00:00:03.500 --> 00:00:06.850
order to access our database inside the RDS.

3
00:00:06.850 --> 00:00:07.730
Instance.

4
00:00:07.730 --> 00:00:11.240
First, I want to explain what's going on, what needs to happen.

5
00:00:11.240 --> 00:00:14.540
And then we'll make the fix, which is actually pretty quick,

6
00:00:14.540 --> 00:00:19.650
even though the containers art in the same VPC as the RTs database.

7
00:00:19.650 --> 00:00:20.640
Instance.

8
00:00:20.640 --> 00:00:23.150
In other words, in the same private network,

9
00:00:23.150 --> 00:00:26.890
we still have security inside the network as well.

10
00:00:26.890 --> 00:00:33.310
So we need to explicitly change the security group for the RDS instance to

11
00:00:33.310 --> 00:00:38.480
allow access from the containers which are protected by the security group

12
00:00:38.480 --> 00:00:41.670
of the load balancer that's in front of them.

13
00:00:41.670 --> 00:00:44.480
But there is a chance that there's more than one

14
00:00:44.480 --> 00:00:47.200
security group for the load balancer.

15
00:00:47.200 --> 00:00:51.720
It would be a pain toe have to define inbound rules for all of the

16
00:00:51.720 --> 00:00:54.840
possible security groups on the load balancer.

17
00:00:54.840 --> 00:00:56.040
However,

18
00:00:56.040 --> 00:01:00.920
Fargate also adds all of those load balance or security groups to the

19
00:01:00.920 --> 00:01:05.400
inbound rules for the default security group on the VPC.

20
00:01:05.400 --> 00:01:11.240
That means if the VP sees security group is allowed through than all of those

21
00:01:11.240 --> 00:01:14.770
load balance or security groups will come along for the ride.

22
00:01:14.770 --> 00:01:17.140
In my case, there is only one,

23
00:01:17.140 --> 00:01:19.630
and I can spot it easily when looking at the

24
00:01:19.630 --> 00:01:22.740
security groups in E C two services.

25
00:01:22.740 --> 00:01:26.270
There it ISS with helpful name created by Fargate E.

26
00:01:26.270 --> 00:01:30.880
C s Net core FBI load balancer one.

27
00:01:30.880 --> 00:01:36.000
Let's take a look at that default security group and its inbound rules.

28
00:01:36.000 --> 00:01:40.000
All traffic is allowed from the security group of the load balancer.

29
00:01:40.000 --> 00:01:43.470
So if there were multiple security groups for the load balancer,

30
00:01:43.470 --> 00:01:45.940
they'd all be listed here.

31
00:01:45.940 --> 00:01:49.230
That means I could tell the security group that's protecting

32
00:01:49.230 --> 00:01:53.820
the RTs instance to allow this security group through on Port

33
00:01:53.820 --> 00:01:56.530
14 33 the sequel server port.

34
00:01:56.530 --> 00:02:00.370
And we've gone through this before when we had to allow the elastic being

35
00:02:00.370 --> 00:02:03.910
stock hosted application permission to the databases.

36
00:02:03.910 --> 00:02:06.090
Well, but as a reminder,

37
00:02:06.090 --> 00:02:11.450
the easiest way to discover the correct security group is to go into the

38
00:02:11.450 --> 00:02:16.470
pleural site sequel are deists Instance in the console the security group were

39
00:02:16.470 --> 00:02:21.010
looking for is listed here under VPC security groups.

40
00:02:21.010 --> 00:02:23.040
I'll select that security group,

41
00:02:23.040 --> 00:02:27.810
then I'll go to its inbound rules and then I'll click the Edit Inbound Rules

42
00:02:27.810 --> 00:02:33.330
button and then add Rule will use the M s sequel shortcut and that sets the

43
00:02:33.330 --> 00:02:38.480
protocol to TCP and the port to 14 33 and in the source.

44
00:02:38.480 --> 00:02:41.970
We need to list the security group that we want to allow in.

45
00:02:41.970 --> 00:02:46.840
So start typing that into filter, and there it is the default security group.

46
00:02:46.840 --> 00:02:50.470
And then I can scroll further down on the page to the Save Rules button.

47
00:02:50.470 --> 00:02:55.740
The nice thing here is the new rule goes into effect immediately so I can

48
00:02:55.740 --> 00:02:59.010
go back to the browser window that timed out earlier,

49
00:02:59.010 --> 00:03:01.090
and I'll refresh the page for the authors,

50
00:03:01.090 --> 00:03:03.220
controller and tutta.

51
00:03:03.220 --> 00:03:09.840
Finally, there's my data, and again, I really only just made one small change.

52
00:03:09.840 --> 00:03:14.170
But I wanted you to understand what I was doing and why.

53
00:03:14.170 --> 00:03:17.050
That way, the next time you have to do that,

54
00:03:17.050 --> 00:03:22.000
it will hopefully feel like a quick and easy step. Perform

