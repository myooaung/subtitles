WEBVTT
1

00:00:05.420 --> 00:00:07.900

A case you cut some code that should run.



2

00:00:08.000 --> 00:00:13.810

So let's run the app a few times and see what happens when we don't know and accept the permissions.



3

00:00:13.850 --> 00:00:18.480

Now I'm going to be running this on our IPR 27 emulator that was set up previously.



4

00:00:18.500 --> 00:00:24.590

Now we know that it worked on the IPO 21 works the IPO 22 and below that we tested again on that version.



5

00:00:24.590 --> 00:00:29.720

Once everything is finished it is a good idea to retest when you make changes to cater for particular



6

00:00:29.750 --> 00:00:35.090

Android versions just in case the changes break something in the early versions but we'll leave that



7

00:00:35.090 --> 00:00:39.830

final testing on IPR 21 and two we've made all the changes we need to make.



8

00:00:40.190 --> 00:00:43.780

So the first thing I've done is start by IP 4:27 emulator.



9

00:00:43.910 --> 00:00:49.800

I'm going to make sure that the apps that installed and I'm going to do here is quite to their content



10

00:00:49.800 --> 00:00:58.070

provider example I'm just going to I want to let starting with a fresh installation so on the same thing



11

00:00:58.070 --> 00:01:07.130

by going into settings and apps notifications that I recorded look for IP and they obviously have deleted



12

00:01:07.180 --> 00:01:07.530

that now.



13

00:01:07.530 --> 00:01:13.910

So that's what we've seen previously that we can get a lot of irrelevant entries into LOLcat.



14

00:01:13.910 --> 00:01:20.050

So I'm going to get back to android studio and open LOLcat but I'm going to filter in on main activity



15

00:01:23.420 --> 00:01:27.070

and I'm going to run the app



16

00:01:30.260 --> 00:01:35.120

and I'm going to try just a floating plane mode as well just to make sure that you're using subtopics



17

00:01:35.120 --> 00:01:43.950

is to say we're doing this so I'll go ahead and do that.



18

00:01:43.970 --> 00:01:45.810

So just to verify Now the app is running.



19

00:01:46.110 --> 00:01:50.900

You can see that it's running here but back in the low cut we can say we've got chick self permission



20

00:01:50.900 --> 00:01:56.720

returned a negative one requesting permission then on create and so I can tell you that the request



21

00:01:56.720 --> 00:02:00.310

permission method has retuned and uncreate has finished.



22

00:02:00.650 --> 00:02:05.900

So my activity now is in the running state and can be destroyed by the Android system if something like



23

00:02:05.900 --> 00:02:07.760

an incoming phone call comes in.



24

00:02:07.760 --> 00:02:11.740

And that's great because the apps not blocking that waits for the user to do with the dialog.



25

00:02:11.900 --> 00:02:13.990

So speaking of the dollar we'll get back and check that out.



26

00:02:13.990 --> 00:02:18.500

We can see the dollar there it's popping up and it says allow content provider example to access your



27

00:02:18.500 --> 00:02:20.670

contacts deny or allow.



28

00:02:20.960 --> 00:02:27.530

So we're going to start here by allowing the permission and we'll see what happens in the lockup in



29

00:02:27.560 --> 00:02:33.360

Sahid that time we've got permission granted basically on request permission results Stott's permission



30

00:02:33.360 --> 00:02:37.340

granted now on request permission results in.



31

00:02:37.830 --> 00:02:38.960

So that's working fine.



32

00:02:38.970 --> 00:02:43.670

And just to confirm that because back to I mean we like to run our clock rather the fab the funny hats



33

00:02:43.720 --> 00:02:47.090

button you can see we've got two entries now showing.



34

00:02:47.310 --> 00:02:47.530

Right.



35

00:02:47.550 --> 00:02:49.470

Next let's see what happens when the app runs.



36

00:02:49.470 --> 00:02:54.830

Now that permission has been granted so it stopped the app and was started again.



37

00:03:01.550 --> 00:03:03.480

And you can see what's happened here and to check.



38

00:03:03.490 --> 00:03:05.540

So permission Materne zero at this time.



39

00:03:05.650 --> 00:03:08.520

Permission granted then uncreate ends.



40

00:03:08.950 --> 00:03:13.690

So this time check self permission to seek and say returned 0 which is permission granted.



41

00:03:13.780 --> 00:03:15.300

So the app is ready to use.



42

00:03:15.490 --> 00:03:19.390

In other words with the raid on the school context permission it needs and if it just confirmed that



43

00:03:19.390 --> 00:03:25.430

by tapping the fighting button it could say we get the results returned and so that's right.



44

00:03:25.570 --> 00:03:29.470

Once the permission has been granted by the user the app keeps that permission.



45

00:03:29.530 --> 00:03:29.780

H.



46

00:03:29.770 --> 00:03:33.280

Thomas launched her let's go to the next test.



47

00:03:33.310 --> 00:03:37.400

We need to uninstall the application and this time we're going to try denying the request.



48

00:03:37.570 --> 00:03:39.050

Well it's got to stop the app.



49

00:03:39.280 --> 00:03:40.490

I'm just going to go into settings



50

00:03:43.090 --> 00:03:47.430

apps and notifications and recently I've been apps he's quite useful stuff.



51

00:03:47.430 --> 00:03:54.040

Click on that and install it on a stone How are starting with a clean slate again.



52

00:03:54.640 --> 00:04:00.800

And if we run it again we should be back to where we were before just checking the logs there.



53

00:04:01.090 --> 00:04:08.770

It starts chick self-perceptions return negative one requesting permission and maybe is now asking for



54

00:04:08.770 --> 00:04:13.290

access to the contents that are not allowed to log.



55

00:04:13.740 --> 00:04:16.420

And again that's as expected because we can install the app.



56

00:04:16.660 --> 00:04:24.700

This time we're going to deny the request and see what happens in our permission refused and ends in



57

00:04:24.820 --> 00:04:25.570

OK.



58

00:04:25.910 --> 00:04:30.870

Now we haven't checked the value of a billion field in the On Click list for the sliding action button.



59

00:04:31.140 --> 00:04:37.220

So consequently when I tapped that we're going to get a fresh there because we haven't got permission



60

00:04:37.580 --> 00:04:39.280

to access the contacts.



61

00:04:39.340 --> 00:04:42.740

We're going to leave you to deal with that a bit later in the next video because that sounds like a



62

00:04:42.740 --> 00:04:46.790

good challenge for next hour before we get to that let's run a few more tests.



63

00:04:46.790 --> 00:04:49.270

So what we're going to do is come back and started again.



64

00:04:54.850 --> 00:05:00.370

Because it's requesting permission again we get back to locate the same a similar dialogue the last



65

00:05:00.370 --> 00:05:06.050

time but this time around here we've got this don't ask again with a checkbox to the left hand side.



66

00:05:06.340 --> 00:05:09.800

So I'm not going to change that just yet but I won't deny the request again.



67

00:05:09.820 --> 00:05:13.100

So let's do that justice.



68

00:05:13.120 --> 00:05:16.300

With the case was last Tom permission refused and that's nothing.



69

00:05:16.300 --> 00:05:20.740

We didn't expect and we're not going to tap on the flying action but we can because we know that it



70

00:05:20.740 --> 00:05:22.710

will just crushed up.



71

00:05:22.990 --> 00:05:25.420

Instead what we'll do is we'll just run up again.



72

00:05:25.600 --> 00:05:27.070

Back to judge studio run it again



73

00:05:31.350 --> 00:05:37.220

same deal with requesting permission and we asked again this time whether we are going to allow permission



74

00:05:37.430 --> 00:05:45.430

to get the same don't ask again box or what's we're going to allow this to have we can see over there



75

00:05:45.440 --> 00:05:51.230

we've got permission granted you know low cut and click on the funding button and surprisingly things



76

00:05:51.230 --> 00:05:52.310

are working.



77

00:05:52.360 --> 00:05:54.350

All right so there's one more test we need to do now.



78

00:05:54.590 --> 00:06:00.580

So I'm going to do is close down the hat this time I'm going to go into settings and revoke the permission.



79

00:06:00.670 --> 00:06:07.840

Remember that tab we've allowed the permission so I'm going to go into settings apps and notifications



80

00:06:07.900 --> 00:06:13.550

going to the content provider example and have it come back to permissions.



81

00:06:13.750 --> 00:06:19.040

You can say you've got contex permission with a slot here and it's currently enabled to the screen by



82

00:06:19.040 --> 00:06:21.560

the way is new in Android Mashpee I want above.



83

00:06:21.560 --> 00:06:26.930

So if you're running this test on an IP or 21:18 either we wouldn't have this option.



84

00:06:27.070 --> 00:06:32.260

And one thing to note is that this option appears because we are running on a device that's using API



85

00:06:32.560 --> 00:06:38.740

23 or however you know if we set the target as Teekay to 21 then how app would be treated by Android



86

00:06:38.740 --> 00:06:40.100

as a legacy app.



87

00:06:40.150 --> 00:06:44.960

And although this option would still be available we'd actually get a warning if we try to change it.



88

00:06:45.370 --> 00:06:50.800

Now that makes sense because apps written before Google changed the security model have no way of dealing



89

00:06:50.800 --> 00:06:52.630

with a permission being revoked.



90

00:06:52.660 --> 00:06:58.860

So the Android framework checks and if they were written for Android versions prior to April 23 that



91

00:06:58.870 --> 00:07:03.290

this warning a piece to let users know that things might break what.



92

00:07:03.340 --> 00:07:08.200

So what I'm going to do here is revoke the permission and see what happens when I on the up again.



93

00:07:08.240 --> 00:07:12.260

I want to click over here to revive it and we'll run the app again.



94

00:07:19.460 --> 00:07:25.550

You going back to the emulator and you could say it's now asking us whether we want to allow access



95

00:07:25.550 --> 00:07:28.910

again and again that's not surprising because we did not the permission.



96

00:07:29.060 --> 00:07:34.970

So the important lesson from this last test is just because your rap had a permission to lie you can't



97

00:07:34.970 --> 00:07:37.420

rely on it still having that permission tomorrow.



98

00:07:37.730 --> 00:07:43.460

When we're dealing with permissions we have to make sure our code can cope with a situation where permission



99

00:07:43.550 --> 00:07:48.020

isn't granted or what's for the farto test for now at least we're going to take on this.



100

00:07:48.020 --> 00:07:53.110

We're going to take We'll check the don't ask again box and then I'm going to deny the permission.



101

00:07:55.660 --> 00:08:00.440

Getting back to our law kept permission with Fury's which we would expect and a crush if we try and



102

00:08:00.460 --> 00:08:02.670

access part of planning session button.



103

00:08:03.010 --> 00:08:08.080

So now by clicking on that checkbox the users are asked not to be part of the game so it won't matter



104

00:08:08.080 --> 00:08:11.250

how many times when I run the app and request permissions get cold.



105

00:08:11.270 --> 00:08:13.390

You never could be granted permission.



106

00:08:13.390 --> 00:08:18.430

So let's just confirm that on request permission.



107

00:08:18.460 --> 00:08:19.270

Result starts.



108

00:08:19.270 --> 00:08:20.180

Permission refused.



109

00:08:20.200 --> 00:08:25.450

And looking it out at me later we've gotten our taluk box clicking on the filing option button and the



110

00:08:25.450 --> 00:08:27.120

up questions again.



111

00:08:27.280 --> 00:08:32.220

So basically the users have never gotten to be asked again if the permission was only needed for some



112

00:08:32.220 --> 00:08:37.130

minor function or the app such as sharing fries with the main purposes taking them then you could just



113

00:08:37.140 --> 00:08:39.020

disable that particular function.



114

00:08:39.100 --> 00:08:42.750

But this app pretty useless without permission to access the context.



115

00:08:43.030 --> 00:08:44.490

Because that's all it does.



116

00:08:44.680 --> 00:08:48.700

So the core functionality is now disabled before we look at dealing with that.



117

00:08:48.700 --> 00:08:53.260

One thing we should do is prevent that from crushing when it doesn't have permission.



118

00:08:53.260 --> 00:08:58.950

So that does nothing is pretty bad but we don't want to get a reputation for running apps that crash.



119

00:08:59.170 --> 00:09:03.580

So what I'm going to do is decide what the flighting action button if we don't have permission to access



120

00:09:03.580 --> 00:09:04.470

the contacts.



121

00:09:04.720 --> 00:09:09.490

Basically I'm going to rock to cut the kind of card that you'd use if the permission was for something



122

00:09:09.520 --> 00:09:13.350

my peripheral function that wasn't essential for your app to be useful.



123

00:09:13.360 --> 00:09:15.280

So let's work on that in the next video.



