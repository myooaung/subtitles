WEBVTT
1
00:00:00.390 --> 00:00:05.640
Congratulations on making it to the end of section six of the complete Android and develop of course

2
00:00:06.480 --> 00:00:13.110
you now know how to include and customize maps in your apps as well as using the user's location and

3
00:00:13.110 --> 00:00:19.020
displaying that to the user centering maps on their location and building more complex apps such as

4
00:00:19.830 --> 00:00:27.390
the hikers watch you also learn how to add activities to your apps and communicate and transfer between

5
00:00:27.390 --> 00:00:28.870
those two activities.

6
00:00:28.920 --> 00:00:34.330
And in this video I will be putting everything together building our memorable places app.

7
00:00:34.380 --> 00:00:37.590
So let's take a look and see what it's going to do.

8
00:00:38.160 --> 00:00:39.120
And here it is.

9
00:00:39.120 --> 00:00:44.770
So pretty simple at the start we've just got a list for you with the option to add a new memorable place

10
00:00:45.660 --> 00:00:51.150
and then when we tap on that takes us to our second activity which is a map activity which will of course

11
00:00:51.210 --> 00:01:01.740
center on the user's location and it will update automatically if for example we change the user locations

12
00:01:01.810 --> 00:01:09.390
of these images around the map we'll update with them and then the user can say they want to save Biggleswade

13
00:01:09.420 --> 00:01:15.000
as a memorable place or somewhere within Biggleswade then they can long press on them which is something

14
00:01:15.000 --> 00:01:15.900
we haven't done before.

15
00:01:15.900 --> 00:01:25.440
So you will need to google that part and it will even save the address of that place as well using geocoding.

16
00:01:25.710 --> 00:01:35.160
And then if we go back to our memorable places list you can see we've got our new place saved and tapping

17
00:01:35.160 --> 00:01:38.510
on that will then take us to that new place.

18
00:01:39.240 --> 00:01:40.120
So that's it.

19
00:01:40.180 --> 00:01:42.650
There's quite a lot of complications within that.

20
00:01:42.660 --> 00:01:48.180
So best of luck I hope it goes well and of course if you have any problems then just follow along with

21
00:01:48.180 --> 00:01:49.620
me afterwards.

22
00:01:50.010 --> 00:01:51.190
Go for it.

23
00:02:01.260 --> 00:02:06.810
All right then well I'm going to start Of course by creating a new project

24
00:02:10.770 --> 00:02:15.240
and we'll call this memorable places

25
00:02:17.990 --> 00:02:24.680
marshmallow as our targets and we're going to have an empty activity for our first activity because

26
00:02:24.680 --> 00:02:34.000
that's where our table of places will be and we'll leave that as main activity and at first challenge

27
00:02:34.000 --> 00:02:41.440
them will be to create our initial table to allow the user to view and add places.

28
00:02:41.830 --> 00:02:44.060
So we'll crack on with that.

29
00:02:46.660 --> 00:02:50.310
Stirred us up again by adding at least few

30
00:02:54.260 --> 00:02:56.910
way there it is in containers.

31
00:03:01.970 --> 00:03:04.710
And then remove the text the

32
00:03:08.550 --> 00:03:09.050
dragon.

33
00:03:09.140 --> 00:03:12.180
FYI.

34
00:03:12.530 --> 00:03:13.130
And then

35
00:03:15.860 --> 00:03:20.070
get an ID.

36
00:03:20.080 --> 00:03:20.700
All right.

37
00:03:20.700 --> 00:03:25.610
So then in the uncreate method we want to create a list of the variable

38
00:03:29.520 --> 00:03:34.550
to link to that list view that we're just created.

39
00:03:34.550 --> 00:03:36.970
So I will cast it as a list view.

40
00:03:40.740 --> 00:03:46.680
You'll find it by its ID or ID totalist.

41
00:03:50.520 --> 00:03:53.610
Then we'll create our array list.

42
00:03:53.680 --> 00:04:00.110
Remember this needs to be a final so we can access it inside the listener method.

43
00:04:03.970 --> 00:04:17.530
So an array list of strings I'll call that place is and this is going to be a new arriviste.

44
00:04:17.590 --> 00:04:22.240
Now obviously when the user opens up the app they won't have any places.

45
00:04:22.690 --> 00:04:24.490
So I'm going to add an initial

46
00:04:27.300 --> 00:04:29.430
had a new place.

47
00:04:30.810 --> 00:04:35.700
So if I click on that top line that will add a new place for them or open them up to allow them to add

48
00:04:35.710 --> 00:04:41.910
any place then we'll create our array adapter.

49
00:04:42.900 --> 00:04:57.290
So a new array adapter using this is the context Android are taught lay out simple list item one has

50
00:04:57.300 --> 00:05:06.210
the layout guide and then places for the array list to match to our list.

51
00:05:07.040 --> 00:05:08.800
And then take a few

52
00:05:12.650 --> 00:05:14.080
and set the adapter

53
00:05:22.410 --> 00:05:23.830
All right apps are there.

54
00:05:24.680 --> 00:05:27.880
I think that should have kept Tovey and

55
00:05:34.200 --> 00:05:36.260
make that a capital as well.

56
00:05:37.890 --> 00:05:44.040
And then while we're here we'll set out on item click listen to

57
00:05:47.270 --> 00:05:52.460
which will have a new depth to view.

58
00:05:54.540 --> 00:05:58.570
It's on item click it's not

59
00:06:04.880 --> 00:06:14.210
like it's there and we use Android studio to implement the on item click method.

60
00:06:17.060 --> 00:06:19.880
And for now just to make sure that everything is connected up writes

61
00:06:24.160 --> 00:06:25.220
will create a taste

62
00:06:30.270 --> 00:06:35.470
just sharing the number in the table that was clicked just to make sure that everything's looking good.

63
00:06:39.430 --> 00:06:39.760
All right.

64
00:06:39.760 --> 00:06:45.430
So we'll just from that make sure our table looks correct and that the tapping works while that setting

65
00:06:45.430 --> 00:06:51.330
up will add a new activity.

66
00:06:53.390 --> 00:07:00.030
From the gallery and this is going to be a Google Maps activity I'll leave that as the default maps

67
00:07:00.050 --> 00:07:01.150
activity.

68
00:07:01.160 --> 00:07:07.580
This is going to be where we allow the user to add new places and view existing places.

69
00:07:08.300 --> 00:07:11.180
And you remember we need to add our Google Maps key there.

70
00:07:11.510 --> 00:07:16.880
So if you are creating a new key you would get that you are able just as we did before and create it.

71
00:07:17.210 --> 00:07:27.680
But I'm going to reuse the key that I created before to sort don't have to do with too many keys.

72
00:07:29.550 --> 00:07:38.210
So we're going to select that with Control-C and then pasted in here with control the

73
00:07:41.060 --> 00:07:44.420
get rid of any spaces in line breaks.

74
00:07:44.420 --> 00:07:45.770
Just in case they cause a problem

75
00:07:51.140 --> 00:08:02.610
and as it's still processing the code to main activity to jump to maps activity when an item is typed

76
00:08:08.230 --> 00:08:10.320
so we will create our intent

77
00:08:13.650 --> 00:08:15.450
which is going to be a new intent

78
00:08:19.780 --> 00:08:21.520
using the application context

79
00:08:25.830 --> 00:08:31.720
and we want to jump to the maps activity topless

80
00:08:35.000 --> 00:08:35.500
and then

81
00:08:38.730 --> 00:08:45.960
we want to put an extra bit of data to go with our intent which I'll call

82
00:08:48.650 --> 00:08:52.780
place number and that's going to be

83
00:08:57.390 --> 00:09:06.830
and then we're just going to start activity with that intent.

84
00:09:06.830 --> 00:09:16.520
So that should jump to our Google Maps activity and give it the information about the place that was

85
00:09:16.520 --> 00:09:20.700
tapped on over to Google Maps activity

86
00:09:23.380 --> 00:09:28.430
will write our code in the on map ready method.

87
00:09:28.600 --> 00:09:31.520
Although for this but we could put it in on create.

88
00:09:31.640 --> 00:09:37.960
Mostly we're going to be interacting with the maps that makes most sense to do it when the map is ready.

89
00:09:41.720 --> 00:09:43.670
So again we're going to create an intent

90
00:09:52.500 --> 00:09:59.550
which is going to be the intent that got us here and then we'll create a new TOSed

91
00:10:02.400 --> 00:10:03.680
just as we did before.

92
00:10:11.650 --> 00:10:12.750
To display

93
00:10:18.870 --> 00:10:30.030
the number that was passed through which I have to remind myself I called Place number.

94
00:10:30.050 --> 00:10:30.380
All right.

95
00:10:30.380 --> 00:10:31.510
So we should be good to go.

96
00:10:31.550 --> 00:10:40.290
I'm just going to get rid of the initial choice over here as we don't need that anymore.

97
00:10:41.300 --> 00:10:43.320
And then let's run our app.

98
00:10:43.760 --> 00:10:49.730
And with any luck now when we tap at a new place on my first list view it will take us to the map and

99
00:10:49.730 --> 00:10:58.690
display what will be a zero from the fact that we tapped the first item in the list view as a toast.

100
00:10:58.700 --> 00:10:59.920
And here we go.

101
00:11:00.440 --> 00:11:04.650
So I had a new place and then there we go.

102
00:11:04.700 --> 00:11:08.450
So we're jumping over and you hopefully saw the toast pop up there.

103
00:11:08.450 --> 00:11:10.920
Interesting they didn't actually display a 0.

104
00:11:11.000 --> 00:11:16.380
I suspect that's because misinterpreting this when it converts it into a string as having no value.

105
00:11:16.380 --> 00:11:19.010
And so it just displayed an empty toast.

106
00:11:19.160 --> 00:11:19.610
That's fine.

107
00:11:19.610 --> 00:11:26.480
It'll still work for our app and of course we can go back easily enough by clicking the back button

108
00:11:26.540 --> 00:11:30.440
and then do that again if we want to.

109
00:11:30.860 --> 00:11:35.990
So now next phase is to zoom in on the users current location.

110
00:11:35.990 --> 00:11:39.320
We don't want them to have to scroll around the whole world to find out where they are to have a new

111
00:11:39.320 --> 00:11:44.050
place if they're going to add a new place it's probably going to be where they are right now.

112
00:11:44.540 --> 00:11:49.740
So let's do that over in maps activity.

113
00:11:50.180 --> 00:11:58.070
And actually it is the case that the variable that we're passing here is an integer rather than a string

114
00:11:58.080 --> 00:12:01.340
so we should really be using get it extra.

115
00:12:02.150 --> 00:12:05.610
So let's use that from now on.

116
00:12:05.720 --> 00:12:14.690
So intent don't get into extra.

117
00:12:14.970 --> 00:12:19.080
And you can see this one requires both a string name and a default value.

118
00:12:21.230 --> 00:12:25.790
So the string name is going to be what we saved over here.

119
00:12:25.940 --> 00:12:26.540
Place number

120
00:12:29.470 --> 00:12:38.710
and we should never need the full value because we'll always get a value but I'll put the full value

121
00:12:38.770 --> 00:12:39.900
of zero.

122
00:12:41.290 --> 00:12:46.120
Just in case and then we'll check to see if that 0 3

123
00:12:51.770 --> 00:13:01.060
and if it is then we want to zoom in on the users location.

124
00:13:01.070 --> 00:13:02.820
All right so flex his wrists.

125
00:13:02.820 --> 00:13:04.820
We've done this a few times before now.

126
00:13:05.280 --> 00:13:07.810
Let's get typing.

127
00:13:08.060 --> 00:13:10.040
So we want a location manager

128
00:13:13.630 --> 00:13:18.340
who would location manager and we want a location listener

129
00:13:21.100 --> 00:13:23.350
called location listener.

130
00:13:24.630 --> 00:13:27.120
We're going to access those from anywhere.

131
00:13:27.900 --> 00:13:30.320
Which is why they're defined in the class itself.

132
00:13:35.700 --> 00:13:44.830
And so they're throughout the classes for them and then we'll set up our location manager.

133
00:13:46.170 --> 00:13:52.710
So we're going to cast this to location manager and we're going to get it from this activity.

134
00:13:52.730 --> 00:13:53.490
Don't get

135
00:13:56.630 --> 00:14:13.600
system service and the service that we want is context dot location service next location listener.

136
00:14:13.860 --> 00:14:21.990
It's going to be a new location listener and it gives us all the methods that we need them.

137
00:14:23.610 --> 00:14:31.080
And as I've done before I'm going to set up a method to process that location Colette's

138
00:14:34.110 --> 00:14:39.150
center map on location

139
00:14:44.760 --> 00:14:55.030
like that and then we'll take our location and we'll generate a lot learn from it as we've done before.

140
00:14:59.690 --> 00:15:11.150
So call it use the location and this is going to be a new line created from location to get latitude

141
00:15:15.140 --> 00:15:20.400
coma location at gets let me into

142
00:15:23.590 --> 00:15:32.560
and then we'll take our map and first we'll clear all the markers then we'll add a new marker

143
00:15:36.400 --> 00:15:42.420
with a new set of marker options.

144
00:15:43.930 --> 00:15:45.870
And that will be a position

145
00:15:49.670 --> 00:15:54.260
which is our use of location and the title

146
00:15:57.160 --> 00:16:05.110
which will actually vary depending on whether the user is viewing an old location or adding a new one.

147
00:16:05.500 --> 00:16:09.650
So I'm going to request that here

148
00:16:13.070 --> 00:16:17.280
and then use it that.

149
00:16:17.630 --> 00:16:21.260
And then finally we'll move the camera

150
00:16:25.410 --> 00:16:27.410
using camera update factory

151
00:16:30.070 --> 00:16:36.160
it's new that Zoom and the

152
00:16:39.380 --> 00:16:49.070
Lachlan is going to be using location and the zeem Let's try six Well maybe 10.

153
00:16:49.270 --> 00:16:50.110
See how that looks.

154
00:16:52.430 --> 00:16:52.980
OK.

155
00:16:53.320 --> 00:16:55.600
So that's how we update the map.

156
00:16:55.600 --> 00:16:57.500
So we'll do that here.

157
00:17:00.150 --> 00:17:03.360
Center map on location the location of course is location

158
00:17:08.340 --> 00:17:14.700
and the title because it's where the user is is going to be your location.

159
00:17:15.850 --> 00:17:16.490
OK.

160
00:17:16.750 --> 00:17:24.990
Of course we need to get the user's last known location if we can as well.

161
00:17:29.520 --> 00:17:34.770
And also request location updates.

162
00:17:35.060 --> 00:17:44.180
So it's almost second nature to you now check to see if they're using a version of the marshmallow

163
00:17:48.480 --> 00:17:52.480
and if they are we'll just request those location updates.

164
00:17:55.330 --> 00:17:57.010
Using the GPS provider

165
00:18:00.740 --> 00:18:13.890
00 we thought time and distance from the last update and location listener has reminded me get in the

166
00:18:13.900 --> 00:18:21.460
manifest when we added the Google Maps activity to added the final location for us but always worth

167
00:18:21.460 --> 00:18:21.790
checking

168
00:18:27.110 --> 00:18:27.730
OK.

169
00:18:27.740 --> 00:18:35.900
Otherwise we need to check to see if we've got permission.

170
00:18:36.230 --> 00:18:41.720
So we're checking the permissions of this activity.

171
00:18:44.960 --> 00:18:48.500
And we're checking manifesto permission

172
00:18:53.090 --> 00:18:57.310
access fine location

173
00:19:01.820 --> 00:19:09.740
and we're checking to see that story the other way around this time to see if that's equal to package

174
00:19:09.740 --> 00:19:16.030
manager got permission granted just for a bit of variety.

175
00:19:16.970 --> 00:19:21.400
So if it is that means we have permission.

176
00:19:21.860 --> 00:19:37.100
So in fact we can copy and paste this to start getting updates and we'll also get the last known location

177
00:19:39.920 --> 00:19:52.910
which will get from location manager talk get the last known location from the location manager CPS

178
00:19:53.330 --> 00:19:53.780
provider

179
00:19:58.510 --> 00:20:04.820
and then we want to send a map on location using last known location.

180
00:20:05.380 --> 00:20:11.800
And again your location will be our title.

181
00:20:11.830 --> 00:20:13.490
All right we're nearly there.

182
00:20:14.080 --> 00:20:21.480
We just have to add the final on request permissions result.

183
00:20:26.290 --> 00:20:40.740
And we're going to check as usual if grand results start length is greater than zero and ground results.

184
00:20:40.800 --> 00:20:45.110
0 3 is equal to package manager

185
00:20:49.760 --> 00:20:55.900
permission granted.

186
00:20:56.110 --> 00:20:57.520
Then we know we're good to go.

187
00:20:57.530 --> 00:20:58.820
But we also have to check

188
00:21:03.790 --> 00:21:13.240
we actually have the permission so context combate check self permission.

189
00:21:13.610 --> 00:21:23.420
This as the context and then manifest permission to access file location

190
00:21:29.610 --> 00:21:33.420
is equal to the package manager.

191
00:21:33.630 --> 00:21:36.330
Permission granted.

192
00:21:36.720 --> 00:21:47.550
If that's the case then we can request location updates which are day by grabbing the code from down

193
00:21:47.550 --> 00:21:51.380
there.

194
00:21:51.380 --> 00:22:00.070
All right so I think we'll get to go when we jump to the second activity the maps activity we should

195
00:22:00.370 --> 00:22:06.040
find that it checks for an intent placed number of 0 which it should get because we're pressing the

196
00:22:06.040 --> 00:22:13.240
first number in the table first item in the table and then it will set up the location manager and location

197
00:22:13.240 --> 00:22:14.680
listener.

198
00:22:14.680 --> 00:22:21.790
If we're in a version of Android before marshmallow then it will just start requesting the location

199
00:22:21.790 --> 00:22:22.450
updates.

200
00:22:22.630 --> 00:22:26.200
Otherwise it will check to see if we've got permission.

201
00:22:26.710 --> 00:22:35.380
And in fact I've just realized that we don't have the request to ask for permission if we don't have

202
00:22:35.380 --> 00:22:36.840
it.

203
00:22:37.000 --> 00:22:47.460
So let's use that in the activity compatibility not request permissions.

204
00:22:48.120 --> 00:22:57.840
This and then we create a new array of strings which has a single item in it which is manifest

205
00:23:00.120 --> 00:23:10.950
permission to access find location and our quest code which is just going to be a 1.

206
00:23:11.460 --> 00:23:12.990
Right.

207
00:23:13.020 --> 00:23:15.990
So let's try that again.

208
00:23:16.240 --> 00:23:17.280
We'll look at it at the moment.

209
00:23:17.280 --> 00:23:24.240
Worked fine but it wouldn't actually ask for the location which is something that's pretty fundamental

210
00:23:24.540 --> 00:23:27.110
to getting and updating the location

211
00:23:31.210 --> 00:23:43.760
while that's getting out just get rid of the carried to Center in Sydney which we don't want.

212
00:23:43.770 --> 00:23:44.960
All right so here we go.

213
00:23:45.180 --> 00:23:50.720
Let's tap at any place and they should now jump us over to the map.

214
00:23:51.300 --> 00:24:01.130
And after asking permission for the device's location which will allow then it should send to on our

215
00:24:01.130 --> 00:24:07.600
current location slightly hard to tell if it's done that so let's

216
00:24:10.430 --> 00:24:12.370
just update the location.

217
00:24:18.760 --> 00:24:20.910
Using the extended controls and there we go.

218
00:24:22.120 --> 00:24:25.180
Wonderful.

219
00:24:25.240 --> 00:24:26.960
So that's all looking good.

220
00:24:27.100 --> 00:24:32.590
I'm slightly concerned about the fact that it didn't center the map or didn't appear to center the map

221
00:24:32.590 --> 00:24:34.230
on the location.

222
00:24:34.610 --> 00:24:35.330
Ah ok.

223
00:24:35.350 --> 00:24:36.790
Yep that's good.

224
00:24:36.790 --> 00:24:44.890
So it's requesting location updates when permission is granted but it's not using the last known location

225
00:24:46.300 --> 00:24:49.470
and updating that.

226
00:24:49.890 --> 00:24:51.850
So I'm going to add that code in there as well.

227
00:24:51.870 --> 00:24:58.290
So now it'll show the right location immediately after the user has given us permission to use their

228
00:24:58.290 --> 00:24:59.730
location.

229
00:25:00.180 --> 00:25:03.270
So we now zoomed in on the users location.

230
00:25:03.390 --> 00:25:08.250
What I'm now going to remove is this market in the middle because

231
00:25:11.340 --> 00:25:18.740
we only want that marker if we're showing them a location that they've already saved.

232
00:25:19.090 --> 00:25:29.170
So I'm going to do just a quick check to see if title is equal to your location.

233
00:25:29.340 --> 00:25:41.930
In fact auto checked if it's not equal to your location and only then will we add the marker.

234
00:25:41.970 --> 00:25:42.430
All right.

235
00:25:42.450 --> 00:25:48.990
Now we need to add that feature I remember I mentioned at the beginning with the long press to add a

236
00:25:48.990 --> 00:25:51.210
marker.

237
00:25:51.450 --> 00:25:53.140
So this is something we haven't done before.

238
00:25:53.290 --> 00:25:56.500
So let's see if we can figure out how to do it.

239
00:25:56.620 --> 00:26:04.110
So Android long press marker map something that should do the trick

240
00:26:09.400 --> 00:26:09.940
OK.

241
00:26:09.950 --> 00:26:13.250
That first result looks pretty promising.

242
00:26:18.910 --> 00:26:21.240
I'm going to bypass that.

243
00:26:21.910 --> 00:26:23.540
And here we go.

244
00:26:23.770 --> 00:26:25.580
That that actually looks pretty simple.

245
00:26:25.660 --> 00:26:35.160
We said an on map long click listener and then we set an on map long click method to add the marker.

246
00:26:35.290 --> 00:26:37.130
At that point.

247
00:26:38.200 --> 00:26:40.030
OK so over to our code

248
00:26:44.720 --> 00:26:52.740
let's get our Google map and set the long click listener

249
00:26:56.230 --> 00:26:58.130
using this.

250
00:26:58.900 --> 00:27:06.970
And you can see that gives us an error because this refers to our maps activity which doesn't have the

251
00:27:07.230 --> 00:27:13.350
map long click listener that we need if we scroll up here.

252
00:27:13.370 --> 00:27:14.830
We should be able to see the whole code.

253
00:27:14.830 --> 00:27:16.030
There we go.

254
00:27:16.360 --> 00:27:17.440
So we can now use

255
00:27:20.240 --> 00:27:24.490
on map long click listener if we added in

256
00:27:28.140 --> 00:27:35.510
to the classes that are maps activity implements and old enter as usual.

257
00:27:36.600 --> 00:27:45.000
And now and a very hopefully will implement the methods for MAP long calculus for us as anyone on map

258
00:27:45.120 --> 00:27:49.420
long click.

259
00:27:50.270 --> 00:27:50.760
There we go.

260
00:27:50.760 --> 00:27:57.430
And now for now we'll just add our marker and we've got some code for adding our marker somewhere in

261
00:28:01.010 --> 00:28:01.570
there it is

262
00:28:09.340 --> 00:28:17.670
so let's bring this down so you can see we've got a lot along.

263
00:28:17.670 --> 00:28:27.040
Returned by this method that will be where they clicked or where they long pressed.

264
00:28:27.390 --> 00:28:32.440
So I can use that as my permission and for the title for now

265
00:28:37.070 --> 00:28:40.250
I'll put you on a memorable place.

266
00:28:42.260 --> 00:28:42.950
All right.

267
00:28:43.610 --> 00:28:44.700
So let's try that out.

268
00:28:44.750 --> 00:28:52.880
We should now be able to long press on the map and it will add a marker with the title of your memorable

269
00:28:52.880 --> 00:28:56.660
place your new member place at that location.

270
00:28:57.260 --> 00:28:59.700
Let's see it in action.

271
00:28:59.930 --> 00:29:00.650
And here we go.

272
00:29:00.680 --> 00:29:02.870
So let's add a new place.

273
00:29:05.530 --> 00:29:11.810
And that then jumps over to the map with our previous locations so no market for the moment so let's

274
00:29:11.810 --> 00:29:13.750
say I want to add a marker.

275
00:29:13.790 --> 00:29:14.490
Hello.

276
00:29:14.690 --> 00:29:16.280
There we go.

277
00:29:17.310 --> 00:29:20.150
And that's our new memorable place.

278
00:29:20.270 --> 00:29:21.580
Brilliant.

279
00:29:22.550 --> 00:29:23.980
Now that sounds so good so far.

280
00:29:23.990 --> 00:29:28.780
But we want to be a bit clever than just adding some random text.

281
00:29:28.820 --> 00:29:33.370
We want to get the address of that place if we possibly can.

282
00:29:33.410 --> 00:29:34.130
So let's

283
00:29:37.240 --> 00:29:46.070
go back over and when they do the long click that's when we want to do the geocoding.

284
00:29:46.340 --> 00:29:49.790
So let's create a new geocoder.

285
00:29:50.820 --> 00:30:04.040
So new geocoder using the application context and the user's local.

286
00:30:04.210 --> 00:30:07.360
Then again as we're used to we'll add

287
00:30:11.170 --> 00:30:22.570
a list of addresses which are call list addresses and we're going to get these from our geocoder using

288
00:30:22.600 --> 00:30:35.620
get from location and the location is of course our lat long talk latitude and lot to learn thought

289
00:30:36.260 --> 00:30:39.890
long and chewed and we only want one result.

290
00:30:44.890 --> 00:30:49.810
We're going to need a try catch around there.

291
00:30:54.130 --> 00:31:01.900
And then we're going to check to see first off list addresses is not null and then

292
00:31:06.240 --> 00:31:12.640
we'll check that there's at least one item in that we only need one.

293
00:31:13.220 --> 00:31:18.220
And then here I'm going to just get the sub thoroughfare and the thoroughfare.

294
00:31:18.590 --> 00:31:23.230
And as long as the thoroughfare exists we'll go ahead with this address.

295
00:31:23.300 --> 00:31:28.160
If that doesn't then we'll use something else.

296
00:31:28.160 --> 00:31:34.160
So if Mr. dresses get zero or

297
00:31:38.680 --> 00:31:41.220
don't get thoroughfare

298
00:31:44.940 --> 00:31:45.660
is not known

299
00:31:48.600 --> 00:31:52.650
then I'll do another check to see if Lith's addresses

300
00:31:57.200 --> 00:31:58.350
get 0

301
00:32:01.010 --> 00:32:07.530
get some thoroughfare.

302
00:32:07.740 --> 00:32:08.660
That's not no.

303
00:32:08.670 --> 00:32:14.250
Then we'll take our address which I'll define up here as a string

304
00:32:16.930 --> 00:32:19.520
so initially will make it an empty string.

305
00:32:30.470 --> 00:32:34.910
So if the sub thoroughfare does exist

306
00:32:42.870 --> 00:32:49.980
then we'll add it to our address and regardless of whether that exists will add

307
00:32:53.910 --> 00:32:55.420
the thoroughfare.

308
00:33:04.250 --> 00:33:05.230
There we go.

309
00:33:05.760 --> 00:33:06.840
And then we want

310
00:33:10.490 --> 00:33:13.350
the address.

311
00:33:13.370 --> 00:33:18.890
All right so that will work fine if we get a value if we don't get a value then we need some way of

312
00:33:18.890 --> 00:33:21.760
identifying this particular location.

313
00:33:21.770 --> 00:33:27.500
So I'm going to use the time and that this is something we haven't got before an android so let's have

314
00:33:27.500 --> 00:33:30.740
a quick search.

315
00:33:31.070 --> 00:33:34.460
I'm going to go for Android and Java get

316
00:33:37.090 --> 00:33:38.420
date time.

317
00:33:38.420 --> 00:33:43.420
If you get go for Android get date time.

318
00:33:43.850 --> 00:33:47.650
You might end up with a non technical response so this looks pretty perfect.

319
00:33:49.180 --> 00:33:55.250
OK so that's good but I don't just want the number of seconds again useful.

320
00:33:55.250 --> 00:33:57.950
It'd be nice if someone could tell me how to get the full date.

321
00:33:58.000 --> 00:34:00.270
Aha OK.

322
00:34:00.300 --> 00:34:01.530
Yeah this looks perfect.

323
00:34:03.500 --> 00:34:11.350
So this is getting it in the format your year month month date date our minutes and seconds

324
00:34:14.210 --> 00:34:20.750
so let's do a check to see if address is still empty.

325
00:34:20.880 --> 00:34:22.230
If we weren't successful

326
00:34:24.780 --> 00:34:25.980
with our geocoding

327
00:34:32.250 --> 00:34:32.640
then

328
00:34:38.280 --> 00:34:39.080
there is an

329
00:34:43.430 --> 00:34:44.580
if you've got many to choose from.

330
00:34:44.580 --> 00:34:46.410
I normally just go for the Android version

331
00:34:51.490 --> 00:34:54.300
then all set.

332
00:34:54.530 --> 00:34:56.070
You can see I've made a mistake there.

333
00:34:56.150 --> 00:35:06.150
I chose one that required Android API level 24 and we're trying to support level 23 here.

334
00:35:06.990 --> 00:35:09.120
So let's get rid of

335
00:35:11.920 --> 00:35:17.130
simple format and then add in the other one and then we get

336
00:35:20.700 --> 00:35:24.800
and I'm going to turn this around slightly.

337
00:35:24.940 --> 00:35:30.120
So we've got minutes minutes hours hours

338
00:35:33.610 --> 00:35:36.630
and then leave the year month and day.

339
00:35:36.650 --> 00:35:41.050
So there's hopefully less confusion than there would otherwise be about whether the month comes before

340
00:35:41.050 --> 00:35:44.770
the day or the other way around.

341
00:35:44.770 --> 00:35:45.710
All right.

342
00:35:46.480 --> 00:35:47.480
So let's get that ago

343
00:35:52.510 --> 00:36:01.490
our next challenge of course if this works is to actually save that item on our app so that it displays

344
00:36:01.790 --> 00:36:09.290
in the memorable places and actually become memorable to the app and every game she gets updated it's

345
00:36:09.290 --> 00:36:13.110
actually gone straight to this activity.

346
00:36:14.760 --> 00:36:15.780
So let's have a look.

347
00:36:15.800 --> 00:36:17.250
Excellent.

348
00:36:17.330 --> 00:36:17.870
We've got

349
00:36:21.160 --> 00:36:24.160
the correct address them to try another one.

350
00:36:26.860 --> 00:36:27.580
Ok that one.

351
00:36:27.640 --> 00:36:28.120
Excellent.

352
00:36:28.120 --> 00:36:30.150
Sorry I couldn't get the correct address.

353
00:36:30.730 --> 00:36:35.180
So it's created a Deighton time although that doesn't make a lot of sense.

354
00:36:35.290 --> 00:36:36.030
I think a lot

355
00:36:40.910 --> 00:36:43.160
a little bit of punctuation in there.

356
00:36:44.270 --> 00:36:54.820
And I think there should be hours hours minutes minutes then it would be 15 47 rather than 47 15.

357
00:36:55.830 --> 00:36:56.660
OK.

358
00:36:56.900 --> 00:37:00.480
So now we need to think about how we going to save these things.

359
00:37:01.640 --> 00:37:08.230
Obviously we've got our places array list but we're also going to need to save the actual locations.

360
00:37:09.080 --> 00:37:11.720
So we're going to need a number of very least

361
00:37:15.830 --> 00:37:22.400
and this is going to be an array list of lines which will be locations

362
00:37:27.430 --> 00:37:29.990
and this is going to be a new array list.

363
00:37:33.130 --> 00:37:40.640
And we'll initially add a new loan

364
00:37:43.630 --> 00:37:51.160
which is just going to be 0 0 or so that we refer to the supposed location of the at a new place item

365
00:37:52.000 --> 00:37:53.140
in our array list.

366
00:37:53.170 --> 00:37:58.230
Otherwise everything will get out of sync.

367
00:37:58.480 --> 00:38:03.170
So if we get back over to our maps activity at this point we don't just want to add a marker.

368
00:38:03.190 --> 00:38:06.690
We want to add a location.

369
00:38:07.450 --> 00:38:15.370
But of course the places and locations are rails are in the main activity and we want to update them

370
00:38:15.430 --> 00:38:17.670
from the maps activity.

371
00:38:17.740 --> 00:38:19.370
That's not something we've done before.

372
00:38:19.400 --> 00:38:21.390
So let's see if we can figure out how to do it.

373
00:38:23.690 --> 00:38:31.830
So Android Update variable from different activity perhaps something like that

374
00:38:35.300 --> 00:38:35.900
here we go.

375
00:38:35.900 --> 00:38:38.450
How do I get a variable in another activity.

376
00:38:38.450 --> 00:38:43.080
So we know how to transfer variables between activities but that's not quite what we want to do here.

377
00:38:43.310 --> 00:38:46.220
We want to update a variable.

378
00:38:47.080 --> 00:38:48.100
Aha here we go.

379
00:38:48.150 --> 00:38:55.560
If we declare them as static variables then we can access using activity one for example don't.

380
00:38:55.640 --> 00:39:02.620
And then the variable name.

381
00:39:02.730 --> 00:39:04.760
Let's try that.

382
00:39:05.790 --> 00:39:14.850
So let's change these variable types to static which means they will be available from anywhere in our

383
00:39:14.860 --> 00:39:17.570
app i.e. from any activity.

384
00:39:18.560 --> 00:39:25.520
But you'll notice that we can't define a static variable within the uncreate method.

385
00:39:25.790 --> 00:39:29.420
We need to define them in the class itself.

386
00:39:29.900 --> 00:39:31.860
So that's fine.

387
00:39:31.870 --> 00:39:39.650
Now they are both static variable so we should be able to access them from here using main activity

388
00:39:39.850 --> 00:39:43.040
dot places and there we go.

389
00:39:43.430 --> 00:39:47.120
So now we can use main activity to our places and we can add.

390
00:39:48.280 --> 00:39:59.810
And the thing we're going to add is the address of the place and we're also going to add two locations

391
00:40:01.700 --> 00:40:15.150
the Lachlan which is that long OK and I'd quite like to see a quick toast.

392
00:40:15.410 --> 00:40:16.120
Just saying

393
00:40:19.660 --> 00:40:21.800
locations saved.

394
00:40:22.000 --> 00:40:26.450
So it's very clear to the user that that location has been saved for them.

395
00:40:27.580 --> 00:40:34.490
So let's give it a try and see if that works as desired.

396
00:40:34.510 --> 00:40:35.190
Here we go.

397
00:40:35.230 --> 00:40:36.840
So I will add a new place

398
00:40:41.330 --> 00:40:47.590
jumped over to the map and then long press locations saved

399
00:40:50.560 --> 00:40:51.360
if we get back.

400
00:40:51.380 --> 00:40:53.640
So it's not on our list.

401
00:40:54.070 --> 00:40:58.400
That's because we need to update the table itself.

402
00:41:00.940 --> 00:41:08.030
And we can do that as we've seen before actually by updating the array adapter but that does mean that

403
00:41:08.030 --> 00:41:11.210
we'll need to be able to access the array adapter

404
00:41:14.540 --> 00:41:15.200
from

405
00:41:17.740 --> 00:41:18.780
both activities.

406
00:41:18.790 --> 00:41:34.660
So let's define it as a static variable and then we can use main activity dot array adapter and notify

407
00:41:34.680 --> 00:41:38.300
dataset changed.

408
00:41:38.690 --> 00:41:44.390
And that should then update the array adapter which will essentially update the list view for us and

409
00:41:44.390 --> 00:41:49.690
show the new location that's look.

410
00:41:50.230 --> 00:41:52.530
OK so once again we'll add a new place

411
00:41:56.490 --> 00:42:03.220
and then that Letchworth Garden City and again says locations saved.

412
00:42:03.450 --> 00:42:04.350
Looks good.

413
00:42:04.350 --> 00:42:04.940
Click back.

414
00:42:04.980 --> 00:42:06.150
And there we go.

415
00:42:06.480 --> 00:42:09.760
So it saved the data on the list view.

416
00:42:10.350 --> 00:42:10.760
Excellent.

417
00:42:10.760 --> 00:42:15.460
So we're pretty close to things that we need to add really to make the app work properly.

418
00:42:15.510 --> 00:42:22.230
The first is to make it so that now when I click on Nevill's green it takes me to that location and

419
00:42:22.230 --> 00:42:28.500
then the second and final thing is to save these bits of data permanently so that they're there every

420
00:42:28.500 --> 00:42:30.720
time the user opens the app.

421
00:42:31.230 --> 00:42:31.760
OK.

422
00:42:31.950 --> 00:42:36.370
So let's see the first one first.

423
00:42:36.440 --> 00:42:46.400
So when the user enters the maps activity remember it initially checks to see Place number 0.

424
00:42:46.810 --> 00:42:52.210
So if it is then it will do all of that.

425
00:42:52.240 --> 00:43:02.770
If not then we won't see Center not on the user's location but on the item that they've just tapped

426
00:43:02.770 --> 00:43:05.310
on.

427
00:43:05.340 --> 00:43:08.830
So we've actually got some code to do that.

428
00:43:09.030 --> 00:43:12.600
We're going to add a markup

429
00:43:16.960 --> 00:43:19.180
just like that on the map.

430
00:43:19.180 --> 00:43:27.010
In fact we should probably clear the map just in case there's any markings on it from previous usage.

431
00:43:27.010 --> 00:43:38.620
And then the position we're going to get from main activity dot locations and then we're going to get

432
00:43:38.700 --> 00:43:49.990
and the number that we're interested in is of course the intent and then get an extra

433
00:43:54.800 --> 00:44:00.050
place number up then it will default to zero just in case there isn't one but we're pretty certain there

434
00:44:00.050 --> 00:44:04.330
will be and then the address is very similar.

435
00:44:04.760 --> 00:44:13.870
But we're getting that from main activity dot places to get.

436
00:44:14.320 --> 00:44:18.500
And then again we want to get the place number

437
00:44:21.600 --> 00:44:29.700
so that should add a marker then we want see Center on the map.

438
00:44:30.320 --> 00:44:34.180
And in fact we'd be much better off just using that method.

439
00:44:34.280 --> 00:44:39.410
That's why it was there after all.

440
00:44:39.520 --> 00:44:40.520
So let's call

441
00:44:43.170 --> 00:44:56.420
center map on location and the location of course is this one.

442
00:44:57.140 --> 00:45:02.670
And the title is here.

443
00:45:10.700 --> 00:45:15.930
Except of course that we're expecting a location and this is a lot Len

444
00:45:18.870 --> 00:45:20.450
So we will have today.

445
00:45:22.650 --> 00:45:28.530
A little bit of manipulating to convert that.

446
00:45:28.530 --> 00:45:30.600
So let's create a location

447
00:45:33.190 --> 00:45:34.600
cold place location

448
00:45:37.860 --> 00:45:50.130
which is going to be a new location using the usual location manager GPS provider and then we're going

449
00:45:50.130 --> 00:46:03.460
to take our location and set the latitude and we're going to get that from main activity locations.

450
00:46:05.770 --> 00:46:14.760
Get that dot latitude and then something pretty similar.

451
00:46:17.080 --> 00:46:18.880
For setting the

452
00:46:22.810 --> 00:46:23.470
long achieved

453
00:46:28.560 --> 00:46:33.180
and then we can just send place location to that method.

454
00:46:35.250 --> 00:46:36.960
So that's a little bit messy up.

455
00:46:36.990 --> 00:46:45.630
I anticipated because we have to convert it from a lot longer to a location but it gets the job done.

456
00:46:45.870 --> 00:46:51.330
Of course your code may well be leaner than that in which case congratulations but let's just check.

457
00:46:51.340 --> 00:47:01.650
We should now be able to save a place and then view that place via the initial list via.

458
00:47:01.680 --> 00:47:05.850
So here we go because of the way that is restarted the app and it hasn't restarted it completely has

459
00:47:05.850 --> 00:47:12.510
actually saved our old place and then added a new at a new place on which messes things up slightly

460
00:47:12.520 --> 00:47:21.720
but actually we should be able to then just tap on that and go straight to that location soop up there

461
00:47:21.720 --> 00:47:22.050
we go.

462
00:47:22.050 --> 00:47:24.480
So now everything is working as desired.

463
00:47:24.510 --> 00:47:30.750
We just need to save everything permanently which I'm afraid will have to wait for the next section

464
00:47:31.020 --> 00:47:34.680
because that is all about permanent data storage.

465
00:47:34.680 --> 00:47:38.490
So as always feel free to google ahead and see how that's done.

466
00:47:38.760 --> 00:47:43.710
But we'll come back and we'll revisit this app at the end of the first video in the next section when

467
00:47:43.710 --> 00:47:45.810
we know how to store data permanently.

468
00:47:45.810 --> 00:47:51.510
And that of course will be our challenge for that video to see how to add permanent storage to our memorable

469
00:47:51.510 --> 00:47:51.990
places.

470
00:47:51.990 --> 00:47:57.780
App For now though congratulations on making it to the end of section six.

471
00:47:57.810 --> 00:48:03.690
We've covered a huge range of ways in which you can use location and maps in your apps and I hope you're

472
00:48:03.690 --> 00:48:09.630
looking forward to Section 7 where we're going to be looking at permanent data storage which will take

473
00:48:09.630 --> 00:48:14.430
us toward building our big app at the end of the section of a news reader.

474
00:48:14.940 --> 00:48:16.120
I'll see you then.
