WEBVTT
1

00:00:00.960  -->  00:00:05.580
Hello and welcome back to the course of machine learning you talked about hierarchical clustering and

2

00:00:05.580  -->  00:00:06.870
how the algorithm works.

3

00:00:06.870  -->  00:00:09.840
Also we talked about pentagrams and how they are constructed.

4

00:00:09.840  -->  00:00:15.810
Today we're going to put the two together and learn how to get the maximum value out of our hierarchical

5

00:00:15.810  -->  00:00:17.100
clustering algorithms.

6

00:00:17.280  -->  00:00:19.160
So let's get straight into it.

7

00:00:19.170  -->  00:00:19.470
All right.

8

00:00:19.470  -->  00:00:25.410
So here we've got an example the example that we looked at previously where on the left we've got the

9

00:00:25.410  -->  00:00:31.170
points in all scatterplot And then here on the right we've got the dental gram as which contains memory

10

00:00:31.350  -->  00:00:35.790
of how the clusters were formed during the hierarchical clustering algorithm.

11

00:00:35.790  -->  00:00:40.740
So here we can tell right away from First of all Peter and P3 are combined into a cluster then because

12

00:00:40.820  -->  00:00:44.220
they're their height is the lowest the height of this bar is the lowest.

13

00:00:44.250  -->  00:00:47.010
Then we look at the next lowest bar is this one.

14

00:00:47.010  -->  00:00:51.000
So P5 and six the leads dissimilar out of the remaining.

15

00:00:51.090  -->  00:00:52.910
And then these are pretty much the same height.

16

00:00:53.100  -->  00:01:00.030
But we first perform Clusium we combine these into an Klosters so one was added to cluster P2P 3 then

17

00:01:00.030  -->  00:01:05.040
P4 was added to cluster would be 5 five P-Six and then at the end all of the points combined to one

18

00:01:05.040  -->  00:01:05.470
cluster.

19

00:01:05.550  -->  00:01:07.560
So that's what the Democrat is telling us.

20

00:01:07.560  -->  00:01:13.380
As you can see right away is giving us a lot of additional information on top of the scatterplot and

21

00:01:13.410  -->  00:01:17.750
it contains that memory of the hierarchical clustering algorithm.

22

00:01:18.030  -->  00:01:25.500
So how do we use this then diagram to understand how to best execute or get the most value out of the

23

00:01:25.500  -->  00:01:26.400
H.C..

24

00:01:26.400  -->  00:01:27.570
So let's have a look.

25

00:01:27.780  -->  00:01:33.660
What we need to do with the Dinda Graham or what we can do is look at the horizontal levels and set

26

00:01:33.770  -->  00:01:39.360
thresholds so we can set heights thresholds or distance actually distance thresholds are also called

27

00:01:39.360  -->  00:01:44.850
dissimilarity thresholds because this vertical axis measures the median distance between points which

28

00:01:44.850  -->  00:01:49.650
also represents the dissimilarity between them or points or clusters.

29

00:01:49.650  -->  00:01:56.310
So what we can do is set a threshold for all dissimilarity and we can say that we don't want dissimilarity

30

00:01:56.310  -->  00:02:01.170
to be greater than this level so again doesn't matter with the absolute value is.

31

00:02:01.260  -->  00:02:04.950
It matters what the relative value is and how it looks on this image.

32

00:02:04.950  -->  00:02:11.970
So we were setting the dissimilarity threshold we saying that anything if we come across clusters that

33

00:02:12.030  -->  00:02:18.980
are above this threshold so we don't want within a cluster to have dissimilarity above this threshold

34

00:02:18.990  -->  00:02:21.740
so what that will do is will give us two clusters.

35

00:02:21.750  -->  00:02:26.580
Let's have a look at them there's our first cluster and there's our second cluster and that's that makes

36

00:02:26.580  -->  00:02:33.150
sense so what that it's telling us is that within each one of these clusters the dissimilarity is always

37

00:02:33.150  -->  00:02:34.160
less than three.

38

00:02:34.170  -->  00:02:38.950
So let's say we've got some values here that say this is 1.5 this is 2.0.

39

00:02:39.030  -->  00:02:42.910
So let's say we want to set the threshold at 1.7.

40

00:02:43.140  -->  00:02:51.450
And what this is doing is it is not allowing any clusters that would have dissimilarity of greater than

41

00:02:51.450  -->  00:02:53.280
1.7 within them.

42

00:02:53.280  -->  00:02:59.670
And as you can see from the dental gram we can tell that all the everything below that level this cluster

43

00:02:59.670  -->  00:03:07.500
and this cluster they don't have dissimilarity of 1.7 because the similarity is represented by these

44

00:03:07.590  -->  00:03:11.670
vertical lines and that's how the customer thresholding works.

45

00:03:11.670  -->  00:03:17.370
And the interesting part about pentagrams is you can quickly tell how many clusters you will have at

46

00:03:17.370  -->  00:03:23.730
a certain threshold by just looking at how many vertical lines this horizontal threshold actually crosses

47

00:03:23.730  -->  00:03:24.030
.

48

00:03:24.030  -->  00:03:27.180
So here you can see it crosses one two vertical lines.

49

00:03:27.180  -->  00:03:30.470
That means we will have two clusters will be this cluster of all these points.

50

00:03:30.500  -->  00:03:31.460
Want to be three.

51

00:03:31.530  -->  00:03:33.690
And this cluster P45 be.

52

00:03:33.690  -->  00:03:35.720
All right so let's have a look at another example.

53

00:03:35.970  -->  00:03:43.560
Let's have a look at a example where we put threshold at this level so somewhere just below where we

54

00:03:43.560  -->  00:03:44.810
combined.

55

00:03:44.860  -->  00:03:49.500
As you remember we had P5 P-Six and one Clauss appear to be three and one costs are pre-fall by itself

56

00:03:49.590  -->  00:03:54.430
one by itself and then we combined the one with this cluster P4 with this cluster.

57

00:03:54.480  -->  00:04:00.720
So let's say we're setting a threshold at just before that level of dissimilarity which allowed us to

58

00:04:00.720  -->  00:04:04.580
combine P1 with this cluster and P4 with this cluster.

59

00:04:04.590  -->  00:04:09.720
So what that will do is it'll give us a certain number of clusters so can you tell just by looking at

60

00:04:09.720  -->  00:04:11.760
the demographic how many clusters will help.

61

00:04:11.760  -->  00:04:12.630
Exactly correct.

62

00:04:12.640  -->  00:04:18.010
We can have four clusters because it crosses forward lines 1 2 3 4.

63

00:04:18.060  -->  00:04:24.510
Right so we're going to have a cluster one cluster of P2 and P3 cluster of before cluster of 5 and P-Six

64

00:04:24.670  -->  00:04:26.770
as have a look for clusters.

65

00:04:26.940  -->  00:04:27.850
And there they are.

66

00:04:28.050  -->  00:04:34.800
So that is what we're going to get if we said that dissimilarity or distance threshold at that level

67

00:04:34.810  -->  00:04:35.090
.

68

00:04:35.370  -->  00:04:36.450
Let's try another one.

69

00:04:36.660  -->  00:04:43.560
Let's say we want to set our dissimilarity threshold very low at point three meaning that we don't want

70

00:04:43.560  -->  00:04:51.000
clusters that have any noise within them that have dissimilarity greater then this threshold.

71

00:04:51.000  -->  00:04:53.770
So we're not going to allow any clusters like that.

72

00:04:53.790  -->  00:04:59.400
And the interesting part here is that we're actually setting the threshold below our very first cluster

73

00:04:59.400  -->  00:05:04.380
that we created or we here two and three so we're not even going to allow P2 and P3 to be combined.

74

00:05:04.380  -->  00:05:09.370
I want to close are we going to say that dissimilarity level that distance between them is too great

75

00:05:09.390  -->  00:05:16.520
too high we we don't think that based on our business knowledge or based on our other internal research

76

00:05:16.520  -->  00:05:23.450
or external research that we don't think that any points with dissimilarity greater than this level

77

00:05:23.570  -->  00:05:25.280
should be combined into a cluster.

78

00:05:25.310  -->  00:05:31.100
It's just it just doesn't make sense from a from a finite Langner financial from a business perspective

79

00:05:31.130  -->  00:05:37.430
from a perspective of knowledge about what this data set is about and what that will do is it will create

80

00:05:37.440  -->  00:05:42.710
six plus hours because we cross six lines one two three four five six and then they are every single

81

00:05:42.710  -->  00:05:44.660
point will be in its own cluster.

82

00:05:44.660  -->  00:05:51.710
As you can see we've got six clusters so that is how a dented ramp works or how you can get value out

83

00:05:51.710  -->  00:05:57.770
of a dental gram and you can set this threshold of different levels to understand how many clusters

84

00:05:57.770  -->  00:06:02.720
you'll get just by looking at the DNA a Grammy can tell right away and you can that way find the optimal

85

00:06:02.720  -->  00:06:09.030
level for the threshold of the optimal number of clusters that suits your project the best.

86

00:06:09.020  -->  00:06:15.200
So but how do you find the actual not just an optimal number of classes that you think is optimal What

87

00:06:15.200  -->  00:06:19.630
is the demographic giving us any ideas about the optimal number of clusters.

88

00:06:19.640  -->  00:06:26.750
What can we tell from the dental gram that might be a good guide for us to select the optimal number

89

00:06:26.750  -->  00:06:27.510
of clusters.

90

00:06:27.710  -->  00:06:33.980
Well there's a great giveaway that the underground contains and that is the vertical distance because

91

00:06:34.010  -->  00:06:36.010
it is measuring and dissimilarity.

92

00:06:36.020  -->  00:06:41.840
So one of the standard approaches is just to look for the highest vertical distance that you can find

93

00:06:41.840  -->  00:06:42.570
on the to.

94

00:06:42.560  -->  00:06:48.040
So basically any line that will not cross any horizontal lines.

95

00:06:48.230  -->  00:06:52.760
So for instance this line can be considered this like can be considered.

96

00:06:52.760  -->  00:06:58.950
This line cannot be considered for that research because it crosses a hypothetical horizontal line so

97

00:06:58.950  -->  00:07:03.710
you what you need to do is kind of like every horizontal line you have just imagined extends all the

98

00:07:03.710  -->  00:07:11.330
way across to denigrate every single horizontal lung you have and now find the longest line among yours

99

00:07:11.700  -->  00:07:16.670
among your existing vertical lines that doesn't cross any horizontal any of these extended horizontal

100

00:07:16.670  -->  00:07:22.610
lines so for instance even this line cannot be considered for that purpose because it would hypothetically

101

00:07:22.620  -->  00:07:28.270
cross this horizontal line that we have coming from this red line between P5 and P-Six.

102

00:07:28.280  -->  00:07:32.180
Again this line can kind of be considered because it's crossing this line.

103

00:07:32.180  -->  00:07:37.590
So you would need to look at this line for example or this line or if you wanted to use this line you

104

00:07:37.580  -->  00:07:41.180
would need to use only a bit of it that part or this part.

105

00:07:41.210  -->  00:07:44.900
So you can only use parts of lines that are between horizontal lines.

106

00:07:45.200  -->  00:07:52.130
So out of all of the lines that you have here which is the longest that doesn't cross any extended horizontal

107

00:07:52.130  -->  00:07:52.640
lines.

108

00:07:52.880  -->  00:07:53.600
Well that's correct.

109

00:07:53.610  -->  00:07:59.630
This one over here is the longest one or basically in our example the green and the red.

110

00:07:59.630  -->  00:08:01.200
There are about the same height.

111

00:08:01.380  -->  00:08:04.460
So this one or this one are the longest ones.

112

00:08:04.740  -->  00:08:11.150
And so this is the largest distance and therefore the best or the recommended approach.

113

00:08:11.150  -->  00:08:18.440
Again it's not a set in stone approach is a kind of one of the things that you could do is take a threshold

114

00:08:18.440  -->  00:08:24.680
that will cross this largest distance across that large distance threshold and then use that threshold

115

00:08:24.680  -->  00:08:27.830
to calculate the optimal number of clusters and actually find them.

116

00:08:28.070  -->  00:08:34.170
So once we've crossed this largest distance with our threshold doesn't matter we said you can sit here

117

00:08:34.220  -->  00:08:37.680
as head low or you can set high as long as it crosses this line then.

118

00:08:37.700  -->  00:08:44.420
Now the two clusters are this one and this one as you can see that is considered to be one of the approaches

119

00:08:44.850  -->  00:08:50.520
or this approach is telling us that the optimal number of clusters and these are them and kind of in

120

00:08:50.510  -->  00:08:51.770
this case it makes sense.

121

00:08:51.770  -->  00:08:57.050
You can see that indeed these points look that as if they're closer together.

122

00:08:57.240  -->  00:09:02.580
And these points look as if they're closer together rather than getting any clusters in between them

123

00:09:02.750  -->  00:09:08.660
or even breaking up into more clusters wouldn't make as much sense as this makes sense.

124

00:09:08.660  -->  00:09:09.710
And so there we go.

125

00:09:09.710  -->  00:09:15.440
That's that's one of the approaches you can use you can still look at this whole problem using similar

126

00:09:15.440  -->  00:09:19.730
approach to k means where you use the elbow method so you could use something like that.

127

00:09:19.880  -->  00:09:25.470
But in a hierarchical clustering we're going to focus on this approach with the largest distance.

128

00:09:25.670  -->  00:09:28.670
And now let's quickly have a knowledge test.

129

00:09:29.000  -->  00:09:34.040
So I'm going to have to charge here which are hidden on the left who have got the scatterplot on the

130

00:09:34.040  -->  00:09:34.360
right.

131

00:09:34.360  -->  00:09:35.820
You've got the to grab.

132

00:09:35.900  -->  00:09:37.970
I'm going to show you only the DNA gram.

133

00:09:37.970  -->  00:09:43.920
And I'd like you to try to understand or try to assess very quickly what's going on on the scatterplot

134

00:09:43.910  -->  00:09:44.410
.

135

00:09:44.420  -->  00:09:49.950
So for instance we'd like to know even afford seeing the scatterplot of the data set at the moment.

136

00:09:49.970  -->  00:09:54.510
We'd like to know what is the optimal number of clusters in this data set just by looking at underground

137

00:09:54.500  -->  00:09:54.530
.

138

00:09:54.530  -->  00:09:56.010
Can you identify that.

139

00:09:56.000  -->  00:10:01.910
So if you like you can post a video and just look at these vertical and horizontal lines and try to

140

00:10:01.910  -->  00:10:03.830
find out based on the method that we discussed.

141

00:10:03.840  -->  00:10:07.030
What would be the optimal number of clusters.

142

00:10:07.220  -->  00:10:12.510
So in three to one I'm going to now reveal how I would solve this challenge.

143

00:10:12.500  -->  00:10:17.400
Well what I would do is I'd look for the for the longest vertical line that doesn't cross an extended

144

00:10:17.390  -->  00:10:18.430
horizontal lines.

145

00:10:18.440  -->  00:10:23.890
If you extend that extend that extend that you can see that it's probably this line over here.

146

00:10:24.420  -->  00:10:26.570
And so that's the largest distance.

147

00:10:26.580  -->  00:10:32.960
That means we need to cross it with a horizontal line of our threshold and that will give us the number

148

00:10:32.960  -->  00:10:37.770
of clusters which is three clusters because it crosses three lines here one two three.

149

00:10:37.830  -->  00:10:43.490
And if you look at the chart as you can see indeed we do have three classes and it does look that bad

150

00:10:43.620  -->  00:10:48.030
like that is the optimal number of clusters for this business problem.

151

00:10:48.290  -->  00:10:51.260
So hopefully you enjoyed this tutorial.

152

00:10:51.260  -->  00:10:55.590
We walk through all of this money so that you have a better intuitive understanding of how the hierarchical

153

00:10:55.590  -->  00:10:58.570
clustering algorithm and pentagrams work.

154

00:10:58.790  -->  00:11:07.490
And next how long will show you around in our in Python and together you will create some amazing analysis

155

00:11:07.590  -->  00:11:14.280
around hierarchical clustering and together of him or you will solve a business problem using the hierarchical

156

00:11:14.270  -->  00:11:15.570
clustering algorithm.

157

00:11:15.600  -->  00:11:19.280
There's got some fun tutorials ahead of you and I look forward to seeing you next time.

158

00:11:19.280  -->  00:11:21.520
Until then in machine learning.
