WEBVTT

00:02.500 --> 00:08.130
After our first steps in the query editor, it's now time to go one step further,

00:08.440 --> 00:13.850
let's see how we can bind our queries and create a new query out of that combination.

00:15.070 --> 00:20.530
So we want to create a new query and the goal is to combine the information we have in those three queries

00:20.770 --> 00:22.570
in that new query.

00:22.570 --> 00:23.940
The good thing is Power BI

00:23.950 --> 00:29.980
desktop has a great function that let's you do exactly that and this function can be found in the

00:29.980 --> 00:37.390
home ribbon, then in the right part in the combined area and here, you have two options. You have merge queries,

00:37.450 --> 00:39.250
we will talk about that later

00:39.430 --> 00:46.450
and you have append queries. Now if you don't click directly onto that append queries name but onto that

00:46.450 --> 00:47.870
little arrow right here,

00:48.160 --> 00:54.030
you see the two options appear, append queries and append queries as new.

00:54.430 --> 00:58.540
Now, first thing, what does append actually mean?

00:58.550 --> 01:04.140
Append means nothing more than adding the queries below each other basically.

01:04.150 --> 01:06.270
So let's say you have the first dataset,

01:06.280 --> 01:11.550
this is the one where query starts and below that, you can add the second query.

01:11.560 --> 01:18.320
So in our case, the dataset from 1950 - 1999 in the first rows and after that, the dataset from 2000

01:18.320 --> 01:20.090
to 2049,

01:20.110 --> 01:22.020
so that's what append means.

01:22.030 --> 01:27.300
Now we have two options, append queries and append queries as new.

01:27.850 --> 01:32.030
Now append queries would add a new query,

01:32.050 --> 01:35.330
so one of the few queries we have to an existing query.

01:35.530 --> 01:43.760
So if we say append queries and we do that to the 1950 - 1999 query, then this query will be changed

01:44.110 --> 01:45.480
and I don't want that,

01:45.550 --> 01:52.570
I want to keep our initial queries as unchanged as possible, to see in the end how we derived our data

01:52.660 --> 01:54.230
step by step.

01:54.250 --> 02:00.070
This is what we will use the append queries as new option because this will create a new query,

02:00.100 --> 02:02.430
so we have four queries in the end.

02:02.540 --> 02:05.760
Now in this menu, we can see two options again,

02:05.980 --> 02:10.340
we can append two tables in that new query or three or more tables.

02:10.360 --> 02:16.600
Now I want to use the three or more tables function, although this would be the correct one right here because

02:16.600 --> 02:23.060
we could simply select the second and the third query to have all three queries to append right here

02:23.560 --> 02:24.550
and press OK

02:24.790 --> 02:26.650
and then we would have the new query

02:27.190 --> 02:33.330
but I want to show you both. I want to show you the append queries as new function right here

02:33.850 --> 02:41.740
and I want to do that with a query that consists of two queries and then we will use the append query

02:41.740 --> 02:45.740
function in that new query to add the remaining, so the third query,

02:46.060 --> 02:47.400
let's see how this works.

02:47.440 --> 02:51.950
So I go back to two tables and now we have to define our primary table,

02:52.180 --> 02:54.150
this is 1950 - 1999,

02:54.160 --> 02:55.000
this is fine,

02:55.030 --> 03:00.430
you could change that here of course as you prefer and you have to define the table to append to that

03:00.430 --> 03:01.560
primary table

03:01.590 --> 03:04.470
and this is also fine, so we can press OK.

03:05.050 --> 03:11.530
So we now created a new query out of the two initial queries and everything is the same,

03:11.530 --> 03:13.190
we have the same column names

03:13.240 --> 03:16.550
so we have just one list with all of the data

03:16.720 --> 03:22.420
and you can see that if you click on to that column for instance, so the time column, press onto that

03:22.460 --> 03:25.180
arrow, press load more

03:25.210 --> 03:29.230
and we have still blank rows by the way so we'll take care of that later

03:29.290 --> 03:34.300
and if we scroll down now, we see that we have the data until 2049

03:34.300 --> 03:43.010
so this worked. A short note maybe, in this case we had the same column names, so the identical column names.

03:43.240 --> 03:50.260
If you combine queries with the append query function which have some different column names, then those

03:50.260 --> 03:56.290
new columns would be added with the real values for those queries who really have the columns

03:56.530 --> 04:02.530
and if you have the queries in that appended query which doesn't have that column, then it will be simply

04:02.530 --> 04:03.060
null.

04:03.190 --> 04:09.400
So you can also append queries if the column names are not totally identical but it's nicer to do it

04:09.490 --> 04:15.040
like this because then you don't have that additional columns and that null values.

04:15.040 --> 04:18.250
Now that we have that new query, let's append the third query,

04:18.260 --> 04:21.640
the 2050 - 2100 query.

04:21.880 --> 04:28.780
So I'll go to append queries again in the home ribbon, press that arrow, press now append queries and

04:28.930 --> 04:32.180
now we can define what table we want to append and

04:32.200 --> 04:35.810
we could also append more tables again but we don't need that right here

04:36.160 --> 04:41.980
and we press onto that menu and select the third query, like this and we press OK

04:43.050 --> 04:48.810
and now we added the third query. Let's quickly check that by clicking onto that arrow again and press load

04:48.810 --> 04:50.170
more

04:50.300 --> 04:51.550
and we also have N/A

04:51.610 --> 04:54.670
so this is also something we have to take care of

04:55.180 --> 05:04.270
and if we scroll down, we see that we now have the total data from 1950 - 2100 in one single new query.

05:04.360 --> 05:09.560
So this looks good, what doesn't look good is the query name, append one,

05:09.610 --> 05:11.440
that's not a good name for a query

05:11.440 --> 05:12.720
so let's change that

05:13.180 --> 05:16.720
and you have three options on how you can change the name.

05:16.720 --> 05:19.780
So again, lots of options available in Power BI desktop.

05:20.080 --> 05:25.240
The first option is to right-click on to the query right here and press rename,

05:25.270 --> 05:27.800
now you could rename it first option.

05:28.070 --> 05:32.540
I'm pressing escape and if you keep the query selected and press F2,

05:32.750 --> 05:34.600
then you can also select that.

05:34.720 --> 05:36.070
So those are two options,

05:36.160 --> 05:41.650
the third option is if you go to the query column and highlight the name right here and

05:41.650 --> 05:42.410
simply write

05:42.450 --> 05:48.120
population combined maybe because that's what it is

05:48.280 --> 05:52.160
and press enter and now you see the name also changed right here.

05:52.690 --> 05:54.260
So this looks fine,

05:54.280 --> 05:58.610
now we worked on the rows and we created a new query,

05:58.960 --> 06:01.780
I think now it's time to take a closer look at the columns,

06:01.780 --> 06:02.450
right?.

06:02.770 --> 06:04.940
Let's do that in the next video.
